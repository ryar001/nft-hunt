"use strict";(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsRepo = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsRepo=(()=>{var gd=Object.create;var sn=Object.defineProperty;var wd=Object.getOwnPropertyDescriptor;var bd=Object.getOwnPropertyNames;var Dd=Object.getPrototypeOf,Ed=Object.prototype.hasOwnProperty;var A=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),te=(r,e)=>{for(var t in e)sn(r,t,{get:e[t],enumerable:!0})},$s=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of bd(e))!Ed.call(r,o)&&o!==t&&sn(r,o,{get:()=>e[o],enumerable:!(n=wd(e,o))||n.enumerable});return r};var x=(r,e,t)=>(t=r!=null?gd(Dd(r)):{},$s(e||!r||!r.__esModule?sn(t,"default",{value:r,enumerable:!0}):t,r)),vd=r=>$s(sn({},"__esModule",{value:!0}),r);var js=A((Xm,Us)=>{var Mt=1e3,$t=Mt*60,Ut=$t*60,bt=Ut*24,_d=bt*7,Cd=bt*365.25;Us.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return Ad(r);if(t==="number"&&isFinite(r))return e.long?Td(r):Sd(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Ad(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*Cd;case"weeks":case"week":case"w":return t*_d;case"days":case"day":case"d":return t*bt;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Ut;case"minutes":case"minute":case"mins":case"min":case"m":return t*$t;case"seconds":case"second":case"secs":case"sec":case"s":return t*Mt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Sd(r){var e=Math.abs(r);return e>=bt?Math.round(r/bt)+"d":e>=Ut?Math.round(r/Ut)+"h":e>=$t?Math.round(r/$t)+"m":e>=Mt?Math.round(r/Mt)+"s":r+"ms"}function Td(r){var e=Math.abs(r);return e>=bt?an(r,e,bt,"day"):e>=Ut?an(r,e,Ut,"hour"):e>=$t?an(r,e,$t,"minute"):e>=Mt?an(r,e,Mt,"second"):r+" ms"}function an(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var qs=A((eg,zs)=>{function Od(r){t.debug=t,t.default=t,t.coerce=u,t.disable=i,t.enable=o,t.enabled=s,t.humanize=js(),t.destroy=f,Object.keys(r).forEach(c=>{t[c]=r[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let l=0;for(let h=0;h<c.length;h++)l=(l<<5)-l+c.charCodeAt(h),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(c){let l,h=null,g,p;function w(...S){if(!w.enabled)return;let B=w,J=Number(new Date),we=J-(l||J);B.diff=we,B.prev=l,B.curr=J,l=J,S[0]=t.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let Y=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(be,se)=>{if(be==="%%")return"%";Y++;let De=t.formatters[se];if(typeof De=="function"){let Lt=S[Y];be=De.call(B,Lt),S.splice(Y,1),Y--}return be}),t.formatArgs.call(B,S),(B.log||t.log).apply(B,S)}return w.namespace=c,w.useColors=t.useColors(),w.color=t.selectColor(c),w.extend=n,w.destroy=t.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(g!==t.namespaces&&(g=t.namespaces,p=t.enabled(c)),p),set:S=>{h=S}}),typeof t.init=="function"&&t.init(w),w}function n(c,l){let h=t(this.namespace+(typeof l>"u"?":":l)+c);return h.log=this.log,h}function o(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let l,h=(typeof c=="string"?c:"").split(/[\s,]+/),g=h.length;for(l=0;l<g;l++)!h[l]||(c=h[l].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.slice(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...t.names.map(a),...t.skips.map(a).map(l=>"-"+l)].join(",");return t.enable(""),c}function s(c){if(c[c.length-1]==="*")return!0;let l,h;for(l=0,h=t.skips.length;l<h;l++)if(t.skips[l].test(c))return!1;for(l=0,h=t.names.length;l<h;l++)if(t.names[l].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack||c.message:c}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}zs.exports=Od});var Be=A((ae,un)=>{ae.formatArgs=kd;ae.save=Pd;ae.load=Rd;ae.useColors=Id;ae.storage=Nd();ae.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ae.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Id(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function kd(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+un.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}ae.log=console.debug||console.log||(()=>{});function Pd(r){try{r?ae.storage.setItem("debug",r):ae.storage.removeItem("debug")}catch{}}function Rd(){let r;try{r=ae.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Nd(){try{return localStorage}catch{}}un.exports=qs()(ae);var{formatters:Bd}=un.exports;Bd.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var qe=A((tg,Vs)=>{"use strict";function Ks(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Fd(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Ks(r,t)}catch{t.message=r.message,t.stack=r.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(r)),Ks(new o,t)}}Vs.exports=Fd});var Ko=A((Yg,da)=>{"use strict";var Qh=async r=>{let e=0;for await(let t of r)e++;return e};da.exports=Qh});var Pu=A((fb,ku)=>{"use strict";ku.exports=Lp;function Lp(r,e){for(var t=new Array(arguments.length-1),n=0,o=2,i=!0;o<arguments.length;)t[n++]=arguments[o++];return new Promise(function(a,u){t[n]=function(c){if(i)if(i=!1,c)u(c);else{for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h++]=arguments[h];a.apply(null,l)}};try{r.apply(e||null,t)}catch(f){i&&(i=!1,u(f))}})}});var Fu=A(Bu=>{"use strict";var An=Bu;An.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Xt=new Array(64),Nu=new Array(123);for(Te=0;Te<64;)Nu[Xt[Te]=Te<26?Te+65:Te<52?Te+71:Te<62?Te-4:Te-59|43]=Te++;var Te;An.encode=function(e,t,n){for(var o=null,i=[],s=0,a=0,u;t<n;){var f=e[t++];switch(a){case 0:i[s++]=Xt[f>>2],u=(f&3)<<4,a=1;break;case 1:i[s++]=Xt[u|f>>4],u=(f&15)<<2,a=2;break;case 2:i[s++]=Xt[u|f>>6],i[s++]=Xt[f&63],a=0;break}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0)}return a&&(i[s++]=Xt[u],i[s++]=61,a===1&&(i[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))};var Ru="invalid encoding";An.decode=function(e,t,n){for(var o=n,i=0,s,a=0;a<e.length;){var u=e.charCodeAt(a++);if(u===61&&i>1)break;if((u=Nu[u])===void 0)throw Error(Ru);switch(i){case 0:s=u,i=1;break;case 1:t[n++]=s<<2|(u&48)>>4,s=u,i=2;break;case 2:t[n++]=(s&15)<<4|(u&60)>>2,s=u,i=3;break;case 3:t[n++]=(s&3)<<6|u,i=0;break}}if(i===1)throw Error(Ru);return n-o};An.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Mu=A((db,Lu)=>{"use strict";Lu.exports=Sn;function Sn(){this._listeners={}}Sn.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Sn.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],o=0;o<n.length;)n[o].fn===t?n.splice(o,1):++o;return this};Sn.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],o=1;o<arguments.length;)n.push(arguments[o++]);for(o=0;o<t.length;)t[o].fn.apply(t[o++].ctx,n)}return this}});var Vu=A((hb,Ku)=>{"use strict";Ku.exports=$u($u);function $u(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function o(u,f,c){e[0]=u,f[c]=t[0],f[c+1]=t[1],f[c+2]=t[2],f[c+3]=t[3]}function i(u,f,c){e[0]=u,f[c]=t[3],f[c+1]=t[2],f[c+2]=t[1],f[c+3]=t[0]}r.writeFloatLE=n?o:i,r.writeFloatBE=n?i:o;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],e[0]}function a(u,f){return t[3]=u[f],t[2]=u[f+1],t[1]=u[f+2],t[0]=u[f+3],e[0]}r.readFloatLE=n?s:a,r.readFloatBE=n?a:s}():function(){function e(n,o,i,s){var a=o<0?1:0;if(a&&(o=-o),o===0)n(1/o>0?0:2147483648,i,s);else if(isNaN(o))n(2143289344,i,s);else if(o>34028234663852886e22)n((a<<31|2139095040)>>>0,i,s);else if(o<11754943508222875e-54)n((a<<31|Math.round(o/1401298464324817e-60))>>>0,i,s);else{var u=Math.floor(Math.log(o)/Math.LN2),f=Math.round(o*Math.pow(2,-u)*8388608)&8388607;n((a<<31|u+127<<23|f)>>>0,i,s)}}r.writeFloatLE=e.bind(null,Uu),r.writeFloatBE=e.bind(null,ju);function t(n,o,i){var s=n(o,i),a=(s>>31)*2+1,u=s>>>23&255,f=s&8388607;return u===255?f?NaN:a*(1/0):u===0?a*1401298464324817e-60*f:a*Math.pow(2,u-150)*(f+8388608)}r.readFloatLE=t.bind(null,zu),r.readFloatBE=t.bind(null,qu)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function o(u,f,c){e[0]=u,f[c]=t[0],f[c+1]=t[1],f[c+2]=t[2],f[c+3]=t[3],f[c+4]=t[4],f[c+5]=t[5],f[c+6]=t[6],f[c+7]=t[7]}function i(u,f,c){e[0]=u,f[c]=t[7],f[c+1]=t[6],f[c+2]=t[5],f[c+3]=t[4],f[c+4]=t[3],f[c+5]=t[2],f[c+6]=t[1],f[c+7]=t[0]}r.writeDoubleLE=n?o:i,r.writeDoubleBE=n?i:o;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],t[4]=u[f+4],t[5]=u[f+5],t[6]=u[f+6],t[7]=u[f+7],e[0]}function a(u,f){return t[7]=u[f],t[6]=u[f+1],t[5]=u[f+2],t[4]=u[f+3],t[3]=u[f+4],t[2]=u[f+5],t[1]=u[f+6],t[0]=u[f+7],e[0]}r.readDoubleLE=n?s:a,r.readDoubleBE=n?a:s}():function(){function e(n,o,i,s,a,u){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,a,u+o),n(1/s>0?0:2147483648,a,u+i);else if(isNaN(s))n(0,a,u+o),n(2146959360,a,u+i);else if(s>17976931348623157e292)n(0,a,u+o),n((f<<31|2146435072)>>>0,a,u+i);else{var c;if(s<22250738585072014e-324)c=s/5e-324,n(c>>>0,a,u+o),n((f<<31|c/4294967296)>>>0,a,u+i);else{var l=Math.floor(Math.log(s)/Math.LN2);l===1024&&(l=1023),c=s*Math.pow(2,-l),n(c*4503599627370496>>>0,a,u+o),n((f<<31|l+1023<<20|c*1048576&1048575)>>>0,a,u+i)}}}r.writeDoubleLE=e.bind(null,Uu,0,4),r.writeDoubleBE=e.bind(null,ju,4,0);function t(n,o,i,s,a){var u=n(s,a+o),f=n(s,a+i),c=(f>>31)*2+1,l=f>>>20&2047,h=4294967296*(f&1048575)+u;return l===2047?h?NaN:c*(1/0):l===0?c*5e-324*h:c*Math.pow(2,l-1075)*(h+4503599627370496)}r.readDoubleLE=t.bind(null,zu,0,4),r.readDoubleBE=t.bind(null,qu,4,0)}(),r}function Uu(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function ju(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function zu(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function qu(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Wu=A((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Hu=A(Qu=>{"use strict";var ti=Qu;ti.length=function(e){for(var t=0,n=0,o=0;o<e.length;++o)n=e.charCodeAt(o),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(o+1)&64512)===56320?(++o,t+=4):t+=3;return t};ti.read=function(e,t,n){var o=n-t;if(o<1)return"";for(var i=null,s=[],a=0,u;t<n;)u=e[t++],u<128?s[a++]=u:u>191&&u<224?s[a++]=(u&31)<<6|e[t++]&63:u>239&&u<365?(u=((u&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[a++]=55296+(u>>10),s[a++]=56320+(u&1023)):s[a++]=(u&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};ti.write=function(e,t,n){for(var o=n,i,s,a=0;a<e.length;++a)i=e.charCodeAt(a),i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++a,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128);return n-o}});var Ju=A((yb,Gu)=>{"use strict";Gu.exports=Mp;function Mp(r,e,t){var n=t||8192,o=n>>>1,i=null,s=n;return function(u){if(u<1||u>o)return r(u);s+u>n&&(i=r(n),s=0);var f=e.call(i,s,s+=u);return s&7&&(s=(s|7)+1),f}}});var Zu=A((mb,Yu)=>{"use strict";Yu.exports=H;var Ar=ot();function H(r,e){this.lo=r>>>0,this.hi=e>>>0}var xt=H.zero=new H(0,0);xt.toNumber=function(){return 0};xt.zzEncode=xt.zzDecode=function(){return this};xt.length=function(){return 1};var $p=H.zeroHash="\0\0\0\0\0\0\0\0";H.fromNumber=function(e){if(e===0)return xt;var t=e<0;t&&(e=-e);var n=e>>>0,o=(e-n)/4294967296>>>0;return t&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new H(n,o)};H.from=function(e){if(typeof e=="number")return H.fromNumber(e);if(Ar.isString(e))if(Ar.Long)e=Ar.Long.fromString(e);else return H.fromNumber(parseInt(e,10));return e.low||e.high?new H(e.low>>>0,e.high>>>0):xt};H.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};H.prototype.toLong=function(e){return Ar.Long?new Ar.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var nt=String.prototype.charCodeAt;H.fromHash=function(e){return e===$p?xt:new H((nt.call(e,0)|nt.call(e,1)<<8|nt.call(e,2)<<16|nt.call(e,3)<<24)>>>0,(nt.call(e,4)|nt.call(e,5)<<8|nt.call(e,6)<<16|nt.call(e,7)<<24)>>>0)};H.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};H.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};H.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};H.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var ot=A(ri=>{"use strict";var E=ri;E.asPromise=Pu();E.base64=Fu();E.EventEmitter=Mu();E.float=Vu();E.inquire=Wu();E.utf8=Hu();E.pool=Ju();E.LongBits=Zu();E.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);E.global=E.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ri;E.emptyArray=Object.freeze?Object.freeze([]):[];E.emptyObject=Object.freeze?Object.freeze({}):{};E.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};E.isString=function(e){return typeof e=="string"||e instanceof String};E.isObject=function(e){return e&&typeof e=="object"};E.isset=E.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};E.Buffer=function(){try{var r=E.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();E._Buffer_from=null;E._Buffer_allocUnsafe=null;E.newBuffer=function(e){return typeof e=="number"?E.Buffer?E._Buffer_allocUnsafe(e):new E.Array(e):E.Buffer?E._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};E.Array=typeof Uint8Array<"u"?Uint8Array:Array;E.Long=E.global.dcodeIO&&E.global.dcodeIO.Long||E.global.Long||E.inquire("long");E.key2Re=/^true|false|0|1$/;E.key32Re=/^-?(?:0|[1-9][0-9]*)$/;E.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;E.longToHash=function(e){return e?E.LongBits.from(e).toHash():E.LongBits.zeroHash};E.longFromHash=function(e,t){var n=E.LongBits.fromHash(e);return E.Long?E.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))};function Xu(r,e,t){for(var n=Object.keys(e),o=0;o<n.length;++o)(r[n[o]]===void 0||!t)&&(r[n[o]]=e[n[o]]);return r}E.merge=Xu;E.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ec(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Xu(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}E.newError=ec;E.ProtocolError=ec("ProtocolError");E.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var o=Object.keys(this),i=o.length-1;i>-1;--i)if(t[o[i]]===1&&this[o[i]]!==void 0&&this[o[i]]!==null)return o[i]}};E.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};E.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};E._configure=function(){var r=E.Buffer;if(!r){E._Buffer_from=E._Buffer_allocUnsafe=null;return}E._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},E._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var ci=A((wb,oc)=>{"use strict";oc.exports=T;var xe=ot(),ni,Tn=xe.LongBits,tc=xe.base64,rc=xe.utf8;function Sr(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function ii(){}function Up(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function T(){this.len=0,this.head=new Sr(ii,0,0),this.tail=this.head,this.states=null}var nc=function(){return xe.Buffer?function(){return(T.create=function(){return new ni})()}:function(){return new T}};T.create=nc();T.alloc=function(e){return new xe.Array(e)};xe.Array!==Array&&(T.alloc=xe.pool(T.alloc,xe.Array.prototype.subarray));T.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Sr(e,t,n),this.len+=t,this};function si(r,e,t){e[t]=r&255}function jp(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function ai(r,e){this.len=r,this.next=void 0,this.val=e}ai.prototype=Object.create(Sr.prototype);ai.prototype.fn=jp;T.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ai((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};T.prototype.int32=function(e){return e<0?this._push(ui,10,Tn.fromNumber(e)):this.uint32(e)};T.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function ui(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}T.prototype.uint64=function(e){var t=Tn.from(e);return this._push(ui,t.length(),t)};T.prototype.int64=T.prototype.uint64;T.prototype.sint64=function(e){var t=Tn.from(e).zzEncode();return this._push(ui,t.length(),t)};T.prototype.bool=function(e){return this._push(si,1,e?1:0)};function oi(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}T.prototype.fixed32=function(e){return this._push(oi,4,e>>>0)};T.prototype.sfixed32=T.prototype.fixed32;T.prototype.fixed64=function(e){var t=Tn.from(e);return this._push(oi,4,t.lo)._push(oi,4,t.hi)};T.prototype.sfixed64=T.prototype.fixed64;T.prototype.float=function(e){return this._push(xe.float.writeFloatLE,4,e)};T.prototype.double=function(e){return this._push(xe.float.writeDoubleLE,8,e)};var zp=xe.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var o=0;o<e.length;++o)t[n+o]=e[o]};T.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(si,1,0);if(xe.isString(e)){var n=T.alloc(t=tc.length(e));tc.decode(e,n,0),e=n}return this.uint32(t)._push(zp,t,e)};T.prototype.string=function(e){var t=rc.length(e);return t?this.uint32(t)._push(rc.write,t,e):this._push(si,1,0)};T.prototype.fork=function(){return this.states=new Up(this),this.head=this.tail=new Sr(ii,0,0),this.len=0,this};T.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Sr(ii,0,0),this.len=0),this};T.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};T.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};T._configure=function(r){ni=r,T.create=nc(),ni._configure()}});var ac=A((bb,sc)=>{"use strict";sc.exports=$e;var ic=ci();($e.prototype=Object.create(ic.prototype)).constructor=$e;var it=ot();function $e(){ic.call(this)}$e._configure=function(){$e.alloc=it._Buffer_allocUnsafe,$e.writeBytesBuffer=it.Buffer&&it.Buffer.prototype instanceof Uint8Array&&it.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var o=0;o<e.length;)t[n++]=e[o++]}};$e.prototype.bytes=function(e){it.isString(e)&&(e=it._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push($e.writeBytesBuffer,t,e),this};function qp(r,e,t){r.length<40?it.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}$e.prototype.string=function(e){var t=it.Buffer.byteLength(e);return this.uint32(t),t&&this._push(qp,t,e),this};$e._configure()});var di=A((Db,dc)=>{"use strict";dc.exports=U;var Ue=ot(),li,fc=Ue.LongBits,Kp=Ue.utf8;function Oe(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function U(r){this.buf=r,this.pos=0,this.len=r.length}var uc=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new U(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new U(e);throw Error("illegal buffer")},lc=function(){return Ue.Buffer?function(t){return(U.create=function(o){return Ue.Buffer.isBuffer(o)?new li(o):uc(o)})(t)}:uc};U.create=lc();U.prototype._slice=Ue.Array.prototype.subarray||Ue.Array.prototype.slice;U.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Oe(this,10);return e}}();U.prototype.int32=function(){return this.uint32()|0};U.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function fi(){var r=new fc(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Oe(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw Oe(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}U.prototype.bool=function(){return this.uint32()!==0};function On(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}U.prototype.fixed32=function(){if(this.pos+4>this.len)throw Oe(this,4);return On(this.buf,this.pos+=4)};U.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Oe(this,4);return On(this.buf,this.pos+=4)|0};function cc(){if(this.pos+8>this.len)throw Oe(this,8);return new fc(On(this.buf,this.pos+=4),On(this.buf,this.pos+=4))}U.prototype.float=function(){if(this.pos+4>this.len)throw Oe(this,4);var e=Ue.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};U.prototype.double=function(){if(this.pos+8>this.len)throw Oe(this,4);var e=Ue.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};U.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw Oe(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};U.prototype.string=function(){var e=this.bytes();return Kp.read(e,0,e.length)};U.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Oe(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Oe(this);while(this.buf[this.pos++]&128);return this};U.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};U._configure=function(r){li=r,U.create=lc(),li._configure();var e=Ue.Long?"toLong":"toNumber";Ue.merge(U.prototype,{int64:function(){return fi.call(this)[e](!1)},uint64:function(){return fi.call(this)[e](!0)},sint64:function(){return fi.call(this).zzDecode()[e](!1)},fixed64:function(){return cc.call(this)[e](!0)},sfixed64:function(){return cc.call(this)[e](!1)}})}});var mc=A((Eb,yc)=>{"use strict";yc.exports=_t;var pc=di();(_t.prototype=Object.create(pc.prototype)).constructor=_t;var hc=ot();function _t(r){pc.call(this,r)}_t._configure=function(){hc.Buffer&&(_t.prototype._slice=hc.Buffer.prototype.slice)};_t.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};_t._configure()});var wc=A((vb,gc)=>{"use strict";gc.exports=Tr;var hi=ot();(Tr.prototype=Object.create(hi.EventEmitter.prototype)).constructor=Tr;function Tr(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");hi.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}Tr.prototype.rpcCall=function r(e,t,n,o,i){if(!o)throw TypeError("request must be specified");var s=this;if(!i)return hi.asPromise(r,s,e,t,n,o);if(!s.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return s.rpcImpl(e,t[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(u,f){if(u)return s.emit("error",u,e),i(u);if(f===null){s.end(!0);return}if(!(f instanceof n))try{f=n[s.responseDelimited?"decodeDelimited":"decode"](f)}catch(c){return s.emit("error",c,e),i(c)}return s.emit("data",f,e),i(null,f)})}catch(a){s.emit("error",a,e),setTimeout(function(){i(a)},0);return}};Tr.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Dc=A(bc=>{"use strict";var Vp=bc;Vp.Service=wc()});var vc=A((_b,Ec)=>{"use strict";Ec.exports={}});var Cc=A(_c=>{"use strict";var ne=_c;ne.build="minimal";ne.Writer=ci();ne.BufferWriter=ac();ne.Reader=di();ne.BufferReader=mc();ne.util=ot();ne.rpc=Dc();ne.roots=vc();ne.configure=xc;function xc(){ne.util._configure(),ne.Writer._configure(ne.BufferWriter),ne.Reader._configure(ne.BufferReader)}xc()});var st=A((Ab,Ac)=>{"use strict";Ac.exports=Cc()});var Ic=A((pi,Oc)=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});kn.BASE=2166136261;function kn(r,e=kn.BASE){let t=r.length;for(let n=0;n<t;n++)e^=r.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}pi.default=kn;Oc.exports=kn});var Rc=A((Ob,Pc)=>{Pc.exports=yi;var kc=128,Qp=127,Hp=~Qp,Gp=Math.pow(2,31);function yi(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw yi.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=Gp;)e[t++]=r&255|kc,r/=128;for(;r&Hp;)e[t++]=r&255|kc,r>>>=7;return e[t]=r|0,yi.bytes=t-n+1,e}});var Fc=A((Ib,Bc)=>{Bc.exports=mi;var Jp=128,Nc=127;function mi(r,n){var t=0,n=n||0,o=0,i=n,s,a=r.length;do{if(i>=a||o>49)throw mi.bytes=0,new RangeError("Could not decode varint");s=r[i++],t+=o<28?(s&Nc)<<o:(s&Nc)*Math.pow(2,o),o+=7}while(s>=Jp);return mi.bytes=i-n,t}});var Mc=A((kb,Lc)=>{var Yp=Math.pow(2,7),Zp=Math.pow(2,14),Xp=Math.pow(2,21),ey=Math.pow(2,28),ty=Math.pow(2,35),ry=Math.pow(2,42),ny=Math.pow(2,49),oy=Math.pow(2,56),iy=Math.pow(2,63);Lc.exports=function(r){return r<Yp?1:r<Zp?2:r<Xp?3:r<ey?4:r<ty?5:r<ry?6:r<ny?7:r<oy?8:r<iy?9:10}});var Or=A((Pb,$c)=>{$c.exports={encode:Rc(),decode:Fc(),encodingLength:Mc()}});var Nf=A((_1,Wn)=>{"use strict";Wn.exports=om;Wn.exports.format=Pf;Wn.exports.parse=Rf;var tm=/\B(?=(\d{3})+(?!\d))/g,rm=/(?:\.0*|(\.[^0]+)0+)$/,lt={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},nm=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function om(r,e){return typeof r=="string"?Rf(r):typeof r=="number"?Pf(r,e):null}function Pf(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),n=e&&e.thousandsSeparator||"",o=e&&e.unitSeparator||"",i=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,s=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!lt[a.toLowerCase()])&&(t>=lt.pb?a="PB":t>=lt.tb?a="TB":t>=lt.gb?a="GB":t>=lt.mb?a="MB":t>=lt.kb?a="KB":a="B");var u=r/lt[a.toLowerCase()],f=u.toFixed(i);return s||(f=f.replace(rm,"$1")),n&&(f=f.split(".").map(function(c,l){return l===0?c.replace(tm,n):c}).join(".")),f+o+a}function Rf(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=nm.exec(r),t,n="b";return e?(t=parseFloat(e[1]),n=e[4].toLowerCase()):(t=parseInt(r,10),n="b"),isNaN(t)?null:Math.floor(lt[n]*t)}});var Ff=A((C1,Bf)=>{"use strict";Bf.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var zf=A((Uf,jf)=>{"use strict";var Qn=Ff(),{hasOwnProperty:Mf}=Object.prototype,{propertyIsEnumerable:im}=Object,sr=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),sm=Uf,Lf={concatArrays:!1,ignoreUndefined:!1},Hn=r=>{let e=[];for(let t in r)Mf.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let n of t)im.call(r,n)&&e.push(n)}return e};function ar(r){return Array.isArray(r)?am(r):Qn(r)?um(r):r}function am(r){let e=r.slice(0,0);return Hn(r).forEach(t=>{sr(e,t,ar(r[t]))}),e}function um(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return Hn(r).forEach(t=>{sr(e,t,ar(r[t]))}),e}var $f=(r,e,t,n)=>(t.forEach(o=>{typeof e[o]>"u"&&n.ignoreUndefined||(o in r&&r[o]!==Object.getPrototypeOf(r)?sr(r,o,Qi(r[o],e[o],n)):sr(r,o,ar(e[o])))}),r),cm=(r,e,t)=>{let n=r.slice(0,0),o=0;return[r,e].forEach(i=>{let s=[];for(let a=0;a<i.length;a++)!Mf.call(i,a)||(s.push(String(a)),i===r?sr(n,o++,i[a]):sr(n,o++,ar(i[a])));n=$f(n,i,Hn(i).filter(a=>!s.includes(a)),t)}),n};function Qi(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?cm(r,e,t):!Qn(e)||!Qn(r)?ar(e):$f(r,e,Hn(e),t)}jf.exports=function(...r){let e=Qi(ar(Lf),this!==sm&&this||{},Lf),t={_:{}};for(let n of r)if(n!==void 0){if(!Qn(n))throw new TypeError("`"+n+"` is not an Option Object");t=Qi(t,{_:n},e)}return t._}});var Ji=A((N1,Gi)=>{"use strict";var hm=Object.prototype.hasOwnProperty,ee="~";function $r(){}Object.create&&($r.prototype=Object.create(null),new $r().__proto__||(ee=!1));function pm(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Jf(r,e,t,n,o){if(typeof t!="function")throw new TypeError("The listener must be a function");var i=new pm(t,n||r,o),s=ee?ee+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],i]:r._events[s].push(i):(r._events[s]=i,r._eventsCount++),r}function Yn(r,e){--r._eventsCount===0?r._events=new $r:delete r._events[e]}function X(){this._events=new $r,this._eventsCount=0}X.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)hm.call(t,n)&&e.push(ee?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};X.prototype.listeners=function(e){var t=ee?ee+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s};X.prototype.listenerCount=function(e){var t=ee?ee+e:e,n=this._events[t];return n?n.fn?1:n.length:0};X.prototype.emit=function(e,t,n,o,i,s){var a=ee?ee+e:e;if(!this._events[a])return!1;var u=this._events[a],f=arguments.length,c,l;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,o),!0;case 5:return u.fn.call(u.context,t,n,o,i),!0;case 6:return u.fn.call(u.context,t,n,o,i,s),!0}for(l=1,c=new Array(f-1);l<f;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h=u.length,g;for(l=0;l<h;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),f){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,o);break;default:if(!c)for(g=1,c=new Array(f-1);g<f;g++)c[g-1]=arguments[g];u[l].fn.apply(u[l].context,c)}}return!0};X.prototype.on=function(e,t,n){return Jf(this,e,t,n,!1)};X.prototype.once=function(e,t,n){return Jf(this,e,t,n,!0)};X.prototype.removeListener=function(e,t,n,o){var i=ee?ee+e:e;if(!this._events[i])return this;if(!t)return Yn(this,i),this;var s=this._events[i];if(s.fn)s.fn===t&&(!o||s.once)&&(!n||s.context===n)&&Yn(this,i);else{for(var a=0,u=[],f=s.length;a<f;a++)(s[a].fn!==t||o&&!s[a].once||n&&s[a].context!==n)&&u.push(s[a]);u.length?this._events[i]=u.length===1?u[0]:u:Yn(this,i)}return this};X.prototype.removeAllListeners=function(e){var t;return e?(t=ee?ee+e:e,this._events[t]&&Yn(this,t)):(this._events=new $r,this._eventsCount=0),this};X.prototype.off=X.prototype.removeListener;X.prototype.addListener=X.prototype.on;X.prefixed=ee;X.EventEmitter=X;typeof Gi<"u"&&(Gi.exports=X)});var as=A((lD,ll)=>{"use strict";var wm=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};ll.exports=wm});var hl=A((yD,dl)=>{"use strict";var Dm=async r=>{for await(let e of r);};dl.exports=Dm});var _l=A((CD,xl)=>{"use strict";var xm=async r=>{for await(let e of r)return e};xl.exports=xm});var ps=A((qD,Ol)=>{"use strict";var Tm=async function*(r,e){for await(let t of r)yield e(t)};Ol.exports=Tm});var Jl=A((lE,Gl)=>{"use strict";async function*Rm(r,e=1){let t=[];e<1&&(e=1);for await(let n of r)for(t.push(n);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}Gl.exports=Rm});var Zl=A((dE,Yl)=>{"use strict";var Nm=Jl();async function*Bm(r,e=1){for await(let t of Nm(r,e)){let n=t.map(o=>o().then(i=>({ok:!0,value:i}),i=>({ok:!1,err:i})));for(let o=0;o<n.length;o++){let i=await n[o];if(i.ok)yield i.value;else throw i.err}}}Yl.exports=Bm});var ed=A((pE,Xl)=>{Xl.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var nd=A((mE,rd)=>{var td=ed();rd.exports=class{constructor(e){this.hwm=e||16,this.head=new td(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new td(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var id=A((gE,od)=>{var Rs=nd();od.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new Rs,n,o,i,s=()=>{if(!t.isEmpty()){if(r.writev){let w,S=[];for(;!t.isEmpty();){if(w=t.shift(),w.error)throw w.error;S.push(w.value)}return{done:w.done,value:S}}let p=t.shift();if(p.error)throw p.error;return p}return i?{done:!0}:new Promise((p,w)=>{o=S=>(o=null,S.error?w(S.error):r.writev&&!S.done?p({done:S.done,value:[S.value]}):p(S),n)})},a=p=>o?o(p):(t.push(p),n),u=p=>(t=new Rs,o?o({error:p}):(t.push({error:p}),n)),f=p=>i?n:a({done:!1,value:p}),c=p=>i?n:(i=!0,p?u(p):a({done:!0})),l=()=>(t=new Rs,c(),{done:!0}),h=p=>(c(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:l,throw:h,push:f,end:c},!e)return n;let g=n;return n={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(p){return g.throw(p),e&&(e(p),e=null),{done:!0}},return(){return g.return(),e&&(e(),e=null),{done:!0}},push:f,end(p){return g.end(p),e&&(e(p),e=null),n}},n}});var Ns=A((wE,sd)=>{"use strict";var Fm=id(),Lm=async function*(...r){let e=Fm();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let n of t)e.push(n)})),e.end()}catch(t){e.end(t)}},0),yield*e};sd.exports=Lm});var Jm={};te(Jm,{createRepo:()=>Qm});var dr=xd;function xd(r,e,t){if(!r)return t;var n,o;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(o=n.shift(),!r||(r=r[o],r===void 0))return t;return r}var yd=x(Be(),1),Ft=x(qe(),1);var Ld=Hs,Ws=128,Md=127,$d=~Md,Ud=Math.pow(2,31);function Hs(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Ud;)e[t++]=r&255|Ws,r/=128;for(;r&$d;)e[t++]=r&255|Ws,r>>>=7;return e[t]=r|0,Hs.bytes=t-n+1,e}var jd=Do,zd=128,Qs=127;function Do(r,n){var t=0,n=n||0,o=0,i=n,s,a=r.length;do{if(i>=a)throw Do.bytes=0,new RangeError("Could not decode varint");s=r[i++],t+=o<28?(s&Qs)<<o:(s&Qs)*Math.pow(2,o),o+=7}while(s>=zd);return Do.bytes=i-n,t}var qd=Math.pow(2,7),Kd=Math.pow(2,14),Vd=Math.pow(2,21),Wd=Math.pow(2,28),Qd=Math.pow(2,35),Hd=Math.pow(2,42),Gd=Math.pow(2,49),Jd=Math.pow(2,56),Yd=Math.pow(2,63),Zd=function(r){return r<qd?1:r<Kd?2:r<Vd?3:r<Wd?4:r<Qd?5:r<Hd?6:r<Gd?7:r<Jd?8:r<Yd?9:10},Xd={encode:Ld,decode:jd,encodingLength:Zd},eh=Xd,hr=eh;var pr=(r,e=0)=>[hr.decode(r,e),hr.decode.bytes],jt=(r,e,t=0)=>(hr.encode(r,e,t),e),zt=r=>hr.encodingLength(r);var og=new Uint8Array(0);var Gs=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},Ke=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Js=r=>new TextEncoder().encode(r),Ys=r=>new TextDecoder().decode(r);var Dt=(r,e)=>{let t=e.byteLength,n=zt(r),o=n+zt(t),i=new Uint8Array(o+t);return jt(r,i,0),jt(t,i,n),i.set(e,o),new qt(r,t,e,i)},Fe=r=>{let e=Ke(r),[t,n]=pr(e),[o,i]=pr(e.subarray(n)),s=e.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new qt(t,o,s,e)},Zs=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&Gs(r.bytes,e.bytes),qt=class{constructor(e,t,n,o){this.code=e,this.size=t,this.digest=n,this.bytes=o}};var Ao={};te(Ao,{base58btc:()=>re,base58flickr:()=>sh});function th(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<r.length;o++){var i=r.charAt(o),s=i.charCodeAt(0);if(t[s]!==255)throw new TypeError(i+" is ambiguous");t[s]=o}var a=r.length,u=r.charAt(0),f=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var w=0,S=0,B=0,J=p.length;B!==J&&p[B]===0;)B++,w++;for(var we=(J-B)*c+1>>>0,Y=new Uint8Array(we);B!==J;){for(var Ce=p[B],be=0,se=we-1;(Ce!==0||be<S)&&se!==-1;se--,be++)Ce+=256*Y[se]>>>0,Y[se]=Ce%a>>>0,Ce=Ce/a>>>0;if(Ce!==0)throw new Error("Non-zero carry");S=be,B++}for(var De=we-S;De!==we&&Y[De]===0;)De++;for(var Lt=u.repeat(w);De<we;++De)Lt+=r.charAt(Y[De]);return Lt}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var w=0;if(p[w]!==" "){for(var S=0,B=0;p[w]===u;)S++,w++;for(var J=(p.length-w)*f+1>>>0,we=new Uint8Array(J);p[w];){var Y=t[p.charCodeAt(w)];if(Y===255)return;for(var Ce=0,be=J-1;(Y!==0||Ce<B)&&be!==-1;be--,Ce++)Y+=a*we[be]>>>0,we[be]=Y%256>>>0,Y=Y/256>>>0;if(Y!==0)throw new Error("Non-zero carry");B=Ce,w++}if(p[w]!==" "){for(var se=J-B;se!==J&&we[se]===0;)se++;for(var De=new Uint8Array(S+(J-se)),Lt=S;se!==J;)De[Lt++]=we[se++];return De}}}function g(p){var w=h(p);if(w)return w;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:g}}var rh=th,nh=rh,Xs=nh;var vo=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},xo=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ea(this,e)}},_o=class{constructor(e){this.decoders=e}or(e){return ea(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},ea=(r,e)=>new _o({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Co=class{constructor(e,t,n,o){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new vo(e,t,n),this.decoder=new xo(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Kt=({name:r,prefix:e,encode:t,decode:n})=>new Co(r,e,t,n),et=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:o}=Xs(t,e);return Kt({prefix:r,name:e,encode:n,decode:i=>Ke(o(i))})},oh=(r,e,t,n)=>{let o={};for(let c=0;c<e.length;++c)o[e[c]]=c;let i=r.length;for(;r[i-1]==="=";)--i;let s=new Uint8Array(i*t/8|0),a=0,u=0,f=0;for(let c=0;c<i;++c){let l=o[r[c]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<t|l,a+=t,a>=8&&(a-=8,s[f++]=255&u>>a)}if(a>=t||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return s},ih=(r,e,t)=>{let n=e[e.length-1]==="=",o=(1<<t)-1,i="",s=0,a=0;for(let u=0;u<r.length;++u)for(a=a<<8|r[u],s+=8;s>t;)s-=t,i+=e[o&a>>s];if(s&&(i+=e[o&a<<t-s]),n)for(;i.length*t&7;)i+="=";return i},M=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Kt({prefix:e,name:r,encode(o){return ih(o,n,t)},decode(o){return oh(o,n,t,r)}});var re=et({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sh=et({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var So={};te(So,{base32:()=>P,base32hex:()=>fh,base32hexpad:()=>dh,base32hexpadupper:()=>hh,base32hexupper:()=>lh,base32pad:()=>uh,base32padupper:()=>ch,base32upper:()=>ah,base32z:()=>ph});var P=M({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ah=M({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uh=M({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ch=M({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fh=M({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lh=M({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dh=M({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hh=M({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ph=M({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var v=class{constructor(e,t,n,o){this.code=t,this.version=e,this.multihash=n,this.bytes=o,this.byteOffset=o.byteOffset,this.byteLength=o.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ln,byteLength:ln,code:fn,version:fn,multihash:fn,bytes:fn,_baseCache:ln,asCID:ln})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==yr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==wh)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return v.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Dt(e,t);return v.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Zs(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:o}=this;switch(n){case 0:return mh(t,o,e||re.encoder);default:return gh(t,o,e||P.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Dh(/^0\.0/,Eh),!!(e&&(e[ra]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof v)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:o,bytes:i}=e;return new v(t,n,o,i||ta(t,n,o.bytes))}else if(e!=null&&e[ra]===!0){let{version:t,multihash:n,code:o}=e,i=Fe(n);return v.create(t,o,i)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==yr)throw new Error(`Version 0 CID must use dag-pb (code: ${yr}) block encoding`);return new v(e,t,n,n.bytes)}case 1:{let o=ta(e,t,n.bytes);return new v(e,t,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return v.create(0,yr,e)}static createV1(e,t){return v.create(1,e,t)}static decode(e){let[t,n]=v.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=v.inspectBytes(e),n=t.size-t.multihashSize,o=Ke(e.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=o.subarray(t.multihashSize-t.digestSize),s=new qt(t.multihashCode,t.digestSize,i,o);return[t.version===0?v.createV0(s):v.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[l,h]=pr(e.subarray(t));return t+=h,l},o=n(),i=yr;if(o===18?(o=0,t=0):o===1&&(i=n()),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=t,a=n(),u=n(),f=t+u,c=f-s;return{version:o,codec:i,multihashCode:a,digestSize:u,multihashSize:c,size:f}}static parse(e,t){let[n,o]=yh(e,t),i=v.decode(o);return i._baseCache.set(n,e),i}},yh=(r,e)=>{switch(r[0]){case"Q":{let t=e||re;return[re.prefix,t.decode(`${re.prefix}${r}`)]}case re.prefix:{let t=e||re;return[re.prefix,t.decode(r)]}case P.prefix:{let t=e||P;return[P.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},mh=(r,e,t)=>{let{prefix:n}=t;if(n!==re.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=e.get(n);if(o==null){let i=t.encode(r).slice(1);return e.set(n,i),i}else return o},gh=(r,e,t)=>{let{prefix:n}=t,o=e.get(n);if(o==null){let i=t.encode(r);return e.set(n,i),i}else return o},yr=112,wh=18,ta=(r,e,t)=>{let n=zt(r),o=n+zt(e),i=new Uint8Array(o+t.byteLength);return jt(r,i,0),jt(e,i,n),i.set(t,o),i},ra=Symbol.for("@ipld/js-cid/CID"),fn={writable:!1,configurable:!1,enumerable:!0},ln={writable:!1,enumerable:!1,configurable:!1},bh="0.0.0-dev",Dh=(r,e)=>{if(r.test(bh))console.warn(e);else throw new Error(e)},Eh=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var na=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var To={};te(To,{identity:()=>vh});var vh=Kt({prefix:"\0",name:"identity",encode:r=>Ys(r),decode:r=>Js(r)});var Oo={};te(Oo,{base2:()=>xh});var xh=M({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Io={};te(Io,{base8:()=>_h});var _h=M({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ko={};te(ko,{base10:()=>Ch});var Ch=et({prefix:"9",name:"base10",alphabet:"0123456789"});var Po={};te(Po,{base16:()=>Ah,base16upper:()=>Sh});var Ah=M({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sh=M({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ro={};te(Ro,{base36:()=>Th,base36upper:()=>Oh});var Th=et({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Oh=et({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var No={};te(No,{base64:()=>Ih,base64pad:()=>kh,base64url:()=>Ph,base64urlpad:()=>Rh});var Ih=M({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kh=M({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ph=M({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rh=M({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Bo={};te(Bo,{base256emoji:()=>Mh});var oa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Nh=oa.reduce((r,e,t)=>(r[t]=e,r),[]),Bh=oa.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Fh(r){return r.reduce((e,t)=>(e+=Nh[t],e),"")}function Lh(r){let e=[];for(let t of r){let n=Bh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var Mh=Kt({prefix:"\u{1F680}",name:"base256emoji",encode:Fh,decode:Lh});var Mo={};te(Mo,{sha256:()=>Vt,sha512:()=>$h});var Lo=({name:r,code:e,encode:t})=>new Fo(r,e,t),Fo=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Dt(this.code,t):t.then(n=>Dt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var sa=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Vt=Lo({name:"sha2-256",code:18,encode:sa("SHA-256")}),$h=Lo({name:"sha2-512",code:19,encode:sa("SHA-512")});var Uo={};te(Uo,{identity:()=>$o});var aa=0,Uh="identity",ua=Ke,jh=r=>Dt(aa,ua(r)),$o={code:aa,name:Uh,encode:ua,digest:jh};var jo=85;var Pg=new TextEncoder,Rg=new TextDecoder;var mr={...To,...Oo,...Io,...ko,...Po,...So,...Ro,...Ao,...No,...Bo},Lg={...Mo,...Uo};function dn(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function fa(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var ca=fa("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),qo=fa("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=dn(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qh={utf8:ca,"utf-8":ca,hex:mr.base16,latin1:qo,ascii:qo,binary:qo,...mr},hn=qh;function I(r,e="utf8"){let t=hn[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function W(r,e="utf8"){let t=hn[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var We="/",la=new TextEncoder().encode(We),pn=la[0],_=class{constructor(e,t){if(typeof e=="string")this._buf=W(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pn)throw new Error("Invalid key")}toString(e="utf8"){return I(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new _(e.join(We))}static random(){return new _(na().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new _(e):typeof e.uint8Array=="function"?new _(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=la),this._buf[0]!==pn){let e=new Uint8Array(this._buf.byteLength+1);e.fill(pn,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pn;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let o=0;o<t.length;o++){if(n.length<o+1)return!1;let i=t[o],s=n[o];if(i<s)return!0;if(i>s)return!1}return t.length<n.length}reverse(){return _.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(We).slice(1)}type(){return Kh(this.baseNamespace())}name(){return Vh(this.baseNamespace())}instance(e){return new _(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(We)||(e+=We),e+=this.type(),new _(e)}parent(){let e=this.list();return e.length===1?new _(We):new _(e.slice(0,-1).join(We))}child(e){return this.toString()===We?e:e.toString()===We?this:new _(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return _.withNamespaces([...this.namespaces(),...Wh(e.map(t=>t.namespaces()))])}};function Kh(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Vh(r){let e=r.split(":");return e[e.length-1]}function Wh(r){return[].concat(...r)}var pa=x(Be(),1),ya=x(Ko(),1);var Hh=(0,pa.default)("ipfs:repo:migrator:migration-8");function ma(r){return r.child?ma(r.child):r}function Gh(r){try{let e=P.decode(`b${r.toString().toLowerCase().slice(1)}`),t=v.decode(e).multihash.bytes,n=P.encode(t).slice(1).toUpperCase();return new _(`/${n}`,!1)}catch{return r}}function Jh(r){try{let e=P.decode(`b${r.toString().toLowerCase().slice(1)}`),t=Fe(e),n=P.encode(v.createV1(jo,t).bytes).slice(1);return new _(`/${n.toUpperCase()}`,!1)}catch{return r}}async function ha(r,e,t){let n=r.blocks;await n.open();let o=ma(n),i=await(0,ya.default)(o.queryKeys({filters:[s=>t(s).toString()!==s.toString()]}));try{let s=0;for await(let a of o.query({})){let u=t(a.key);u.toString()!==a.key.toString()&&(s+=1,Hh(`Migrating Block from ${a.key} to ${u}`,await o.has(a.key)),await o.delete(a.key),await o.put(u,a.value),e(s/i*100,`Migrated Block from ${a.key} to ${u}`))}}finally{await n.close()}}var ga={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>ha(r,e,Gh),revert:(r,e=()=>{})=>ha(r,e,Jh)};var Yh=new TextDecoder;function Vo(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let o=r[e++];if(t+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[t,e]}function yn(r,e){let t;[t,e]=Vo(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function wa(r,e){let t;return[t,e]=Vo(r,e),[t&7,t>>3,e]}function Zh(r){let e={},t=r.length,n=0;for(;n<t;){let o,i;if([o,i,n]=wa(r,n),i===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=yn(r,n)}else if(i===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=yn(r,n),e.Name=Yh.decode(s)}else if(i===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[e.Tsize,n]=Vo(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function ba(r){let e=r.length,t=0,n,o=!1,i;for(;t<e;){let a,u;if([a,u,t]=wa(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(u===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,t]=yn(r,t),n&&(o=!0)}else if(u===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let f;[f,t]=yn(r,t),n.push(Zh(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${u}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return i&&(s.Data=i),s.Links=n||[],s}var Ea=new TextEncoder,Da=2**32,Xh=2**31;function ep(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=gr(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let n=Ea.encode(r.Name);t-=n.length,e.set(n,t),t=gr(e,t,n.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=gr(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function va(r){let e=rp(r),t=new Uint8Array(e),n=e;if(r.Data&&(n-=r.Data.length,t.set(r.Data,n),n=gr(t,n,r.Data.length)-1,t[n]=10),r.Links)for(let o=r.Links.length-1;o>=0;o--){let i=ep(r.Links[o],t.subarray(0,n));n-=i,n=gr(t,n,i)-1,t[n]=18}return t}function tp(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+Wt(t)}if(typeof r.Name=="string"){let t=Ea.encode(r.Name).length;e+=1+t+Wt(t)}return typeof r.Tsize=="number"&&(e+=1+Wt(r.Tsize)),e}function rp(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+Wt(t)}if(r.Links)for(let t of r.Links){let n=tp(t);e+=1+n+Wt(n)}return e}function gr(r,e,t){e-=Wt(t);let n=e;for(;t>=Xh;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,n}function Wt(r){return r%2===0&&r++,Math.floor((np(r)+6)/7)}function np(r){let e=0;return r>=Da&&(r=Math.floor(r/Da),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+op[r]}var op=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var ip=["Data","Links"],sp=["Hash","Name","Tsize"],xa=new TextEncoder;function ap(r,e){if(r===e)return 0;let t=r.Name?xa.encode(r.Name):[],n=e.Name?xa.encode(e.Name):[],o=t.length,i=n.length;for(let s=0,a=Math.min(o,i);s<a;++s)if(t[s]!==n[s]){o=t[s],i=n[s];break}return o<i?-1:i<o?1:0}function _a(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function Ca(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!_a(r,ip))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!_a(t,sp))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&ap(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}var Qe=112;function wr(r){Ca(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let n={};return t.Hash&&(n.Hash=t.Hash.bytes),t.Name!==void 0&&(n.Name=t.Name),t.Tsize!==void 0&&(n.Tsize=t.Tsize),n})),r.Data&&(e.Data=r.Data),va(e)}function br(r){let e=ba(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let o={};try{o.Hash=v.decode(n.Hash)}catch{}if(!o.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(o.Name=n.Name),n.Tsize!==void 0&&(o.Tsize=n.Tsize),o})),t}var up=["string","number","bigint","symbol"],cp=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Aa(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(up.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(fp(r))return"Buffer";let t=lp(r);return t||"Object"}function fp(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function lp(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(cp.includes(e))return e}var d=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};d.uint=new d(0,"uint",!0);d.negint=new d(1,"negint",!0);d.bytes=new d(2,"bytes",!0);d.string=new d(3,"string",!0);d.array=new d(4,"array",!1);d.map=new d(5,"map",!1);d.tag=new d(6,"tag",!1);d.float=new d(7,"float",!0);d.false=new d(7,"false",!0);d.true=new d(7,"true",!0);d.null=new d(7,"null",!0);d.undefined=new d(7,"undefined",!0);d.break=new d(7,"break",!0);var m=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Qt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",dp=new TextDecoder,hp=new TextEncoder;function mn(r){return Qt&&globalThis.Buffer.isBuffer(r)}function Qo(r){return r instanceof Uint8Array?mn(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var Ia=Qt?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):Ta(r,e,t):(r,e,t)=>t-e>64?dp.decode(r.subarray(e,t)):Ta(r,e,t),ka=Qt?r=>r.length>64?globalThis.Buffer.from(r):Sa(r):r=>r.length>64?hp.encode(r):Sa(r),Le=r=>Uint8Array.from(r),Ht=Qt?(r,e,t)=>mn(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),Pa=Qt?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Qo(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let o of r)n+o.length>t.length&&(o=o.subarray(0,t.length-n)),t.set(o,n),n+=o.length;return t},Ra=Qt?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function Na(r,e){if(mn(r)&&mn(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function Sa(r,e=1/0){let t,n=r.length,o=null,i=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!o){if(t>56319){(e-=3)>-1&&i.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=t;continue}if(t<56320){(e-=3)>-1&&i.push(239,191,189),o=t;continue}t=(o-55296<<10|t-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,t<128){if((e-=1)<0)break;i.push(t)}else if(t<2048){if((e-=2)<0)break;i.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;i.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return i}function Ta(r,e,t){let n=[];for(;e<t;){let o=r[e],i=null,s=o>239?4:o>223?3:o>191?2:1;if(e+s<=t){let a,u,f,c;switch(s){case 1:o<128&&(i=o);break;case 2:a=r[e+1],(a&192)===128&&(c=(o&31)<<6|a&63,c>127&&(i=c));break;case 3:a=r[e+1],u=r[e+2],(a&192)===128&&(u&192)===128&&(c=(o&15)<<12|(a&63)<<6|u&63,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:a=r[e+1],u=r[e+2],f=r[e+3],(a&192)===128&&(u&192)===128&&(f&192)===128&&(c=(o&15)<<18|(a&63)<<12|(u&63)<<6|f&63,c>65535&&c<1114112&&(i=c))}}i===null?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),e+=s}return pp(n)}var Oa=4096;function pp(r){let e=r.length;if(e<=Oa)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Oa));return t}var yp=256,Dr=class{constructor(e=yp){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let o=t.length-(this.maxCursor-this.cursor)-1;t.set(e,o)}else{if(t){let o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Ra(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ht(n,0,this.cursor)}else t=Pa(this.chunks,this.cursor);return e&&this.reset(),t}};var C="CBOR decode error:",Ho="CBOR encode error:",Er=[];Er[23]=1;Er[24]=2;Er[25]=3;Er[26]=5;Er[27]=9;function He(r,e,t){if(r.length-e<t)throw new Error(`${C} not enough data for type`)}var Q=[24,256,65536,4294967296,BigInt("18446744073709551616")];function ue(r,e,t){He(r,e,1);let n=r[e];if(t.strict===!0&&n<Q[0])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function ce(r,e,t){He(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<Q[1])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function fe(r,e,t){He(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<Q[2])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function le(r,e,t){He(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],o=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(t.strict===!0&&i<Q[3])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(t.allowBigInt===!0)return i;throw new Error(`${C} integers outside of the safe integer range are not supported`)}function Ba(r,e,t,n){return new m(d.uint,ue(r,e+1,n),2)}function Fa(r,e,t,n){return new m(d.uint,ce(r,e+1,n),3)}function La(r,e,t,n){return new m(d.uint,fe(r,e+1,n),5)}function Ma(r,e,t,n){return new m(d.uint,le(r,e+1,n),9)}function Ee(r,e){return Z(r,0,e.value)}function Z(r,e,t){if(t<Q[0]){let n=Number(t);r.push([e|n])}else if(t<Q[1]){let n=Number(t);r.push([e|24,n])}else if(t<Q[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<Q[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<Q[4]){let o=[e|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=s&255,s=s>>8,o[3]=s&255,s=s>>8,o[2]=s&255,s=s>>8,o[1]=s&255,r.push(o)}else throw new Error(`${C} encountered BigInt larger than allowable range`)}}Ee.encodedSize=function(e){return Z.encodedSize(e.value)};Z.encodedSize=function(e){return e<Q[0]?1:e<Q[1]?2:e<Q[2]?3:e<Q[3]?5:9};Ee.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function $a(r,e,t,n){return new m(d.negint,-1-ue(r,e+1,n),2)}function Ua(r,e,t,n){return new m(d.negint,-1-ce(r,e+1,n),3)}function ja(r,e,t,n){return new m(d.negint,-1-fe(r,e+1,n),5)}var Go=BigInt(-1),za=BigInt(1);function qa(r,e,t,n){let o=le(r,e+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new m(d.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${C} integers outside of the safe integer range are not supported`);return new m(d.negint,Go-BigInt(o),9)}function gn(r,e){let t=e.value,n=typeof t=="bigint"?t*Go-za:t*-1-1;Z(r,e.type.majorEncoded,n)}gn.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*Go-za:t*-1-1;return n<Q[0]?1:n<Q[1]?2:n<Q[2]?3:n<Q[3]?5:9};gn.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function vr(r,e,t,n){He(r,e,t+n);let o=Ht(r,e+t,e+t+n);return new m(d.bytes,o,t+n)}function Ka(r,e,t,n){return vr(r,e,1,t)}function Va(r,e,t,n){return vr(r,e,2,ue(r,e+1,n))}function Wa(r,e,t,n){return vr(r,e,3,ce(r,e+1,n))}function Qa(r,e,t,n){return vr(r,e,5,fe(r,e+1,n))}function Ha(r,e,t,n){let o=le(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer bytes lengths not supported`);return vr(r,e,9,o)}function wn(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===d.string?ka(r.value):r.value),r.encodedBytes}function Gt(r,e){let t=wn(e);Z(r,e.type.majorEncoded,t.length),r.push(t)}Gt.encodedSize=function(e){let t=wn(e);return Z.encodedSize(t.length)+t.length};Gt.compareTokens=function(e,t){return gp(wn(e),wn(t))};function gp(r,e){return r.length<e.length?-1:r.length>e.length?1:Na(r,e)}function xr(r,e,t,n,o){let i=t+n;He(r,e,i);let s=new m(d.string,Ia(r,e+t,e+i),i);return o.retainStringBytes===!0&&(s.byteValue=Ht(r,e+t,e+i)),s}function Ga(r,e,t,n){return xr(r,e,1,t,n)}function Ja(r,e,t,n){return xr(r,e,2,ue(r,e+1,n),n)}function Ya(r,e,t,n){return xr(r,e,3,ce(r,e+1,n),n)}function Za(r,e,t,n){return xr(r,e,5,fe(r,e+1,n),n)}function Xa(r,e,t,n){let o=le(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer string lengths not supported`);return xr(r,e,9,o,n)}var eu=Gt;function Jt(r,e,t,n){return new m(d.array,n,t)}function tu(r,e,t,n){return Jt(r,e,1,t)}function ru(r,e,t,n){return Jt(r,e,2,ue(r,e+1,n))}function nu(r,e,t,n){return Jt(r,e,3,ce(r,e+1,n))}function ou(r,e,t,n){return Jt(r,e,5,fe(r,e+1,n))}function iu(r,e,t,n){let o=le(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer array lengths not supported`);return Jt(r,e,9,o)}function su(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return Jt(r,e,1,1/0)}function bn(r,e){Z(r,d.array.majorEncoded,e.value)}bn.compareTokens=Ee.compareTokens;bn.encodedSize=function(e){return Z.encodedSize(e.value)};function Yt(r,e,t,n){return new m(d.map,n,t)}function au(r,e,t,n){return Yt(r,e,1,t)}function uu(r,e,t,n){return Yt(r,e,2,ue(r,e+1,n))}function cu(r,e,t,n){return Yt(r,e,3,ce(r,e+1,n))}function fu(r,e,t,n){return Yt(r,e,5,fe(r,e+1,n))}function lu(r,e,t,n){let o=le(r,e+1,n);if(typeof o=="bigint")throw new Error(`${C} 64-bit integer map lengths not supported`);return Yt(r,e,9,o)}function du(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return Yt(r,e,1,1/0)}function Dn(r,e){Z(r,d.map.majorEncoded,e.value)}Dn.compareTokens=Ee.compareTokens;Dn.encodedSize=function(e){return Z.encodedSize(e.value)};function hu(r,e,t,n){return new m(d.tag,t,1)}function pu(r,e,t,n){return new m(d.tag,ue(r,e+1,n),2)}function yu(r,e,t,n){return new m(d.tag,ce(r,e+1,n),3)}function mu(r,e,t,n){return new m(d.tag,fe(r,e+1,n),5)}function gu(r,e,t,n){return new m(d.tag,le(r,e+1,n),9)}function En(r,e){Z(r,d.tag.majorEncoded,e.value)}En.compareTokens=Ee.compareTokens;En.encodedSize=function(e){return Z.encodedSize(e.value)};var xp=20,_p=21,Cp=22,Ap=23;function wu(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${C} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new m(d.null,null,1):new m(d.undefined,void 0,1)}function bu(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return new m(d.break,void 0,1)}function Jo(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${C} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${C} Infinity values are not supported`)}return new m(d.float,r,e)}function Du(r,e,t,n){return Jo(Yo(r,e+1),3,n)}function Eu(r,e,t,n){return Jo(Zo(r,e+1),5,n)}function vu(r,e,t,n){return Jo(Au(r,e+1),9,n)}function vn(r,e,t){let n=e.value;if(n===!1)r.push([d.float.majorEncoded|xp]);else if(n===!0)r.push([d.float.majorEncoded|_p]);else if(n===null)r.push([d.float.majorEncoded|Cp]);else if(n===void 0)r.push([d.float.majorEncoded|Ap]);else{let o,i=!1;(!t||t.float64!==!0)&&(_u(n),o=Yo(Ae,1),n===o||Number.isNaN(n)?(Ae[0]=249,r.push(Ae.slice(0,3)),i=!0):(Cu(n),o=Zo(Ae,1),n===o&&(Ae[0]=250,r.push(Ae.slice(0,5)),i=!0))),i||(Sp(n),o=Au(Ae,1),Ae[0]=251,r.push(Ae.slice(0,9)))}}vn.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){_u(n);let o=Yo(Ae,1);if(n===o||Number.isNaN(n))return 3;if(Cu(n),o=Zo(Ae,1),n===o)return 5}return 9};var xu=new ArrayBuffer(9),ve=new DataView(xu,1),Ae=new Uint8Array(xu,0);function _u(r){if(r===1/0)ve.setUint16(0,31744,!1);else if(r===-1/0)ve.setUint16(0,64512,!1);else if(Number.isNaN(r))ve.setUint16(0,32256,!1);else{ve.setFloat32(0,r);let e=ve.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)ve.setUint16(0,31744,!1);else if(t===0)ve.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let o=t-127;o<-24?ve.setUint16(0,0):o<-14?ve.setUint16(0,(e&2147483648)>>16|1<<24+o,!1):ve.setUint16(0,(e&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Yo(r,e){if(r.length-e<2)throw new Error(`${C} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,o=t&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,t&32768?-i:i}function Cu(r){ve.setFloat32(0,r,!1)}function Zo(r,e){if(r.length-e<4)throw new Error(`${C} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function Sp(r){ve.setFloat64(0,r,!1)}function Au(r,e){if(r.length-e<8)throw new Error(`${C} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}vn.compareTokens=Ee.compareTokens;function O(r,e,t){throw new Error(`${C} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function xn(r){return()=>{throw new Error(`${C} ${r}`)}}var y=[];for(let r=0;r<=23;r++)y[r]=O;y[24]=Ba;y[25]=Fa;y[26]=La;y[27]=Ma;y[28]=O;y[29]=O;y[30]=O;y[31]=O;for(let r=32;r<=55;r++)y[r]=O;y[56]=$a;y[57]=Ua;y[58]=ja;y[59]=qa;y[60]=O;y[61]=O;y[62]=O;y[63]=O;for(let r=64;r<=87;r++)y[r]=Ka;y[88]=Va;y[89]=Wa;y[90]=Qa;y[91]=Ha;y[92]=O;y[93]=O;y[94]=O;y[95]=xn("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)y[r]=Ga;y[120]=Ja;y[121]=Ya;y[122]=Za;y[123]=Xa;y[124]=O;y[125]=O;y[126]=O;y[127]=xn("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)y[r]=tu;y[152]=ru;y[153]=nu;y[154]=ou;y[155]=iu;y[156]=O;y[157]=O;y[158]=O;y[159]=su;for(let r=160;r<=183;r++)y[r]=au;y[184]=uu;y[185]=cu;y[186]=fu;y[187]=lu;y[188]=O;y[189]=O;y[190]=O;y[191]=du;for(let r=192;r<=215;r++)y[r]=hu;y[216]=pu;y[217]=yu;y[218]=mu;y[219]=gu;y[220]=O;y[221]=O;y[222]=O;y[223]=O;for(let r=224;r<=243;r++)y[r]=xn("simple values are not supported");y[244]=O;y[245]=O;y[246]=O;y[247]=wu;y[248]=xn("simple values are not supported");y[249]=Du;y[250]=Eu;y[251]=vu;y[252]=O;y[253]=O;y[254]=O;y[255]=bu;var Se=[];for(let r=0;r<24;r++)Se[r]=new m(d.uint,r,1);for(let r=-1;r>=-24;r--)Se[31-r]=new m(d.negint,r,1);Se[64]=new m(d.bytes,new Uint8Array(0),1);Se[96]=new m(d.string,"",1);Se[128]=new m(d.array,0,1);Se[160]=new m(d.map,0,1);Se[244]=new m(d.false,!1,1);Se[245]=new m(d.true,!0,1);Se[246]=new m(d.null,null,1);function Su(r){switch(r.type){case d.false:return Le([244]);case d.true:return Le([245]);case d.null:return Le([246]);case d.bytes:return r.value.length?void 0:Le([64]);case d.string:return r.value===""?Le([96]):void 0;case d.array:return r.value===0?Le([128]):void 0;case d.map:return r.value===0?Le([160]):void 0;case d.uint:return r.value<24?Le([Number(r.value)]):void 0;case d.negint:if(r.value>=-24)return Le([31-Number(r.value)])}}var Op={float64:!1,mapSorter:Pp,quickEncodeToken:Su};function Ip(){let r=[];return r[d.uint.major]=Ee,r[d.negint.major]=gn,r[d.bytes.major]=Gt,r[d.string.major]=eu,r[d.array.major]=bn,r[d.map.major]=Dn,r[d.tag.major]=En,r[d.float.major]=vn,r}var Tu=Ip(),Xo=new Dr,Zt=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Ho} object contains circular references`);return new Zt(t,e)}},tt={null:new m(d.null,null),undefined:new m(d.undefined,void 0),true:new m(d.true,!0),false:new m(d.false,!1),emptyArray:new m(d.array,0),emptyMap:new m(d.map,0)},rt={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new m(d.float,r):r>=0?new m(d.uint,r):new m(d.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new m(d.uint,r):new m(d.negint,r)},Uint8Array(r,e,t,n){return new m(d.bytes,r)},string(r,e,t,n){return new m(d.string,r)},boolean(r,e,t,n){return r?tt.true:tt.false},null(r,e,t,n){return tt.null},undefined(r,e,t,n){return tt.undefined},ArrayBuffer(r,e,t,n){return new m(d.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new m(d.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[tt.emptyArray,new m(d.break)]:tt.emptyArray;n=Zt.createCheck(n,r);let o=[],i=0;for(let s of r)o[i++]=_n(s,t,n);return t.addBreakTokens?[new m(d.array,r.length),o,new m(d.break)]:[new m(d.array,r.length),o]},Object(r,e,t,n){let o=e!=="Object",i=o?r.keys():Object.keys(r),s=o?r.size:i.length;if(!s)return t.addBreakTokens===!0?[tt.emptyMap,new m(d.break)]:tt.emptyMap;n=Zt.createCheck(n,r);let a=[],u=0;for(let f of i)a[u++]=[_n(f,t,n),_n(o?r.get(f):r[f],t,n)];return kp(a,t),t.addBreakTokens?[new m(d.map,s),a,new m(d.break)]:[new m(d.map,s),a]}};rt.Map=rt.Object;rt.Buffer=rt.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))rt[`${r}Array`]=rt.DataView;function _n(r,e={},t){let n=Aa(r),o=e&&e.typeEncoders&&e.typeEncoders[n]||rt[n];if(typeof o=="function"){let s=o(r,n,e,t);if(s!=null)return s}let i=rt[n];if(!i)throw new Error(`${Ho} unsupported type: ${n}`);return i(r,n,e,t)}function kp(r,e){e.mapSorter&&r.sort(e.mapSorter)}function Pp(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let o=t.type.major,i=Tu[o].compareTokens(t,n);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function Ou(r,e,t,n){if(Array.isArray(e))for(let o of e)Ou(r,o,t,n);else t[e.type.major](r,e,n)}function Rp(r,e,t){let n=_n(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let o=t.quickEncodeToken(n);if(o)return o;let i=e[n.type.major];if(i.encodedSize){let s=i.encodedSize(n,t),a=new Dr(s);if(i(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Qo(a.chunks[0])}}return Xo.reset(),Ou(Xo,n,e,t),Xo.toBytes(!0)}function vt(r,e){return e=Object.assign({},Op,e),Rp(r,Tu,e)}var Np={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},ei=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Se[e];if(t===void 0){let n=y[e];if(!n)throw new Error(`${C} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let o=e&31;t=n(this.data,this.pos,o,this.options)}return this.pos+=t.encodedLength,t}},_r=Symbol.for("DONE"),Cn=Symbol.for("BREAK");function Bp(r,e,t){let n=[];for(let o=0;o<r.value;o++){let i=Cr(e,t);if(i===Cn){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed array`)}if(i===_r)throw new Error(`${C} found array but not enough entries (got ${o}, expected ${r.value})`);n[o]=i}return n}function Fp(r,e,t){let n=t.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<r.value;s++){let a=Cr(e,t);if(a===Cn){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed map`)}if(a===_r)throw new Error(`${C} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${C} non-string keys not supported (got ${typeof a})`);let u=Cr(e,t);if(u===_r)throw new Error(`${C} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?i.set(a,u):o[a]=u}return n?i:o}function Cr(r,e){if(r.done())return _r;let t=r.next();if(t.type===d.break)return Cn;if(t.type.terminal)return t.value;if(t.type===d.array)return Bp(t,r,e);if(t.type===d.map)return Fp(t,r,e);if(t.type===d.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=Cr(r,e);return e.tags[t.value](n)}throw new Error(`${C} tag not supported (${t.value})`)}throw new Error("unsupported")}function Me(r,e){if(!(r instanceof Uint8Array))throw new Error(`${C} data to decode must be a Uint8Array`);e=Object.assign({},Np,e);let t=e.tokenizer||new ei(r,e),n=Cr(t,e);if(n===_r)throw new Error(`${C} did not find any content to decode`);if(n===Cn)throw new Error(`${C} got unexpected break`);if(!t.done())throw new Error(`${C} too many terminals, data makes no sense`);return n}var Ct=x(st(),1),Sc=Ct.default.Reader,Wp=Ct.default.Writer,Sb=Ct.default.util,In=Ct.default.roots.default||(Ct.default.roots.default={}),Tc=In.ipfs=(()=>{let r={};return r.pin=function(){let e={};return e.Set=function(){function t(n){if(n)for(var o=Object.keys(n),i=0;i<o.length;++i)n[o[i]]!=null&&(this[o[i]]=n[o[i]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(o,i){return i||(i=Wp.create()),o.version!=null&&Object.hasOwnProperty.call(o,"version")&&i.uint32(8).uint32(o.version),o.fanout!=null&&Object.hasOwnProperty.call(o,"fanout")&&i.uint32(16).uint32(o.fanout),o.seed!=null&&Object.hasOwnProperty.call(o,"seed")&&i.uint32(29).fixed32(o.seed),i},t.decode=function(o,i){o instanceof Sc||(o=Sc.create(o));for(var s=i===void 0?o.len:o.pos+i,a=new In.ipfs.pin.Set;o.pos<s;){var u=o.uint32();switch(u>>>3){case 1:a.version=o.uint32();break;case 2:a.fanout=o.uint32();break;case 3:a.seed=o.fixed32();break;default:o.skipType(u&7);break}}return a},t.fromObject=function(o){if(o instanceof In.ipfs.pin.Set)return o;var i=new In.ipfs.pin.Set;return o.version!=null&&(i.version=o.version>>>0),o.fanout!=null&&(i.fanout=o.fanout>>>0),o.seed!=null&&(i.seed=o.seed>>>0),i},t.toObject=function(o,i){i||(i={});var s={};return i.defaults&&(s.version=0,s.fanout=0,s.seed=0),o.version!=null&&o.hasOwnProperty("version")&&(s.version=o.version),o.fanout!=null&&o.hasOwnProperty("fanout")&&(s.fanout=o.fanout),o.seed!=null&&o.hasOwnProperty("seed")&&(s.seed=o.seed),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ct.default.util.toJSONOptions)},t}(),e}(),r})();var zc=x(Ic(),1),Rn=x(Or(),1);var Ir=new _("/local/pins"),Pn=256,Uc=8192,gi=v.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),At={direct:"direct",recursive:"recursive"};function wi(r){return new _(`/${P.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}function de(r,e){e||(e=r.reduce((o,i)=>o+i.length,0));let t=dn(e),n=0;for(let o of r)t.set(o,n),n+=o.length;return t}function jc(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}var bi=Tc.pin.Set;function sy(r){let e=r.Data;if(!e)throw new Error("No data present");let t=Rn.default.decode(e),n=Rn.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+t>e.length)throw new Error("Impossibly large set header length");let o=e.slice(n,t+n),i=bi.toObject(bi.decode(o),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(i.version!==1)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:e.slice(t+n)}}function ay(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let o=W(e.toString()),i=de([t,o],t.byteLength+o.byteLength);return(0,zc.default)(I(i))}async function*qc(r,e){let t=sy(e),n=0;for(let o of e.Links){if(n<t.header.fanout){let i=o.Hash;if(!gi.equals(i)){let s=await r.get(i),a=br(s);yield*qc(r,a)}}else yield o.Hash;n++}}async function*kr(r,e,t){let n=e.Links.find(s=>s.Name===t);if(!n)throw new Error("No link found with name "+t);let o=await r.get(n.Hash),i=br(o);yield*qc(r,i)}function uy(r,e){return t(e,0);async function t(n,o){let i=bi.encode({version:1,fanout:Pn,seed:o}).finish(),s=Rn.default.encode(i.length),a=de([s,i]),u=[];for(let c=0;c<Pn;c++)u.push({Name:"",Tsize:1,Hash:gi});if(n.length<=Uc){let c=n.map(g=>({link:{Name:"",Tsize:1,Hash:g.key},data:g.data||new Uint8Array})).sort((g,p)=>jc(g.link.Hash.bytes,p.link.Hash.bytes)),l=u.concat(c.map(g=>g.link));return{Data:de([a,...c.map(g=>g.data)]),Links:l}}else{let c=n.reduce((h,g)=>{let p=ay(o,g.key)%Pn;return h[p]=p in h?h[p].concat([g]):[g],h},[]),l=0;for(let h of c){let g=await t(h,o+1);await f(g,l),l++}return{Data:a,Links:u}}async function f(c,l){let h=wr(c),g=await Vt.digest(h),p=v.createV0(g);await r.put(p,h);let w=c.Links.reduce((S,B)=>S+(B.Tsize||0),0)+h.length;u[l]={Name:"",Tsize:w,Hash:p}}}}async function Di(r,e,t){let n=await uy(r,t.map(u=>({key:u}))),o=wr(n),i=await Vt.digest(o),s=v.createV0(i);await r.put(s,o);let a=n.Links.reduce((u,f)=>u+f.Tsize,0)+o.length;return{Name:e,Tsize:a,Hash:s}}var Nn=x(Ko(),1);async function fy(r,e,t,n){if(!await e.has(Ir))return;let o=await e.get(Ir),i=v.decode(o),s=await r.get(i),a=br(s),u=0,f=await(0,Nn.default)(kr(r,a,At.recursive))+await(0,Nn.default)(kr(r,a,At.direct));for await(let c of kr(r,a,At.recursive)){u++;let l={depth:1/0};c.version!==0&&(l.version=c.version),c.code!==Qe&&(l.codec=c.code),await t.put(wi(c),vt(l)),n(u/f*100,`Migrated recursive pin ${c}`)}for await(let c of kr(r,a,At.direct)){u++;let l={depth:0};c.version!==0&&(l.version=c.version),c.code!==Qe&&(l.codec=c.code),await t.put(wi(c),vt(l)),n(u/f*100,`Migrated direct pin ${c}`)}await r.delete(i),await e.delete(Ir)}async function ly(r,e,t,n){let o=[],i=[],s=0,a=await(0,Nn.default)(t.queryKeys({}));for await(let{key:h,value:g}of t.query({})){s++;let p=Me(g),w=v.create(p.version||0,p.codec||Qe,Fe(P.decode("b"+h.toString().toLowerCase().split("/").pop())));p.depth===0?(n(s/a*100,`Reverted direct pin ${w}`),i.push(w)):(n(s/a*100,`Reverted recursive pin ${w}`),o.push(w))}n(100,"Updating pin root");let u={Links:[await Di(r,At.direct,i),await Di(r,At.recursive,o)]},f=wr(u),c=await Vt.digest(f),l=v.createV0(c);await r.put(l,f),await e.put(Ir,l.bytes)}async function Kc(r,e,t){let n=r.blocks,o=r.datastore,i=r.pins;await n.open(),await o.open(),await i.open();try{await t(n,o,i,e)}finally{await i.close(),await o.close(),await n.close()}}var Vc={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>Kc(r,e,fy),revert:(r,e=()=>{})=>Kc(r,e,ly)};var Wc=x(qe(),1);function Pr(r){return r=r||new Error("Not Found"),(0,Wc.default)(r,"ERR_NOT_FOUND")}var Qc=new _("/config"),Rr=new _("/version");function Nr(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function dy(r,e,t){let n=await e(r);if(n)return n;let o=Nr(t);return o?new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}}):!1}async function hy(r,e,t,n){if(await t(r))return e(r);let o=Nr(n);if(!o)throw Pr();return new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);s(Pr())}})}function Bn(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=n=>hy(n,e,t,r),r.has=n=>dy(n,t,r),r}function Ei(r){return{...r,root:Bn(r.root),datastore:Bn(r.datastore),pins:Bn(r.pins),keys:Bn(r.keys)}}async function py(r,e,t=()=>{}){let n=Nr(e);if(!n){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await Yc(n,(i,s)=>[{type:"del",key:i},{type:"put",key:W(i),value:s}])}async function yy(r,e,t=()=>{}){let n=Nr(e);if(!n){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await Yc(n,(i,s)=>[{type:"del",key:i},{type:"put",key:I(i),value:s}])}function Gc(r){return r.child?Gc(r.child):r}async function Hc(r,e,t){let n=Object.entries(r).map(([s,a])=>({key:s,backend:Gc(a)})).filter(({key:s,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:s,backend:a})=>({name:s,store:a}));e(0,`Migrating ${n.length} dbs`);let o=0,i=s=>{e(Math.round(o/n.length*100),s)};for(let{name:s,store:a}of n){await a.open();try{await t(s,a,i)}finally{o++,await a.close()}}e(100,`Migrated ${n.length} dbs`)}var Jc={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>Hc(r,e,py),revert:(r,e=()=>{})=>Hc(r,e,yy)};function Yc(r,e){function t(n,o){let i=r.store("readwrite"),s=i.transaction,a=0,u;s.onabort=()=>o(u||s.error||new Error("aborted by user")),s.oncomplete=()=>o();function f(){let c=n[a++],l=c.key,h;try{h=c.type==="del"?i.delete(l):i.put(c.value,l)}catch(g){u=g,s.abort();return}a<n.length&&(h.onsuccess=f)}f()}return new Promise((n,o)=>{let i=r.iterator(),s=u=>u;i._deserializeKey=i._deserializeValue=s,a();function a(){let u=(f,c,l)=>{if(f||c===void 0){let h=g=>{if(g){o(g);return}n()};i.end(h);return}t(e(c,l),a)};i.next(u)}})}var at=new _("/local/filesroot");async function my(r,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open(),await r.root.has(at)){let t=await r.root.get(at);await r.datastore.put(at,t),await r.root.delete(at)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function gy(r,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open(),await r.datastore.has(at)){let t=await r.datastore.get(at);await r.root.put(at,t),await r.datastore.delete(at)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}var Zc={version:11,description:"Store mfs root in the datastore",migrate:my,revert:gy};var qi=x(st(),1);var St=x(st(),1),Xc=St.default.Reader,wy=St.default.Writer,by=St.default.util,Fn=St.default.roots.default||(St.default.roots.default={}),vi=Fn.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.protocols=by.emptyArray,r.encode=function(t,n){if(n||(n=wy.create()),t.protocols!=null&&t.protocols.length)for(var o=0;o<t.protocols.length;++o)n.uint32(10).string(t.protocols[o]);return n},r.decode=function(t,n){t instanceof Xc||(t=Xc.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new Fn.Protocols;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.protocols&&i.protocols.length||(i.protocols=[]),i.protocols.push(t.string());break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof Fn.Protocols)return t;var n=new Fn.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var o=0;o<t.protocols.length;++o)n.protocols[o]=String(t.protocols[o])}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.protocols=[]),t.protocols&&t.protocols.length){o.protocols=[];for(var i=0;i<t.protocols.length;++i)o.protocols[i]=t.protocols[i]}return o},r.prototype.toJSON=function(){return this.constructor.toObject(this,St.default.util.toJSONOptions)},r})();var Ge=x(st(),1),er=Ge.default.Reader,xi=Ge.default.Writer,R=Ge.default.util,G=Ge.default.roots.default||(Ge.default.roots.default={}),_i=G.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.addrs=R.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,n){if(n||(n=xi.create()),t.addrs!=null&&t.addrs.length)for(var o=0;o<t.addrs.length;++o)G.Addresses.Address.encode(t.addrs[o],n.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&G.Addresses.CertifiedRecord.encode(t.certifiedRecord,n.uint32(18).fork()).ldelim(),n},r.decode=function(t,n){t instanceof er||(t=er.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new G.Addresses;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.addrs&&i.addrs.length||(i.addrs=[]),i.addrs.push(G.Addresses.Address.decode(t,t.uint32()));break;case 2:i.certifiedRecord=G.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof G.Addresses)return t;var n=new G.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var o=0;o<t.addrs.length;++o){if(typeof t.addrs[o]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[o]=G.Addresses.Address.fromObject(t.addrs[o])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=G.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.addrs=[]),n.defaults&&(o.certifiedRecord=null),t.addrs&&t.addrs.length){o.addrs=[];for(var i=0;i<t.addrs.length;++i)o.addrs[i]=G.Addresses.Address.toObject(t.addrs[i],n)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(o.certifiedRecord=G.Addresses.CertifiedRecord.toObject(t.certifiedRecord,n)),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ge.default.util.toJSONOptions)},r.Address=function(){function e(n){if(n)for(var o=Object.keys(n),i=0;i<o.length;++i)n[o[i]]!=null&&(this[o[i]]=n[o[i]])}e.prototype.multiaddr=R.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:R.oneOfGetter(t=["isCertified"]),set:R.oneOfSetter(t)}),e.encode=function(o,i){return i||(i=xi.create()),o.multiaddr!=null&&Object.hasOwnProperty.call(o,"multiaddr")&&i.uint32(10).bytes(o.multiaddr),o.isCertified!=null&&Object.hasOwnProperty.call(o,"isCertified")&&i.uint32(16).bool(o.isCertified),i},e.decode=function(o,i){o instanceof er||(o=er.create(o));for(var s=i===void 0?o.len:o.pos+i,a=new G.Addresses.Address;o.pos<s;){var u=o.uint32();switch(u>>>3){case 1:a.multiaddr=o.bytes();break;case 2:a.isCertified=o.bool();break;default:o.skipType(u&7);break}}return a},e.fromObject=function(o){if(o instanceof G.Addresses.Address)return o;var i=new G.Addresses.Address;return o.multiaddr!=null&&(typeof o.multiaddr=="string"?R.base64.decode(o.multiaddr,i.multiaddr=R.newBuffer(R.base64.length(o.multiaddr)),0):o.multiaddr.length&&(i.multiaddr=o.multiaddr)),o.isCertified!=null&&(i.isCertified=Boolean(o.isCertified)),i},e.toObject=function(o,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=R.newBuffer(s.multiaddr)))),o.multiaddr!=null&&o.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?R.base64.encode(o.multiaddr,0,o.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(o.multiaddr):o.multiaddr),o.isCertified!=null&&o.hasOwnProperty("isCertified")&&(s.isCertified=o.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ge.default.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}return e.prototype.seq=R.Long?R.Long.fromBits(0,0,!0):0,e.prototype.raw=R.newBuffer([]),e.encode=function(n,o){return o||(o=xi.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&o.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&o.uint32(18).bytes(n.raw),o},e.decode=function(n,o){n instanceof er||(n=er.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new G.Addresses.CertifiedRecord;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.seq=n.uint64();break;case 2:s.raw=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof G.Addresses.CertifiedRecord)return n;var o=new G.Addresses.CertifiedRecord;return n.seq!=null&&(R.Long?(o.seq=R.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?o.seq=parseInt(n.seq,10):typeof n.seq=="number"?o.seq=n.seq:typeof n.seq=="object"&&(o.seq=new R.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?R.base64.decode(n.raw,o.raw=R.newBuffer(R.base64.length(n.raw)),0):n.raw.length&&(o.raw=n.raw)),o},e.toObject=function(n,o){o||(o={});var i={};if(o.defaults){if(R.Long){var s=new R.Long(0,0,!0);i.seq=o.longs===String?s.toString():o.longs===Number?s.toNumber():s}else i.seq=o.longs===String?"0":0;o.bytes===String?i.raw="":(i.raw=[],o.bytes!==Array&&(i.raw=R.newBuffer(i.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?i.seq=o.longs===String?String(n.seq):n.seq:i.seq=o.longs===String?R.Long.prototype.toString.call(n.seq):o.longs===Number?new R.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(i.raw=o.bytes===String?R.base64.encode(n.raw,0,n.raw.length):o.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ge.default.util.toJSONOptions)},e}(),r})();var Je=x(st(),1),tr=Je.default.Reader,Ci=Je.default.Writer,k=Je.default.util,q=Je.default.roots.default||(Je.default.roots.default={}),Ai=q.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}r.prototype.addresses=k.emptyArray,r.prototype.protocols=k.emptyArray,r.prototype.metadata=k.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(r.prototype,"_pubKey",{get:k.oneOfGetter(e=["pubKey"]),set:k.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:k.oneOfGetter(e=["peerRecordEnvelope"]),set:k.oneOfSetter(e)}),r.encode=function(n,o){if(o||(o=Ci.create()),n.addresses!=null&&n.addresses.length)for(var i=0;i<n.addresses.length;++i)q.Address.encode(n.addresses[i],o.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var i=0;i<n.protocols.length;++i)o.uint32(18).string(n.protocols[i]);if(n.metadata!=null&&n.metadata.length)for(var i=0;i<n.metadata.length;++i)q.Metadata.encode(n.metadata[i],o.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&o.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&o.uint32(42).bytes(n.peerRecordEnvelope),o},r.decode=function(n,o){n instanceof tr||(n=tr.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new q.Peer;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(q.Address.decode(n,n.uint32()));break;case 2:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(n.string());break;case 3:s.metadata&&s.metadata.length||(s.metadata=[]),s.metadata.push(q.Metadata.decode(n,n.uint32()));break;case 4:s.pubKey=n.bytes();break;case 5:s.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return s},r.fromObject=function(n){if(n instanceof q.Peer)return n;var o=new q.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");o.addresses=[];for(var i=0;i<n.addresses.length;++i){if(typeof n.addresses[i]!="object")throw TypeError(".Peer.addresses: object expected");o.addresses[i]=q.Address.fromObject(n.addresses[i])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");o.protocols=[];for(var i=0;i<n.protocols.length;++i)o.protocols[i]=String(n.protocols[i])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");o.metadata=[];for(var i=0;i<n.metadata.length;++i){if(typeof n.metadata[i]!="object")throw TypeError(".Peer.metadata: object expected");o.metadata[i]=q.Metadata.fromObject(n.metadata[i])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?k.base64.decode(n.pubKey,o.pubKey=k.newBuffer(k.base64.length(n.pubKey)),0):n.pubKey.length&&(o.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?k.base64.decode(n.peerRecordEnvelope,o.peerRecordEnvelope=k.newBuffer(k.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(o.peerRecordEnvelope=n.peerRecordEnvelope)),o},r.toObject=function(n,o){o||(o={});var i={};if((o.arrays||o.defaults)&&(i.addresses=[],i.protocols=[],i.metadata=[]),n.addresses&&n.addresses.length){i.addresses=[];for(var s=0;s<n.addresses.length;++s)i.addresses[s]=q.Address.toObject(n.addresses[s],o)}if(n.protocols&&n.protocols.length){i.protocols=[];for(var s=0;s<n.protocols.length;++s)i.protocols[s]=n.protocols[s]}if(n.metadata&&n.metadata.length){i.metadata=[];for(var s=0;s<n.metadata.length;++s)i.metadata[s]=q.Metadata.toObject(n.metadata[s],o)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(i.pubKey=o.bytes===String?k.base64.encode(n.pubKey,0,n.pubKey.length):o.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,o.oneofs&&(i._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(i.peerRecordEnvelope=o.bytes===String?k.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):o.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,o.oneofs&&(i._peerRecordEnvelope="peerRecordEnvelope")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,Je.default.util.toJSONOptions)},r})(),l0=q.Address=(()=>{function r(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}r.prototype.multiaddr=k.newBuffer([]),r.prototype.isCertified=null;let e;return Object.defineProperty(r.prototype,"_isCertified",{get:k.oneOfGetter(e=["isCertified"]),set:k.oneOfSetter(e)}),r.encode=function(n,o){return o||(o=Ci.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&o.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&o.uint32(16).bool(n.isCertified),o},r.decode=function(n,o){n instanceof tr||(n=tr.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new q.Address;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;case 2:s.isCertified=n.bool();break;default:n.skipType(a&7);break}}return s},r.fromObject=function(n){if(n instanceof q.Address)return n;var o=new q.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?k.base64.decode(n.multiaddr,o.multiaddr=k.newBuffer(k.base64.length(n.multiaddr)),0):n.multiaddr.length&&(o.multiaddr=n.multiaddr)),n.isCertified!=null&&(o.isCertified=Boolean(n.isCertified)),o},r.toObject=function(n,o){o||(o={});var i={};return o.defaults&&(o.bytes===String?i.multiaddr="":(i.multiaddr=[],o.bytes!==Array&&(i.multiaddr=k.newBuffer(i.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=o.bytes===String?k.base64.encode(n.multiaddr,0,n.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(i.isCertified=n.isCertified,o.oneofs&&(i._isCertified="isCertified")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,Je.default.util.toJSONOptions)},r})(),d0=q.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.key="",r.prototype.value=k.newBuffer([]),r.encode=function(t,n){return n||(n=Ci.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&n.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&n.uint32(18).bytes(t.value),n},r.decode=function(t,n){t instanceof tr||(t=tr.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new q.Metadata;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.key=t.string();break;case 2:i.value=t.bytes();break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof q.Metadata)return t;var n=new q.Metadata;return t.key!=null&&(n.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?k.base64.decode(t.value,n.value=k.newBuffer(k.base64.length(t.value)),0):t.value.length&&(n.value=t.value)),n},r.toObject=function(t,n){n||(n={});var o={};return n.defaults&&(o.key="",n.bytes===String?o.value="":(o.value=[],n.bytes!==Array&&(o.value=k.newBuffer(o.value)))),t.key!=null&&t.hasOwnProperty("key")&&(o.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(o.value=n.bytes===String?k.base64.encode(t.value,0,t.value.length):n.bytes===Array?Array.prototype.slice.call(t.value):t.value),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Je.default.util.toJSONOptions)},r})();var Tt=x(st(),1),ef=Tt.default.Reader,Dy=Tt.default.Writer,N=Tt.default.util,Ln=Tt.default.roots.default||(Tt.default.roots.default={}),tf=Ln.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.publicKey=N.newBuffer([]),r.prototype.payloadType=N.newBuffer([]),r.prototype.payload=N.newBuffer([]),r.prototype.signature=N.newBuffer([]),r.encode=function(t,n){return n||(n=Dy.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&n.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&n.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&n.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&n.uint32(42).bytes(t.signature),n},r.decode=function(t,n){t instanceof ef||(t=ef.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new Ln.Envelope;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.publicKey=t.bytes();break;case 2:i.payloadType=t.bytes();break;case 3:i.payload=t.bytes();break;case 5:i.signature=t.bytes();break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof Ln.Envelope)return t;var n=new Ln.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?N.base64.decode(t.publicKey,n.publicKey=N.newBuffer(N.base64.length(t.publicKey)),0):t.publicKey.length&&(n.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?N.base64.decode(t.payloadType,n.payloadType=N.newBuffer(N.base64.length(t.payloadType)),0):t.payloadType.length&&(n.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?N.base64.decode(t.payload,n.payload=N.newBuffer(N.base64.length(t.payload)),0):t.payload.length&&(n.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?N.base64.decode(t.signature,n.signature=N.newBuffer(N.base64.length(t.signature)),0):t.signature.length&&(n.signature=t.signature)),n},r.toObject=function(t,n){n||(n={});var o={};return n.defaults&&(n.bytes===String?o.publicKey="":(o.publicKey=[],n.bytes!==Array&&(o.publicKey=N.newBuffer(o.publicKey))),n.bytes===String?o.payloadType="":(o.payloadType=[],n.bytes!==Array&&(o.payloadType=N.newBuffer(o.payloadType))),n.bytes===String?o.payload="":(o.payload=[],n.bytes!==Array&&(o.payload=N.newBuffer(o.payload))),n.bytes===String?o.signature="":(o.signature=[],n.bytes!==Array&&(o.signature=N.newBuffer(o.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(o.publicKey=n.bytes===String?N.base64.encode(t.publicKey,0,t.publicKey.length):n.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(o.payloadType=n.bytes===String?N.base64.encode(t.payloadType,0,t.payloadType.length):n.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(o.payload=n.bytes===String?N.base64.encode(t.payload,0,t.payload.length):n.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(o.signature=n.bytes===String?N.base64.encode(t.signature,0,t.signature.length):n.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Tt.default.util.toJSONOptions)},r})();var ut=x(st(),1),Mn=ut.default.Reader,rf=ut.default.Writer,$=ut.default.util,Ie=ut.default.roots.default||(ut.default.roots.default={}),nf=Ie.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.peerId=$.newBuffer([]),r.prototype.seq=$.Long?$.Long.fromBits(0,0,!0):0,r.prototype.addresses=$.emptyArray,r.encode=function(t,n){if(n||(n=rf.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&n.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&n.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var o=0;o<t.addresses.length;++o)Ie.PeerRecord.AddressInfo.encode(t.addresses[o],n.uint32(26).fork()).ldelim();return n},r.decode=function(t,n){t instanceof Mn||(t=Mn.create(t));for(var o=n===void 0?t.len:t.pos+n,i=new Ie.PeerRecord;t.pos<o;){var s=t.uint32();switch(s>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:i.addresses&&i.addresses.length||(i.addresses=[]),i.addresses.push(Ie.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(s&7);break}}return i},r.fromObject=function(t){if(t instanceof Ie.PeerRecord)return t;var n=new Ie.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?$.base64.decode(t.peerId,n.peerId=$.newBuffer($.base64.length(t.peerId)),0):t.peerId.length&&(n.peerId=t.peerId)),t.seq!=null&&($.Long?(n.seq=$.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?n.seq=parseInt(t.seq,10):typeof t.seq=="number"?n.seq=t.seq:typeof t.seq=="object"&&(n.seq=new $.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var o=0;o<t.addresses.length;++o){if(typeof t.addresses[o]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[o]=Ie.PeerRecord.AddressInfo.fromObject(t.addresses[o])}}return n},r.toObject=function(t,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.addresses=[]),n.defaults)if(n.bytes===String?o.peerId="":(o.peerId=[],n.bytes!==Array&&(o.peerId=$.newBuffer(o.peerId))),$.Long){var i=new $.Long(0,0,!0);o.seq=n.longs===String?i.toString():n.longs===Number?i.toNumber():i}else o.seq=n.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(o.peerId=n.bytes===String?$.base64.encode(t.peerId,0,t.peerId.length):n.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?o.seq=n.longs===String?String(t.seq):t.seq:o.seq=n.longs===String?$.Long.prototype.toString.call(t.seq):n.longs===Number?new $.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){o.addresses=[];for(var s=0;s<t.addresses.length;++s)o.addresses[s]=Ie.PeerRecord.AddressInfo.toObject(t.addresses[s],n)}return o},r.prototype.toJSON=function(){return this.constructor.toObject(this,ut.default.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var n=Object.keys(t),o=0;o<n.length;++o)t[n[o]]!=null&&(this[n[o]]=t[n[o]])}return e.prototype.multiaddr=$.newBuffer([]),e.encode=function(n,o){return o||(o=rf.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&o.uint32(10).bytes(n.multiaddr),o},e.decode=function(n,o){n instanceof Mn||(n=Mn.create(n));for(var i=o===void 0?n.len:n.pos+o,s=new Ie.PeerRecord.AddressInfo;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Ie.PeerRecord.AddressInfo)return n;var o=new Ie.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?$.base64.decode(n.multiaddr,o.multiaddr=$.newBuffer($.base64.length(n.multiaddr)),0):n.multiaddr.length&&(o.multiaddr=n.multiaddr)),o},e.toObject=function(n,o){o||(o={});var i={};return o.defaults&&(o.bytes===String?i.multiaddr="":(i.multiaddr=[],o.bytes!==Array&&(i.multiaddr=$.newBuffer(i.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=o.bytes===String?$.base64.encode(n.multiaddr,0,n.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,ut.default.util.toJSONOptions)},e}(),r})();var of="[a-fA-F\\d:]",ct=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${of})|(?<=${of})(?=\\s|$))`:"",ke="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",K="[a-fA-F\\d]{1,4}",$n=`
(?:
(?:${K}:){7}(?:${K}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${K}:){6}(?:${ke}|:${K}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${K}:){5}(?::${ke}|(?::${K}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${K}:){4}(?:(?::${K}){0,1}:${ke}|(?::${K}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${K}:){3}(?:(?::${K}){0,2}:${ke}|(?::${K}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${K}:){2}(?:(?::${K}){0,3}:${ke}|(?::${K}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${K}:){1}(?:(?::${K}){0,4}:${ke}|(?::${K}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${K}){0,5}:${ke}|(?::${K}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Ey=new RegExp(`(?:^${ke}$)|(?:^${$n}$)`),vy=new RegExp(`^${ke}$`),xy=new RegExp(`^${$n}$`),Si=r=>r&&r.exact?Ey:new RegExp(`(?:${ct(r)}${ke}${ct(r)})|(?:${ct(r)}${$n}${ct(r)})`,"g");Si.v4=r=>r&&r.exact?vy:new RegExp(`${ct(r)}${ke}${ct(r)}`,"g");Si.v6=r=>r&&r.exact?xy:new RegExp(`${ct(r)}${$n}${ct(r)}`,"g");var Un=Si;function Ti(r){let e=(...t)=>r(...t);return Object.defineProperty(e,"name",{value:`functionTimeout(${r.name||"<anonymous>"})`,configurable:!0}),e}function sf(){return!1}var{toString:_y}=Object.prototype;function Oi(r){return _y.call(r)==="[object RegExp]"}var af={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Ii(r,e={}){if(!Oi(r))throw new TypeError("Expected a RegExp instance");let t=Object.keys(af).map(o=>(typeof e[o]=="boolean"?e[o]:r[o])?af[o]:"").join(""),n=new RegExp(e.source||r.source,t);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:r.lastIndex,n}function jn(r,e,{timeout:t}={}){try{return Ti(()=>Ii(r).test(e),{timeout:t})()}catch(n){if(sf(n))return!1;throw n}}var Cy=15,uf=45,ki={timeout:400};function zn(r){return jn(Un({exact:!0}),r.slice(0,uf),ki)}function cf(r){return jn(Un.v6({exact:!0}),r.slice(0,uf),ki)}function ff(r){return jn(Un.v4({exact:!0}),r.slice(0,Cy),ki)}var lf=ff,Ay=cf,Pi=function(r){let e=0;if(r=r.toString().trim(),lf(r)){let t=new Uint8Array(e+4);return r.split(/\./g).forEach(n=>{t[e++]=parseInt(n,10)&255}),t}if(Ay(r)){let t=r.split(":",8),n;for(n=0;n<t.length;n++){let i=lf(t[n]),s;i&&(s=Pi(t[n]),t[n]=I(s.slice(0,2),"base16")),s!=null&&++n<8&&t.splice(n,0,I(s.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&t[n]!=="";n++);let i=[n,1];for(n=9-t.length;n>0;n--)i.push("0");t.splice.apply(t,i)}let o=new Uint8Array(e+16);for(n=0;n<t.length;n++){let i=parseInt(t[n],16);o[e++]=i>>8&255,o[e++]=i&255}return o}throw new Error("invalid ip address")},df=function(r,e=0,t){e=~~e,t=t??r.length-e;let n=new DataView(r.buffer);if(t===4){let o=[];for(let i=0;i<t;i++)o.push(r[e+i]);return o.join(".")}if(t===16){let o=[];for(let i=0;i<t;i+=2)o.push(n.getUint16(e+i).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Br={},Ri={},Ty=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Ty.forEach(r=>{let e=Oy(...r);Ri[e.code]=e,Br[e.name]=e});function Oy(r,e,t,n,o){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(o)}}function V(r){if(typeof r=="number"){if(Ri[r]!=null)return Ri[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Br[r]!=null)return Br[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var je=x(Or(),1);function yf(r,e){switch(V(r).code){case 4:case 41:return ky(e);case 6:case 273:case 33:case 132:return gf(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return Ry(e);case 421:return Ly(e);case 444:return pf(e);case 445:return pf(e);case 466:return Fy(e);default:return I(e,"base16")}}function mf(r,e){switch(V(r).code){case 4:return hf(e);case 41:return hf(e);case 6:case 273:case 33:case 132:return Bi(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return Py(e);case 421:return Ny(e);case 444:return My(e);case 445:return $y(e);case 466:return By(e);default:return W(e,"base16")}}var Ni=Object.values(mr).map(r=>r.decoder),Iy=function(){let r=Ni[0].or(Ni[1]);return Ni.slice(2).forEach(e=>r=r.or(e)),r}();function hf(r){if(!zn(r))throw new Error("invalid ip address");return Pi(r)}function ky(r){let e=df(r,0,r.length);if(e==null)throw new Error("ipBuff is required");if(!zn(e))throw new Error("invalid ip address");return e}function Bi(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function gf(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Py(r){let e=W(r),t=Uint8Array.from(je.default.encode(e.length));return de([t,e],t.length+e.length)}function Ry(r){let e=je.default.decode(r);if(r=r.slice(je.default.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return I(r)}function Ny(r){let e;r[0]==="Q"||r[0]==="1"?e=Fe(re.decode(`z${r}`)).bytes:e=v.parse(r).multihash.bytes;let t=Uint8Array.from(je.default.encode(e.length));return de([t,e],t.length+e.length)}function By(r){let e=Iy.decode(r),t=Uint8Array.from(je.default.encode(e.length));return de([t,e],t.length+e.length)}function Fy(r){let e=je.default.decode(r),t=r.slice(je.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+I(t,"base64url")}function Ly(r){let e=je.default.decode(r),t=r.slice(je.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return I(t,"base58btc")}function My(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let t=P.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Bi(n);return de([t,o],t.length+o.length)}function $y(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let t=P.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Bi(n);return de([t,o],t.length+o.length)}function pf(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),n=I(e,"base32"),o=gf(t);return`${n}:${o}`}var rr=x(Or(),1);function Uy(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let n=0;n<t.length;n++){let o=t[n],i=V(o);if(i.size===0){e.push([o]);continue}if(n++,n>=t.length)throw bf("invalid address: "+r);if(i.path===!0){e.push([o,Ui(t.slice(n).join("/"))]);break}e.push([o,t[n]])}return e}function jy(r){let e=[];return r.map(t=>{let n=Kn(t);return e.push(n.name),t.length>1&&t[1]!=null&&e.push(t[1]),null}),Ui(e.join("/"))}function zy(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Kn(e);return e.length>1?[t.code,mf(t.code,e[1])]:[t.code]})}function Fi(r){return r.map(e=>{let t=Kn(e);return e[1]!=null?[t.code,yf(t.code,e[1])]:[t.code]})}function Li(r){return qn(de(r.map(e=>{let t=Kn(e),n=Uint8Array.from(rr.default.encode(t.code));return e.length>1&&e[1]!=null&&(n=de([n,e[1]])),n})))}function Mi(r,e){return r.size>0?r.size/8:r.size===0?0:rr.default.decode(e)+rr.default.decode.bytes}function Fr(r){let e=[],t=0;for(;t<r.length;){let n=rr.default.decode(r,t),o=rr.default.decode.bytes,i=V(n),s=Mi(i,r.slice(t+o));if(s===0){e.push([n]),t+=o;continue}let a=r.slice(t+o,t+o+s);if(t+=s+o,t>r.length)throw bf("Invalid address Uint8Array: "+I(r,"base16"));e.push([n,a])}return e}function $i(r){let e=Fr(r),t=Fi(e);return jy(t)}function qy(r){r=Ui(r);let e=Uy(r),t=zy(e);return Li(t)}function wf(r){return qy(r)}function qn(r){let e=Ky(r);if(e!=null)throw e;return Uint8Array.from(r)}function Ky(r){try{Fr(r)}catch(e){return e}}function Ui(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function bf(r){return new Error("Error parsing address: "+r)}function Kn(r){return V(r[0])}var ji=x(Or(),1);var xf=x(qe(),1);function Df(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var Ef,Wy=Symbol.for("nodejs.util.inspect.custom"),vf=[V("dns").code,V("dns4").code,V("dns6").code,V("dnsaddr").code],Qy=[V("p2p").code,V("ipfs").code],Hy=new Map,_f=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Gy(r){return Boolean(r?.[_f])}var Ye=class{constructor(e){if(this[Ef]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=qn(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=wf(e)}else if(Gy(e))this.bytes=qn(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return $i(this.bytes)}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),t=this.toString().split("/").slice(1),n,o;if(t.length>2)vf.includes(e[0])&&Qy.includes(e[1])?(n=V("tcp").name,o=443):(n=V(t[2]).name,o=parseInt(t[3]));else if(vf.includes(e[0]))n=V("tcp").name,o=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:t[1],transport:n,port:o}}protos(){return this.protoCodes().map(e=>Object.assign({},V(e)))}protoCodes(){let e=[],t=this.bytes,n=0;for(;n<t.length;){let o=ji.default.decode(t,n),i=ji.default.decode.bytes,s=V(o);n+=Mi(s,t.slice(n+i))+i,e.push(o)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Fr(this.bytes)}stringTuples(){let e=Fr(this.bytes);return Fi(e)}encapsulate(e){return e=new Ye(e),new Ye(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),n=this.toString(),o=n.lastIndexOf(t);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ye(n.slice(0,o))}decapsulateCode(e){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new Ye(Li(t.slice(0,n)));return this}getPeerId(){try{let t=this.stringTuples().filter(n=>n[0]===Br.ipfs.code).pop();if(t?.[1]!=null){let n=t[1];return n[0]==="Q"||n[0]==="1"?I(re.decode(`z${n}`),"base58btc"):I(v.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>V(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Df(this.bytes,e.bytes)}async resolve(e){let t=this.protos().find(i=>i.resolvable);if(t==null)return[this];let n=Hy.get(t.name);if(n==null)throw(0,xf.default)(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(i=>new Ye(i))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[(Ef=_f,Wy)](){return this.inspect()}inspect(){return"<Multiaddr "+I(this.bytes,"base16")+" - "+$i(this.bytes)+">"}};function zi(r){return new Ye(r)}qi.default.util.Long=void 0;qi.default.configure();async function Jy(r,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await r.datastore.open();let t={},n=[];for await(let{key:o,value:i}of r.datastore.query({prefix:"/peers"})){n.push(o);let s=o.toString(),[a,u,f,c,l]=s.split("/");if(u==="peers"&&!!["protos","addrs","metadata","keys"].includes(f)&&!!c)if(t[c]=t[c]||{addresses:[],protocols:[],metadata:[]},f==="protos"){let h=vi.decode(i);t[c].protocols=h.protocols.sort()}else if(f==="addrs"){let h=_i.decode(i);t[c].addresses=h.addrs.sort((g,p)=>zi(g.multiaddr).toString().localeCompare(zi(p.multiaddr).toString())),h.certifiedRecord&&h.certifiedRecord.raw&&(t[c].peerRecordEnvelope=h.certifiedRecord.raw)}else f==="metadata"?t[c].metadata.push({key:l,value:i}):f==="keys"&&(t[c].pubKey=i)}e(33,"Read peer data from store");for(let o of n)await r.datastore.delete(o);e(66,"Removed existing peer data from store");for(let o of Object.keys(t)){let i=t[o];i.metadata=i.metadata.sort((a,u)=>a.key.localeCompare(u.key));let s=Ai.encode(i).finish();await r.datastore.put(new _(`/peers/${o}`),s)}await r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function Yy(r,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await r.datastore.open();let t={},n=[];for await(let{key:o,value:i}of r.datastore.query({prefix:"/peers"})){n.push(o);let s=o.toString(),[a,u,f]=s.split("/");t[f]=Ai.decode(i)}e(33,"Read peer data from store");for(let o of n)await r.datastore.delete(o);e(66,"Removed existing peer data from store");for(let[o,i]of Object.entries(t)){if(i.protocols&&i.protocols.length>0&&await r.datastore.put(new _(`/peers/protos/${o}`),vi.encode({protocols:i.protocols}).finish()),i.addresses&&i.addresses.length>0){let s=i.peerRecordEnvelope,a;if(s){let u=tf.decode(s),f=nf.decode(u.payload);a={raw:s,seq:f.seq}}await r.datastore.put(new _(`/peers/addrs/${o}`),_i.encode({addrs:i.addresses,certifiedRecord:a}).finish())}if(i.metadata&&i.metadata.length>0)for(let{key:s,value:a}of i.metadata)await r.datastore.put(new _(`/peers/metadata/${o}/${s}`),a);i.pubKey&&await r.datastore.put(new _(`/peers/keys/${o}`),i.pubKey)}await r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var Cf={version:12,description:"Store each peerstore peer under a single datastore key",migrate:Jy,revert:Yy};var Ot={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},Vn=[Object.assign({version:1},Ot),Object.assign({version:2},Ot),Object.assign({version:3},Ot),Object.assign({version:4},Ot),Object.assign({version:5},Ot),Object.assign({version:6},Ot),Object.assign({version:7},Ot),ga,Vc,Jc,Zc,Cf];var Af=x(Be(),1);var Ki={};te(Ki,{InvalidValueError:()=>ir,MissingRepoOptionsError:()=>ze,NonReversibleMigrationError:()=>nr,NotInitializedRepoError:()=>ft,RequiredParameterError:()=>or});var nr=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=nr.code,this.message=e}};nr.code="ERR_NON_REVERSIBLE_MIGRATION";var ft=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=ft.code,this.message=e}};ft.code="ERR_NOT_INITIALIZED_REPO";var or=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=or.code,this.message=e}};or.code="ERR_REQUIRED_PARAMETER";var ir=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=ir.code,this.message=e}};ir.code="ERR_INVALID_VALUE";var ze=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=ze.code,this.message=e}};ze.code="ERR_MISSING_REPO_OPTIONS";var Vi=(0,Af.default)("ipfs:repo:migrator:repo:init");async function Sf(r){if(!r)throw new ze("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(Rr),n=await e.has(Qc);return!t||!n?(Vi(`Version entry present: ${t}`),Vi(`Config entry present: ${n}`),!1):!0}catch(t){return Vi("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}async function Wi(r){if(!await Sf(r))throw new ft("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt(I(await e.get(Rr)))}finally{await e.close()}}async function Lr(r,e){if(!e)throw new ze("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(Rr,W(String(r))),await t.close()}var Tf=x(Be(),1),Pe=(0,Tf.default)("ipfs:repo:migrator");function Xy(r){return r=r||Vn,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function Of(r,e,t,n,o={}){let i=o.ignoreLock??!1,s=o.onProgress,a=o.isDryRun??!1,u=o.migrations??Vn;if(!r)throw new _e.RequiredParameterError("Path argument is required!");if(!t)throw new _e.RequiredParameterError("repoOptions argument is required!");if(!n)throw new _e.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new _e.InvalidValueError("Version has to be positive integer!");e=Ei(e);let f=await Wi(e);if(f===n){Pe("Nothing to migrate.");return}if(f>n)throw new _e.InvalidValueError(`Current repo's version (${f}) is higher then toVersion (${n}), you probably wanted to revert it?`);kf(u,f,n);let c;!a&&!i&&(c=await t.repoLock.lock(r));try{for(let l of u){if(n!==void 0&&l.version>n)break;if(!(l.version<=f)){Pe(`Migrating version ${l.version}`);try{if(!a){let h=()=>{};s&&(h=(g,p)=>s(l.version,g.toFixed(2),p)),await l.migrate(e,h)}}catch(h){let g=l.version-1;throw Pe(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${g}`),await Lr(g,e),new Error(`During migration to version ${l.version} exception was raised: ${h.stack||h.message||h}`)}Pe(`Migrating to version ${l.version} finished`)}}a||await Lr(n||Xy(u),e),Pe("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!a&&!i&&c&&await c.close()}}async function If(r,e,t,n,o={}){let i=o.ignoreLock??!1,s=o.onProgress,a=o.isDryRun??!1,u=o.migrations??Vn;if(!r)throw new _e.RequiredParameterError("Path argument is required!");if(!t)throw new _e.RequiredParameterError("repoOptions argument is required!");if(!n)throw new _e.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new _e.InvalidValueError("Version has to be positive integer!");e=Ei(e);let f=await Wi(e);if(f===n){Pe("Nothing to revert.");return}if(f<n)throw new _e.InvalidValueError(`Current repo's version (${f}) is lower then toVersion (${n}), you probably wanted to migrate it?`);kf(u,n,f,!0);let c;!a&&!i&&(c=await t.repoLock.lock(r)),Pe(`Reverting from version ${f} to ${n}`);try{let l=u.slice().reverse();for(let h of l){if(h.version<=n)break;if(!(h.version>f)){Pe(`Reverting migration version ${h.version}`);try{if(!a){let g=()=>{};s&&(g=(p,w)=>s(h.version,p.toFixed(2),w)),await h.revert(e,g)}}catch(g){let p=h.version;throw Pe(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await Lr(p,e),g.message=`During reversion to version ${h.version} exception was raised: ${g.message}`,g}Pe(`Reverting to version ${h.version} finished`)}}a||await Lr(n,e),Pe(`All migrations successfully reverted to version ${n}!`)}finally{!a&&!i&&c&&await c.close()}}function kf(r,e,t,n=!1){let o=0;for(let i of r){if(i.version>t)break;if(i.version>e){if(n&&!i.revert)throw new _e.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${i.version} is not reversible. Cancelling reversion.`);o++}}if(o!==t-e)throw new _e.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}var _e=Ki;var md=x(Nf(),1);var qf=x(zf(),1),Kf=qf.default;var Hf=x(Be(),1);var It=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=It.code}};It.code="ERR_LOCK_EXISTS";var he=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=he.code}};he.code="ERR_NOT_FOUND";var kt=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=kt.code}};kt.code="ERR_INVALID_REPO_VERSION";var Mr="ERR_REPO_NOT_INITIALIZED",Vf="ERR_REPO_ALREADY_OPEN",Wf="ERR_REPO_ALREADY_CLOSED";async function Gn(r,e,t){let n=await e(r);if(n)return n;let o=Qf(t);return o?new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}}):!1}async function Jn(r,e,t,n){if(await t(r))return e(r);let o=Qf(n);if(!o)throw new he;return new Promise((i,s)=>{let a=o.store("readonly").get(r.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);s(new he)}})}function Qf(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var dm=(0,Hf.default)("ipfs:repo:version"),Hi=new _("version");function Gf(r){return{async exists(){return Gn(Hi,r.has.bind(r),r)},async get(){let e=await Jn(Hi,r.get.bind(r),r.has.bind(r),r);return parseInt(I(e),10)},set(e){return r.put(Hi,W(String(e)))},async check(e){let t=await this.get();return dm("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}var il=x(Ji(),1);var Ur=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},Yi=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Yf=r=>globalThis.DOMException===void 0?new Yi(r):new DOMException(r),Zf=r=>{let e=r.reason===void 0?Yf("This operation was aborted."):r.reason;return e instanceof Error?e:Yf(e)};function Zi(r,e,t,n){let o,i=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:u}=n;u.aborted&&a(Zf(u)),u.addEventListener("abort",()=>{a(Zf(u))})}o=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(c){a(c)}return}let u=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new Ur(u);typeof r.cancel=="function"&&r.cancel(),a(f)},e),(async()=>{try{s(await r)}catch(u){a(u)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()});return i.clear=()=>{clearTimeout(o),o=void 0},i}function Xi(r,e,t){let n=0,o=r.length;for(;o>0;){let i=Math.trunc(o/2),s=n+i;t(r[s],e)<=0?(n=++s,o-=i+1):o=i}return n}var Pt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ze,jr=class{constructor(){Ze.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&Pt(this,Ze,"f")[this.size-1].priority>=t.priority){Pt(this,Ze,"f").push(n);return}let o=Xi(Pt(this,Ze,"f"),n,(i,s)=>s.priority-i.priority);Pt(this,Ze,"f").splice(o,0,n)}dequeue(){let e=Pt(this,Ze,"f").shift();return e?.run}filter(e){return Pt(this,Ze,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Pt(this,Ze,"f").length}};Ze=new WeakMap;var F=function(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t},b=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},j,qr,Kr,ht,no,Vr,Zn,Re,zr,pe,Xn,ye,Wr,dt,eo,Xf,el,ol,tl,rl,nl,to,es,ts,oo,ro,ym=new Ur,rs=class extends Error{},Rt=class extends il.default{constructor(e){var t,n,o,i;if(super(),j.add(this),qr.set(this,void 0),Kr.set(this,void 0),ht.set(this,0),no.set(this,void 0),Vr.set(this,void 0),Zn.set(this,0),Re.set(this,void 0),zr.set(this,void 0),pe.set(this,void 0),Xn.set(this,void 0),ye.set(this,0),Wr.set(this,void 0),dt.set(this,void 0),eo.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:jr,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);F(this,qr,e.carryoverConcurrencyCount,"f"),F(this,Kr,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),F(this,no,e.intervalCap,"f"),F(this,Vr,e.interval,"f"),F(this,pe,new e.queueClass,"f"),F(this,Xn,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,F(this,eo,e.throwOnTimeout===!0,"f"),F(this,dt,e.autoStart===!1,"f")}get concurrency(){return b(this,Wr,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);F(this,Wr,e,"f"),b(this,j,"m",oo).call(this)}async add(e,t={}){return new Promise((n,o)=>{let i=async()=>{var s,a,u;F(this,ye,(a=b(this,ye,"f"),a++,a),"f"),F(this,ht,(u=b(this,ht,"f"),u++,u),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){o(new rs("The task was aborted."));return}let c=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):Zi(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?b(this,eo,"f"):t.throwOnTimeout)&&o(ym)}));n(c),this.emit("completed",c)}catch(f){o(f),this.emit("error",f)}b(this,j,"m",ol).call(this)};b(this,pe,"f").enqueue(i,t),b(this,j,"m",to).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return b(this,dt,"f")?(F(this,dt,!1,"f"),b(this,j,"m",oo).call(this),this):this}pause(){F(this,dt,!0,"f")}clear(){F(this,pe,new(b(this,Xn,"f")),"f")}async onEmpty(){b(this,pe,"f").size!==0&&await b(this,j,"m",ro).call(this,"empty")}async onSizeLessThan(e){b(this,pe,"f").size<e||await b(this,j,"m",ro).call(this,"next",()=>b(this,pe,"f").size<e)}async onIdle(){b(this,ye,"f")===0&&b(this,pe,"f").size===0||await b(this,j,"m",ro).call(this,"idle")}get size(){return b(this,pe,"f").size}sizeBy(e){return b(this,pe,"f").filter(e).length}get pending(){return b(this,ye,"f")}get isPaused(){return b(this,dt,"f")}};qr=new WeakMap,Kr=new WeakMap,ht=new WeakMap,no=new WeakMap,Vr=new WeakMap,Zn=new WeakMap,Re=new WeakMap,zr=new WeakMap,pe=new WeakMap,Xn=new WeakMap,ye=new WeakMap,Wr=new WeakMap,dt=new WeakMap,eo=new WeakMap,j=new WeakSet,Xf=function(){return b(this,Kr,"f")||b(this,ht,"f")<b(this,no,"f")},el=function(){return b(this,ye,"f")<b(this,Wr,"f")},ol=function(){var e;F(this,ye,(e=b(this,ye,"f"),e--,e),"f"),b(this,j,"m",to).call(this),this.emit("next")},tl=function(){this.emit("empty"),b(this,ye,"f")===0&&this.emit("idle")},rl=function(){b(this,j,"m",ts).call(this),b(this,j,"m",es).call(this),F(this,zr,void 0,"f")},nl=function(){let e=Date.now();if(b(this,Re,"f")===void 0){let t=b(this,Zn,"f")-e;if(t<0)F(this,ht,b(this,qr,"f")?b(this,ye,"f"):0,"f");else return b(this,zr,"f")===void 0&&F(this,zr,setTimeout(()=>{b(this,j,"m",rl).call(this)},t),"f"),!0}return!1},to=function(){if(b(this,pe,"f").size===0)return b(this,Re,"f")&&clearInterval(b(this,Re,"f")),F(this,Re,void 0,"f"),b(this,j,"m",tl).call(this),!1;if(!b(this,dt,"f")){let e=!b(this,j,"a",nl);if(b(this,j,"a",Xf)&&b(this,j,"a",el)){let t=b(this,pe,"f").dequeue();return t?(this.emit("active"),t(),e&&b(this,j,"m",es).call(this),!0):!1}}return!1},es=function(){b(this,Kr,"f")||b(this,Re,"f")!==void 0||(F(this,Re,setInterval(()=>{b(this,j,"m",ts).call(this)},b(this,Vr,"f")),"f"),F(this,Zn,Date.now()+b(this,Vr,"f"),"f"))},ts=function(){b(this,ht,"f")===0&&b(this,ye,"f")===0&&b(this,Re,"f")&&(clearInterval(b(this,Re,"f")),F(this,Re,void 0,"f")),F(this,ht,b(this,qr,"f")?b(this,ye,"f"):0,"f"),b(this,j,"m",oo).call(this)},oo=function(){for(;b(this,j,"m",to).call(this););},ro=async function(e,t){return new Promise(n=>{let o=()=>{t&&!t()||(this.off(e,o),n())};this.on(e,o)})};var al=mm;function mm(r,e,t){var n,o;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(o=n.pop(),!o)return!1;sl(o);for(var i;i=n.shift();)if(sl(i),typeof r[i]>"u"&&(r[i]={}),r=r[i],!r||typeof r!="object")return!1;return r[o]=t,!0}function sl(r){if(r=="__proto__"||r=="constructor"||r=="prototype")throw new Error("setting of prototype values not supported")}var io=x(qe(),1);var gm=Rt.default?Rt.default:Rt,ns=new _("config");function ul(r){let e=new gm({concurrency:1}),t={async getAll(i={}){let s=await Jn(ns,r.get.bind(r),r.has.bind(r),r);return JSON.parse(I(s))},async get(i,s={}){if(i==null)throw new he(`Key ${i} does not exist in config`);let a=await this.getAll(s),u=dr(a,i);if(u===void 0)throw new he(`Key ${i} does not exist in config`);return u},set(i,s,a={}){if(typeof i!="string"&&!(i instanceof String))throw(0,io.default)(new Error("Invalid key type: "+typeof i),"ERR_INVALID_KEY");if(s===void 0||s instanceof Uint8Array)throw(0,io.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:i,value:s},a.signal))},replace(i,s={}){if(!i||i instanceof Uint8Array)throw(0,io.default)(new Error("Invalid value type: "+typeof i),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:i},s.signal))},async exists(){return Gn(ns,r.has.bind(r),r)}};return t;async function n(i,s){if(s&&s.aborted)return;let a=i.key,u=i.value;if(a){let f=await t.getAll();return typeof f=="object"&&f!==null&&al(f,a,u),o(f)}return o(u)}function o(i){let s=W(JSON.stringify(i,null,2));return r.put(ns,s)}}function Qr(r){if(typeof r!="object"||r===null)return!1;let e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function os(r,e={}){if(!Qr(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t,compare:n}=e,o=[],i=[],s=u=>{let f=o.indexOf(u);if(f!==-1)return i[f];let c=[];return o.push(u),i.push(c),c.push(...u.map(l=>Array.isArray(l)?s(l):Qr(l)?a(l):l)),c},a=u=>{let f=o.indexOf(u);if(f!==-1)return i[f];let c={},l=Object.keys(u).sort(n);o.push(u),i.push(c);for(let h of l){let g=u[h],p;t&&Array.isArray(g)?p=s(g):p=t&&Qr(g)?a(g):g,Object.defineProperty(c,h,{...Object.getOwnPropertyDescriptor(u,h),value:p})}return c};return Array.isArray(r)?t?s(r):r.slice():a(r)}var is=new _("datastore_spec");function cl(r){return{exists(){return r.has(is)},async get(){let e=await r.get(is);return JSON.parse(I(e))},async set(e){return r.put(is,W(JSON.stringify(os(e,{deep:!0}))))}}}var ss=new _("api");function fl(r){return{async get(){let e=await r.get(ss);return e&&e.toString()},set(e){return r.put(ss,W(e.toString()))},delete(){return r.delete(ss)}}}var pl=x(as(),1);var so=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},ur=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new so(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new so(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function ao(r={}){return bm(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function bm(r,e){e=e??{};let t=e.onEnd,n=new ur,o,i,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((w,S)=>{i=B=>{i=null,n.push(B);try{w(r(n))}catch(J){S(J)}return o}}):r(n),u=w=>i!=null?i(w):(n.push(w),o),f=w=>(n=new ur,i!=null?i({error:w}):(n.push({error:w}),o)),c=w=>{if(s)return o;if(e?.objectMode!==!0&&w?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:w})},l=w=>s?o:(s=!0,w!=null?f(w):u({done:!0})),h=()=>(n=new ur,l(),{done:!0}),g=w=>(l(w),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:a,return:h,throw:g,push:c,end:l,get readableLength(){return n.size}},t==null)return o;let p=o;return o={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(w){return p.throw(w),t!=null&&(t(w),t=void 0),{done:!0}},return(){return p.return(),t!=null&&(t(),t=void 0),{done:!0}},push:c,end(w){return p.end(w),t!=null&&(t(w),t=void 0),o},get readableLength(){return p.readableLength}},o}var yl=x(hl(),1);var ml=x(qe(),1);function gl(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let n=pt(e);return n.isIdentity?Promise.resolve(n.digest):r.get(e,t)},async*getMany(e,t){for await(let n of e)yield this.get(n,t)},async put(e,t,n){let{isIdentity:o}=pt(e);o||await r.put(e,t,n)},async*putMany(e,t){let n=ao({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,yl.default)(r.putMany(async function*(){for await(let{key:i,value:s}of e)pt(i).isIdentity||(yield{key:i,value:s}),n.push({key:i,value:s})}())),n.end()}catch(i){n.end(i)}}),yield*n},has(e,t){let{isIdentity:n}=pt(e);return n?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:n}=pt(e);return n?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany((0,pl.default)(e,n=>!pt(n).isIdentity),t)},batch(){let e=r.batch();return{put(t,n){let{isIdentity:o}=pt(t);o||e.put(t,n)},delete(t){let{isIdentity:n}=pt(t);n||e.delete(t)},commit:t=>e.commit(t)}}}}function pt(r){let e=v.asCID(r);if(e==null)throw(0,ml.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==$o.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}var wl=x(Be(),1),bl=(0,wl.default)("ipfs:repo:lock:memory"),Dl="repo.lock",Hr={};async function Em(r){let e=r+"/"+Dl;if(bl("locking %s",e),Hr[e]===!0)throw new It(`Lock already being held for file: ${e}`);return Hr[e]=!0,{async close(){Hr[e]&&delete Hr[e]}}}async function vm(r){let e=r+"/"+Dl;return bl(`checking lock: ${e}`),Boolean(Hr[e])}var El={lock:Em,locked:vm};var vl={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:El};var us={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};var Sl=x(qe(),1),Tl=x(Be(),1),hs=x(_l(),1);var uo=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),cs=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,n]of Object.entries(r)){let o=[...e,t];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i],u=v.asCID(s);u?yield[a.join("/"),u]:typeof s=="object"&&(yield*cs(s,a))}else{let i=v.asCID(n);i?yield[o.join("/"),i]:yield*cs(n,o)}}},fs=function*(r,e){if(r!=null)for(let[t,n]of Object.entries(r)){let o=[...e,t];if(yield o.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!v.asCID(n))if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i];yield a.join("/"),typeof s=="object"&&!v.asCID(s)&&(yield*fs(s,a))}else yield*fs(n,o)}},_m=(r,e)=>{let t=r;for(let[n,o]of e.entries()){if(t=t[o],t==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let i=v.asCID(t);if(i)return{value:i,remaining:e.slice(n+1).join("/")}}return{value:t}},ls=class{constructor({cid:e,bytes:t,value:n}){if(!e||!t||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:uo(),bytes:uo(),value:uo(),asBlock:uo()})}links(){return cs(this.value,[])}tree(){return fs(this.value,[])}get(e="/"){return _m(this.value,e.split("/").filter(Boolean))}};var co=({bytes:r,cid:e,value:t,codec:n})=>{let o=t!==void 0?t:n&&n.decode(r);if(o===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ls({cid:e,bytes:r,value:o})};var Cl=x(qe(),1);function Gr(r){let e=v.asCID(r);if(e==null)throw(0,Cl.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=P.encode(e.multihash.bytes);return new _("/"+t.slice(1).toUpperCase(),!1)}function ds(r){return Fe(P.decode(`b${r.toString().toLowerCase().substring(1)}`))}var Al=x(Be(),1);var Cm=(0,Al.default)("ipfs:repo:utils:walk-dag");async function*cr(r,e,t,n){try{let o=await e.get(r,n),i=await t(r.code),s=co({bytes:o,cid:r,codec:i});for(let[,a]of s.links())yield a,yield*cr(a,e,t,n)}catch(o){throw Cm("Could not walk DAG for CID",r.toString(),o),o}}var oe={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};var Jr=class extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(let[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){let n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield e)}for(let e of this.cache){let[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield e)}}get(e){if(this.cache.has(e)){let t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){let t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){let o=typeof n=="number"&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:o}):this._set(e,{value:t,expiry:o})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");let t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache){let[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){let n=e[t],[o,i]=n;this._deleteIfExpired(o,i)===!1&&(yield[o,i.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){let n=e[t],[o,i]=n;this.cache.has(o)||this._deleteIfExpired(o,i)===!1&&(yield[o,i.value])}}*entriesAscending(){for(let[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(let[n,o]of this.entriesAscending())e.call(t,o,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}};var Am=2048;function Sm(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return(0,Sl.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var fo=class{constructor({pinstore:e,blockstore:t,loadCodec:n}){this.pinstore=e,this.blockstore=t,this.loadCodec=n,this.log=(0,Tl.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let n={depth:0};return e.version!==0&&(n.version=e.version),e.code!==Qe&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),this.pinstore.put(Gr(e),vt(n))}unpin(e,t){return this.pinstore.delete(Gr(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let n={depth:1/0};e.version!==0&&(n.version=e.version),e.code!==Qe&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),await this.pinstore.put(Gr(e),vt(n))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[n=>Me(n.value).depth===0]})){let n=Me(t.value),o=n.version||0,i=n.codec!=null?n.codec:Qe,s=ds(t.key);yield{cid:v.create(o,i,s),metadata:n.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[n=>Me(n.value).depth===1/0]})){let n=Me(t.value),o=n.version||0,i=n.codec!=null?n.codec:Qe,s=ds(t.key);yield{cid:v.create(o,i,s),metadata:n.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let n of cr(t,this.blockstore,this.loadCodec,e)){let o=[oe.recursive];(await this.isPinnedWithType(n,o)).pinned||(yield n)}}async isPinnedWithType(e,t,n){Array.isArray(t)||(t=[t]);let o=t.includes(oe.all),i=t.includes(oe.direct),s=t.includes(oe.recursive),a=t.includes(oe.indirect);if(s||i||o){let c=await(0,hs.default)(this.pinstore.query({prefix:Gr(e).toString(),filters:[l=>{if(o)return!0;let h=Me(l.value);return t.includes(h.depth===0?oe.direct:oe.recursive)}],limit:1}));if(c){let l=Me(c.value);return{cid:e,pinned:!0,reason:l.depth===0?oe.direct:oe.recursive,metadata:l.metadata}}}let u=this;async function*f(c,l){for await(let{cid:h}of l)for await(let g of cr(h,u.blockstore,u.loadCodec))if(g.equals(c)){yield h;return}}if(o||a){let c=await(0,hs.default)(f(e,this.recursiveKeys()));if(c)return{cid:e,pinned:!0,reason:oe.indirect,parent:c}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){let n=new Jr({maxSize:t.cidCacheMaxSize??Am}),o=async(i,s)=>{if(n.has(i.toString()))return;n.set(i.toString(),!0);let a=await this.blockstore.get(i,s),u=await this.loadCodec(i.code),f=co({bytes:a,cid:i,codec:u});await Promise.all([...f.links()].map(([,c])=>o(c,s)))};await o(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(oe).includes(e))throw Sm(e);return!0}};var kl=x(ps(),1),Pl=x(qe(),1);function Rl(r,e){return{open(){return e.open()},close(){return e.close()},query(t,n){return e.query(t,n)},queryKeys(t,n){return e.queryKeys(t,n)},async get(t,n){return e.get(t,n)},async*getMany(t,n){yield*e.getMany(t,n)},async put(t,n,o){await e.put(t,n,o)},async*putMany(t,n){yield*e.putMany(t,n)},has(t,n){return e.has(t,n)},async delete(t,n){return await Il(t,r),e.delete(t,n)},deleteMany(t,n){return e.deleteMany((0,kl.default)(t,async o=>(await Il(o,r),o)),n)},batch(){return e.batch()}}}async function Il(r,e){let{pinned:t,reason:n}=await e.isPinnedWithType(r,oe.all);if(t)throw(0,Pl.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var zl=x(Ji(),1);var Yr=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},ys=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Nl=r=>globalThis.DOMException===void 0?new ys(r):new DOMException(r),Bl=r=>{let e=r.reason===void 0?Nl("This operation was aborted."):r.reason;return e instanceof Error?e:Nl(e)};function ms(r,e,t,n){let o,i=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:u}=n;u.aborted&&a(Bl(u)),u.addEventListener("abort",()=>{a(Bl(u))})}o=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(c){a(c)}return}let u=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new Yr(u);typeof r.cancel=="function"&&r.cancel(),a(f)},e),(async()=>{try{s(await r)}catch(u){a(u)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()});return i.clear=()=>{clearTimeout(o),o=void 0},i}function gs(r,e,t){let n=0,o=r.length;for(;o>0;){let i=Math.trunc(o/2),s=n+i;t(r[s],e)<=0?(n=++s,o-=i+1):o=i}return n}var Nt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Xe,Zr=class{constructor(){Xe.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&Nt(this,Xe,"f")[this.size-1].priority>=t.priority){Nt(this,Xe,"f").push(n);return}let o=gs(Nt(this,Xe,"f"),n,(i,s)=>s.priority-i.priority);Nt(this,Xe,"f").splice(o,0,n)}dequeue(){let e=Nt(this,Xe,"f").shift();return e?.run}filter(e){return Nt(this,Xe,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Nt(this,Xe,"f").length}};Xe=new WeakMap;var L=function(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t},D=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},z,en,tn,mt,go,rn,lo,Ne,Xr,me,ho,ge,nn,yt,po,Fl,Ll,jl,Ml,$l,Ul,yo,ws,bs,wo,mo,Om=new Yr,Ds=class extends Error{},fr=class extends zl.default{constructor(e){var t,n,o,i;if(super(),z.add(this),en.set(this,void 0),tn.set(this,void 0),mt.set(this,0),go.set(this,void 0),rn.set(this,void 0),lo.set(this,0),Ne.set(this,void 0),Xr.set(this,void 0),me.set(this,void 0),ho.set(this,void 0),ge.set(this,0),nn.set(this,void 0),yt.set(this,void 0),po.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Zr,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);L(this,en,e.carryoverConcurrencyCount,"f"),L(this,tn,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),L(this,go,e.intervalCap,"f"),L(this,rn,e.interval,"f"),L(this,me,new e.queueClass,"f"),L(this,ho,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,L(this,po,e.throwOnTimeout===!0,"f"),L(this,yt,e.autoStart===!1,"f")}get concurrency(){return D(this,nn,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);L(this,nn,e,"f"),D(this,z,"m",wo).call(this)}async add(e,t={}){return new Promise((n,o)=>{let i=async()=>{var s,a,u;L(this,ge,(a=D(this,ge,"f"),a++,a),"f"),L(this,mt,(u=D(this,mt,"f"),u++,u),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){o(new Ds("The task was aborted."));return}let c=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):ms(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?D(this,po,"f"):t.throwOnTimeout)&&o(Om)}));n(c),this.emit("completed",c)}catch(f){o(f),this.emit("error",f)}D(this,z,"m",jl).call(this)};D(this,me,"f").enqueue(i,t),D(this,z,"m",yo).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return D(this,yt,"f")?(L(this,yt,!1,"f"),D(this,z,"m",wo).call(this),this):this}pause(){L(this,yt,!0,"f")}clear(){L(this,me,new(D(this,ho,"f")),"f")}async onEmpty(){D(this,me,"f").size!==0&&await D(this,z,"m",mo).call(this,"empty")}async onSizeLessThan(e){D(this,me,"f").size<e||await D(this,z,"m",mo).call(this,"next",()=>D(this,me,"f").size<e)}async onIdle(){D(this,ge,"f")===0&&D(this,me,"f").size===0||await D(this,z,"m",mo).call(this,"idle")}get size(){return D(this,me,"f").size}sizeBy(e){return D(this,me,"f").filter(e).length}get pending(){return D(this,ge,"f")}get isPaused(){return D(this,yt,"f")}};en=new WeakMap,tn=new WeakMap,mt=new WeakMap,go=new WeakMap,rn=new WeakMap,lo=new WeakMap,Ne=new WeakMap,Xr=new WeakMap,me=new WeakMap,ho=new WeakMap,ge=new WeakMap,nn=new WeakMap,yt=new WeakMap,po=new WeakMap,z=new WeakSet,Fl=function(){return D(this,tn,"f")||D(this,mt,"f")<D(this,go,"f")},Ll=function(){return D(this,ge,"f")<D(this,nn,"f")},jl=function(){var e;L(this,ge,(e=D(this,ge,"f"),e--,e),"f"),D(this,z,"m",yo).call(this),this.emit("next")},Ml=function(){this.emit("empty"),D(this,ge,"f")===0&&this.emit("idle")},$l=function(){D(this,z,"m",bs).call(this),D(this,z,"m",ws).call(this),L(this,Xr,void 0,"f")},Ul=function(){let e=Date.now();if(D(this,Ne,"f")===void 0){let t=D(this,lo,"f")-e;if(t<0)L(this,mt,D(this,en,"f")?D(this,ge,"f"):0,"f");else return D(this,Xr,"f")===void 0&&L(this,Xr,setTimeout(()=>{D(this,z,"m",$l).call(this)},t),"f"),!0}return!1},yo=function(){if(D(this,me,"f").size===0)return D(this,Ne,"f")&&clearInterval(D(this,Ne,"f")),L(this,Ne,void 0,"f"),D(this,z,"m",Ml).call(this),!1;if(!D(this,yt,"f")){let e=!D(this,z,"a",Ul);if(D(this,z,"a",Fl)&&D(this,z,"a",Ll)){let t=D(this,me,"f").dequeue();return t?(this.emit("active"),t(),e&&D(this,z,"m",ws).call(this),!0):!1}}return!1},ws=function(){D(this,tn,"f")||D(this,Ne,"f")!==void 0||(L(this,Ne,setInterval(()=>{D(this,z,"m",bs).call(this)},D(this,rn,"f")),"f"),L(this,lo,Date.now()+D(this,rn,"f"),"f"))},bs=function(){D(this,mt,"f")===0&&D(this,ge,"f")===0&&D(this,Ne,"f")&&(clearInterval(D(this,Ne,"f")),L(this,Ne,void 0,"f")),L(this,mt,D(this,en,"f")?D(this,ge,"f"):0,"f"),D(this,z,"m",wo).call(this)},wo=function(){for(;D(this,z,"m",yo).call(this););},mo=async function(e,t){return new Promise(n=>{let o=()=>{t&&!t()||(this.off(e,o),n())};this.on(e,o)})};var Es=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},vs=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ql=r=>globalThis.DOMException===void 0?new vs(r):new DOMException(r),Kl=r=>{let e=r.reason===void 0?ql("This operation was aborted."):r.reason;return e instanceof Error?e:ql(e)};function xs(r,e){let{milliseconds:t,fallback:n,message:o,customTimers:i={setTimeout,clearTimeout}}=e,s,a=new Promise((u,f)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){u(r);return}if(e.signal){let{signal:c}=e;c.aborted&&f(Kl(c)),c.addEventListener("abort",()=>{f(Kl(c))})}s=i.setTimeout.call(void 0,()=>{if(n){try{u(n())}catch(h){f(h)}return}let c=typeof o=="string"?o:`Promise timed out after ${t} milliseconds`,l=o instanceof Error?o:new Es(c);typeof r.cancel=="function"&&r.cancel(),f(l)},t),(async()=>{try{u(await r)}catch(c){f(c)}finally{i.clearTimeout.call(void 0,s)}})()});return a.clear=()=>{i.clearTimeout.call(void 0,s),s=void 0},a}var Vl=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var _s="lock:worker:request-read",Cs="lock:worker:release-read",As="lock:master:grant-read",Ss="lock:worker:request-write",Ts="lock:worker:release-write",Os="lock:master:grant-write";var gt={},lr=r=>{r.addEventListener("message",e=>{lr.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{lr.dispatchEvent("message",r,e)})};lr.addEventListener=(r,e)=>{gt[r]==null&&(gt[r]=[]),gt[r].push(e)};lr.removeEventListener=(r,e)=>{gt[r]!=null&&(gt[r]=gt[r].filter(t=>t===e))};lr.dispatchEvent=function(r,e,t){gt[r]!=null&&gt[r].forEach(n=>n(e,t))};var Is=lr;var Wl=(r,e,t,n,o)=>(i,s)=>{if(s.data.type!==t)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(i.postMessage({type:o,name:a.name,identifier:a.identifier}),await new Promise(u=>{let f=c=>{if(c==null||c.data==null)return;let l={type:c.data.type,name:c.data.name,identifier:c.data.identifier};l.type===n&&l.identifier===a.identifier&&(i.removeEventListener("message",f),u())};i.addEventListener("message",f)}))}}))},Ql=(r,e,t,n)=>async()=>{let o=Vl();return globalThis.postMessage({type:e,identifier:o,name:r}),await new Promise(i=>{let s=a=>{if(a==null||a.data==null)return;let u={type:a.data.type,identifier:a.data.identifier};u.type===t&&u.identifier===o&&(globalThis.removeEventListener("message",s),i(()=>{globalThis.postMessage({type:n,identifier:o,name:r})}))};globalThis.addEventListener("message",s)})},Im={singleProcess:!1},Hl=r=>{if(r=Object.assign({},Im,r),Boolean(globalThis.document)||r.singleProcess){let t=new EventTarget;return Is.addEventListener("message",Wl(t,"requestReadLock",_s,Cs,As)),Is.addEventListener("message",Wl(t,"requestWriteLock",Ss,Ts,Os)),t}return{isWorker:!0,readLock:t=>Ql(t,_s,As,Cs),writeLock:t=>Ql(t,Ss,Os,Ts)}};var Bt={},wt;async function ks(r,e){let t,n=new Promise(o=>{t=o});return r.add(async()=>await xs((async()=>await new Promise(o=>{t(()=>{o()})}))(),{milliseconds:e.timeout})),await n}var km=(r,e)=>{if(wt.isWorker===!0)return{readLock:wt.readLock(r,e),writeLock:wt.writeLock(r,e)};let t=new fr({concurrency:1}),n;return{async readLock(){if(n!=null)return await ks(n,e);n=new fr({concurrency:e.concurrency,autoStart:!1});let o=n,i=ks(n,e);return t.add(async()=>(o.start(),await o.onIdle().then(()=>{n===o&&(n=null)}))),await i},async writeLock(){return n=null,await ks(t,e)}}},Pm={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Ps(r){let e=Object.assign({},Pm,r);return wt==null&&(wt=Hl(e),wt.isWorker!==!0&&(wt.addEventListener("requestReadLock",t=>{Bt[t.data.name]!=null&&Bt[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),wt.addEventListener("requestWriteLock",async t=>{Bt[t.data.name]!=null&&Bt[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),Bt[e.name]==null&&(Bt[e.name]=km(e.name,e)),Bt[e.name]}var fd=x(Be(),1);var ld=x(Zl(),1);var ad=x(Ns(),1),Mm=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},ud=r=>r!=null&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Bs=r=>r!=null&&typeof r.sink=="function"&&ud(r.source),$m=r=>e=>{let t=r.sink(e);if(t.then!=null){let n=ao({objectMode:!0});return t.then(()=>{n.end()},i=>{n.end(i)}),(0,ad.default)(n,async function*(){yield*r.source,n.end()}())}return r.source};function cd(r,...e){if(Bs(r)){let n=r;r=()=>n.source}else if(ud(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&Bs(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)Bs(t[n])&&(t[n]=$m(t[n]));return Mm(...t)}var Fs=x(Ns(),1),bo=x(ps(),1),dd=x(as(),1);var on=(0,fd.default)("ipfs:repo:gc"),Um=Pr().code,jm=256,zm=new _("/local/filesroot");function hd({gcLock:r,pins:e,blockstore:t,root:n,loadCodec:o}){async function*i(){let s=Date.now();on("Creating set of marked blocks");let a=await r.writeLock();try{let u=await qm({pins:e,blockstore:t,root:n,loadCodec:o}),f=t.queryKeys({});yield*Km({blockstore:t},u,f),on(`Complete (${Date.now()-s}ms)`)}finally{a()}}return i}async function qm({pins:r,blockstore:e,loadCodec:t,root:n}){let o=async function*(){let a;try{a=await n.get(zm)}catch(f){if(f.code===Um){on("No blocks in MFS");return}throw f}let u=v.decode(a);yield u,yield*cr(u,e,t)}(),i=(0,Fs.default)((0,bo.default)(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),(0,bo.default)(r.directKeys(),({cid:a})=>a),o),s=new Set;for await(let a of(0,Fs.default)(i,o))s.add(P.encode(a.multihash.bytes));return s}async function*Km({blockstore:r},e,t){let n=0,o=0;yield*cd((0,ld.default)((0,bo.default)(t,async s=>async function(){n++;try{let u=P.encode(s.multihash.bytes);if(e.has(u))return null;try{await r.delete(s),o++}catch(f){return{err:new Error(`Could not delete block with CID ${s}: ${f.message}`)}}return{cid:s}}catch(u){let f=`Could delete block with CID ${s}`;return on(f,u),{err:new Error(f+`: ${u.message}`)}}}),jm),s=>(0,dd.default)(s,Boolean)),on(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${o} blocks.`)}var ie=(0,yd.default)("ipfs:repo"),Vm=Number.MAX_SAFE_INTEGER,Wm="repoAutoMigrate",Ms=class{constructor(e,t,n,o){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Kf(vl,o),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;let i=n.blocks,s=n.pins;this.pins=new fo({pinstore:s,blockstore:i,loadCodec:t});let a=Rl(this.pins,i);this.blocks=gl(a),this.version=Gf(this.root),this.config=ul(this.root),this.spec=cl(this.root),this.apiAddr=fl(this.root),this.gcLock=Ps({name:e,singleProcess:this.options.repoOwner!==!1}),this.gc=hd({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){ie("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(Hm(e)),await this.spec.set(Gm(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Ft.default)(new Error("repo is already open"),Vf);ie("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),ie("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new kt("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");ie("creating datastore"),await this.datastore.open(),ie("creating blocks"),await this.blocks.open(),ie("creating keystore"),await this.keys.open(),ie("creating pins"),await this.pins.pinstore.open(),this.closed=!1,ie("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){ie("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Ft.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){ie("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Ft.default)(new Error("repo is not initialized yet"),Mr,{path:this.path}):t}if(!e)throw(0,Ft.default)(new Error("repo is not initialized yet"),Mr,{path:this.path})}async close(){if(this.closed)throw(0,Ft.default)(new Error("repo is already closed"),Wf);ie("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Mr&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),ie("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,n,o,i]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),pd(this.datastore),pd(this.keys)]),s=t.size+o+i;return{repoPath:this.path,storageMax:e,version:n,numObjects:t.count,repoSize:s}}throw(0,Ft.default)(new Error("repo is not initialized yet"),Mr,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(Wm)}catch(t){if(t.code===he.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(ie(`reverting to version ${e}`),If(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(ie(`migrating to version ${e}`),Of(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,md.default)(e))}catch{return BigInt(Vm)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:n,value:o}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(o.byteLength),t+=BigInt(n.bytes.byteLength);return{count:e,size:t}}};async function pd(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function Qm(r,e,t,n){return new Ms(r,e,t,n)}function Hm(r){return r.Datastore=Object.assign({},us,dr(r,"datastore")),r}function Gm(r){let e={...us.Spec,...dr(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}return vd(Jm);})();
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
return IpfsRepo}));
