"use strict";(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var ChainsafeLibp2PGossipsub=(()=>{var iy=Object.create;var Rs=Object.defineProperty;var sy=Object.getOwnPropertyDescriptor;var oy=Object.getOwnPropertyNames;var ay=Object.getPrototypeOf,uy=Object.prototype.hasOwnProperty;var hf=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var R=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Qe=(t,e)=>{for(var r in e)Rs(t,r,{get:e[r],enumerable:!0})},lf=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of oy(e))!uy.call(t,i)&&i!==r&&Rs(t,i,{get:()=>e[i],enumerable:!(n=sy(e,i))||n.enumerable});return t};var H=(t,e,r)=>(r=t!=null?iy(ay(t)):{},lf(e||!t||!t.__esModule?Rs(r,"default",{value:t,enumerable:!0}):r,t)),cy=t=>lf(Rs({},"__esModule",{value:!0}),t);var df=R((dS,pf)=>{pf.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var mf=R((yS,yf)=>{var gf=df();yf.exports=class{constructor(e){this.hwm=e||16,this.head=new gf(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new gf(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var bf=R((mS,vf)=>{var pa=mf();vf.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new pa,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let g,y=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;y.push(g.value)}return{done:g.done,value:y}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,g)=>{i=y=>(i=null,y.error?g(y.error):t.writev&&!y.done?p({done:y.done,value:[y.value]}):p(y),n)})},a=p=>i?i(p):(r.push(p),n),c=p=>(r=new pa,i?i({error:p}):(r.push({error:p}),n)),f=p=>s?n:a({done:!1,value:p}),u=p=>s?n:(s=!0,p?c(p):a({done:!0})),h=()=>(r=new pa,u(),{done:!0}),l=p=>(u(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:h,throw:l,push:f,end:u},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),e&&(e(p),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:f,end(p){return d.end(p),e&&(e(p),e=null),n}},n}});var xf=R((vS,wf)=>{"use strict";var hy=bf(),ly=async function*(...t){let e=hy();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};wf.exports=ly});var Re=R((xS,Cf)=>{"use strict";function Df(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function gy(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Df(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Df(new i,r)}}Cf.exports=gy});var Ls=R((uE,Hf)=>{"use strict";Hf.exports=Em;function Em(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(u){if(s)if(s=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(f){s&&(s=!1,c(f))}})}});var Ma=R(jf=>{"use strict";var Fs=jf;Fs.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Xn=new Array(64),$f=new Array(123);for(Ut=0;Ut<64;)$f[Xn[Ut]=Ut<26?Ut+65:Ut<52?Ut+71:Ut<62?Ut-4:Ut-59|43]=Ut++;var Ut;Fs.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var f=e[r++];switch(a){case 0:s[o++]=Xn[f>>2],c=(f&3)<<4,a=1;break;case 1:s[o++]=Xn[c|f>>4],c=(f&15)<<2,a=2;break;case 2:s[o++]=Xn[c|f>>6],s[o++]=Xn[f&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Xn[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Wf="invalid encoding";Fs.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=$f[c])===void 0)throw Error(Wf);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Wf);return n-i};Fs.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Na=R((fE,Jf)=>{"use strict";Jf.exports=Us;function Us(){this._listeners={}}Us.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Us.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Us.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var La=R((hE,th)=>{"use strict";th.exports=Zf(Zf);function Zf(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function s(c,f,u){e[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],e[0]}function a(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|f)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Yf),t.writeFloatBE=e.bind(null,Qf);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,f=o&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}t.readFloatLE=r.bind(null,Xf),t.readFloatBE=r.bind(null,eh)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function s(c,f,u){e[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],e[0]}function a(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var f=o<0?1:0;if(f&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((f<<31|2146435072)>>>0,a,c+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,n(u>>>0,a,c+i),n((f<<31|u/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),n(u*4503599627370496>>>0,a,c+i),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,Yf,0,4),t.writeDoubleBE=e.bind(null,Qf,4,0);function r(n,i,s,o,a){var c=n(o,a+i),f=n(o,a+s),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Xf,0,4),t.readDoubleBE=r.bind(null,eh,4,0)}(),t}function Yf(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Qf(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Xf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function eh(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var qs=R((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Ua=R(rh=>{"use strict";var Fa=rh;Fa.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Fa.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Fa.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var qa=R((pE,nh)=>{"use strict";nh.exports=Dm;function Dm(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var f=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),f}}});var sh=R((dE,ih)=>{"use strict";ih.exports=Ge;var qi=Qt();function Ge(t,e){this.lo=t>>>0,this.hi=e>>>0}var yn=Ge.zero=new Ge(0,0);yn.toNumber=function(){return 0};yn.zzEncode=yn.zzDecode=function(){return this};yn.length=function(){return 1};var Cm=Ge.zeroHash="\0\0\0\0\0\0\0\0";Ge.fromNumber=function(e){if(e===0)return yn;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Ge(n,i)};Ge.from=function(e){if(typeof e=="number")return Ge.fromNumber(e);if(qi.isString(e))if(qi.Long)e=qi.Long.fromString(e);else return Ge.fromNumber(parseInt(e,10));return e.low||e.high?new Ge(e.low>>>0,e.high>>>0):yn};Ge.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Ge.prototype.toLong=function(e){return qi.Long?new qi.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Gr=String.prototype.charCodeAt;Ge.fromHash=function(e){return e===Cm?yn:new Ge((Gr.call(e,0)|Gr.call(e,1)<<8|Gr.call(e,2)<<16|Gr.call(e,3)<<24)>>>0,(Gr.call(e,4)|Gr.call(e,5)<<8|Gr.call(e,6)<<16|Gr.call(e,7)<<24)>>>0)};Ge.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ge.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Ge.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Ge.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Qt=R(Ka=>{"use strict";var F=Ka;F.asPromise=Ls();F.base64=Ma();F.EventEmitter=Na();F.float=La();F.inquire=qs();F.utf8=Ua();F.pool=qa();F.LongBits=sh();F.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);F.global=F.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Ka;F.emptyArray=Object.freeze?Object.freeze([]):[];F.emptyObject=Object.freeze?Object.freeze({}):{};F.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};F.isString=function(e){return typeof e=="string"||e instanceof String};F.isObject=function(e){return e&&typeof e=="object"};F.isset=F.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};F.Buffer=function(){try{var t=F.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();F._Buffer_from=null;F._Buffer_allocUnsafe=null;F.newBuffer=function(e){return typeof e=="number"?F.Buffer?F._Buffer_allocUnsafe(e):new F.Array(e):F.Buffer?F._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};F.Array=typeof Uint8Array<"u"?Uint8Array:Array;F.Long=F.global.dcodeIO&&F.global.dcodeIO.Long||F.global.Long||F.inquire("long");F.key2Re=/^true|false|0|1$/;F.key32Re=/^-?(?:0|[1-9][0-9]*)$/;F.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;F.longToHash=function(e){return e?F.LongBits.from(e).toHash():F.LongBits.zeroHash};F.longFromHash=function(e,r){var n=F.LongBits.fromHash(e);return F.Long?F.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function oh(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}F.merge=oh;F.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ah(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&oh(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}F.newError=ah;F.ProtocolError=ah("ProtocolError");F.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};F.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};F.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};F._configure=function(){var t=F.Buffer;if(!t){F._Buffer_from=F._Buffer_allocUnsafe=null;return}F._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},F._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var zs=R((yE,hh)=>{"use strict";hh.exports=ne;var Ct=Qt(),za,Ks=Ct.LongBits,uh=Ct.base64,ch=Ct.utf8;function Ki(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Ga(){}function Im(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function ne(){this.len=0,this.head=new Ki(Ga,0,0),this.tail=this.head,this.states=null}var fh=function(){return Ct.Buffer?function(){return(ne.create=function(){return new za})()}:function(){return new ne}};ne.create=fh();ne.alloc=function(e){return new Ct.Array(e)};Ct.Array!==Array&&(ne.alloc=Ct.pool(ne.alloc,Ct.Array.prototype.subarray));ne.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Ki(e,r,n),this.len+=r,this};function Ha(t,e,r){e[r]=t&255}function _m(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Wa(t,e){this.len=t,this.next=void 0,this.val=e}Wa.prototype=Object.create(Ki.prototype);Wa.prototype.fn=_m;ne.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Wa((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ne.prototype.int32=function(e){return e<0?this._push($a,10,Ks.fromNumber(e)):this.uint32(e)};ne.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function $a(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}ne.prototype.uint64=function(e){var r=Ks.from(e);return this._push($a,r.length(),r)};ne.prototype.int64=ne.prototype.uint64;ne.prototype.sint64=function(e){var r=Ks.from(e).zzEncode();return this._push($a,r.length(),r)};ne.prototype.bool=function(e){return this._push(Ha,1,e?1:0)};function Va(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}ne.prototype.fixed32=function(e){return this._push(Va,4,e>>>0)};ne.prototype.sfixed32=ne.prototype.fixed32;ne.prototype.fixed64=function(e){var r=Ks.from(e);return this._push(Va,4,r.lo)._push(Va,4,r.hi)};ne.prototype.sfixed64=ne.prototype.fixed64;ne.prototype.float=function(e){return this._push(Ct.float.writeFloatLE,4,e)};ne.prototype.double=function(e){return this._push(Ct.float.writeDoubleLE,8,e)};var Am=Ct.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};ne.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ha,1,0);if(Ct.isString(e)){var n=ne.alloc(r=uh.length(e));uh.decode(e,n,0),e=n}return this.uint32(r)._push(Am,r,e)};ne.prototype.string=function(e){var r=ch.length(e);return r?this.uint32(r)._push(ch.write,r,e):this._push(Ha,1,0)};ne.prototype.fork=function(){return this.states=new Im(this),this.head=this.tail=new Ki(Ga,0,0),this.len=0,this};ne.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ki(Ga,0,0),this.len=0),this};ne.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};ne.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};ne._configure=function(t){za=t,ne.create=fh(),za._configure()}});var dh=R((mE,ph)=>{"use strict";ph.exports=Xt;var lh=zs();(Xt.prototype=Object.create(lh.prototype)).constructor=Xt;var Hr=Qt();function Xt(){lh.call(this)}Xt._configure=function(){Xt.alloc=Hr._Buffer_allocUnsafe,Xt.writeBytesBuffer=Hr.Buffer&&Hr.Buffer.prototype instanceof Uint8Array&&Hr.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Xt.prototype.bytes=function(e){Hr.isString(e)&&(e=Hr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Xt.writeBytesBuffer,r,e),this};function Tm(t,e,r){t.length<40?Hr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Xt.prototype.string=function(e){var r=Hr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Tm,r,e),this};Xt._configure()});var Gs=R((vE,bh)=>{"use strict";bh.exports=Oe;var er=Qt(),Ja,mh=er.LongBits,Bm=er.utf8;function qt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Oe(t){this.buf=t,this.pos=0,this.len=t.length}var gh=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Oe(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Oe(e);throw Error("illegal buffer")},vh=function(){return er.Buffer?function(r){return(Oe.create=function(i){return er.Buffer.isBuffer(i)?new Ja(i):gh(i)})(r)}:gh};Oe.create=vh();Oe.prototype._slice=er.Array.prototype.subarray||er.Array.prototype.slice;Oe.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,qt(this,10);return e}}();Oe.prototype.int32=function(){return this.uint32()|0};Oe.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ja(){var t=new mh(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw qt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw qt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Oe.prototype.bool=function(){return this.uint32()!==0};function Vs(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Oe.prototype.fixed32=function(){if(this.pos+4>this.len)throw qt(this,4);return Vs(this.buf,this.pos+=4)};Oe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw qt(this,4);return Vs(this.buf,this.pos+=4)|0};function yh(){if(this.pos+8>this.len)throw qt(this,8);return new mh(Vs(this.buf,this.pos+=4),Vs(this.buf,this.pos+=4))}Oe.prototype.float=function(){if(this.pos+4>this.len)throw qt(this,4);var e=er.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Oe.prototype.double=function(){if(this.pos+8>this.len)throw qt(this,4);var e=er.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Oe.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw qt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Oe.prototype.string=function(){var e=this.bytes();return Bm.read(e,0,e.length)};Oe.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw qt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw qt(this);while(this.buf[this.pos++]&128);return this};Oe.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Oe._configure=function(t){Ja=t,Oe.create=vh(),Ja._configure();var e=er.Long?"toLong":"toNumber";er.merge(Oe.prototype,{int64:function(){return ja.call(this)[e](!1)},uint64:function(){return ja.call(this)[e](!0)},sint64:function(){return ja.call(this).zzDecode()[e](!1)},fixed64:function(){return yh.call(this)[e](!0)},sfixed64:function(){return yh.call(this)[e](!1)}})}});var Eh=R((bE,Sh)=>{"use strict";Sh.exports=mn;var xh=Gs();(mn.prototype=Object.create(xh.prototype)).constructor=mn;var wh=Qt();function mn(t){xh.call(this,t)}mn._configure=function(){wh.Buffer&&(mn.prototype._slice=wh.Buffer.prototype.slice)};mn.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};mn._configure()});var Ch=R((wE,Dh)=>{"use strict";Dh.exports=zi;var Za=Qt();(zi.prototype=Object.create(Za.EventEmitter.prototype)).constructor=zi;function zi(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Za.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}zi.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Za.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,f){if(c)return o.emit("error",c,e),s(c);if(f===null){o.end(!0);return}if(!(f instanceof n))try{f=n[o.responseDelimited?"decodeDelimited":"decode"](f)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",f,e),s(null,f)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};zi.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ya=R(Ih=>{"use strict";var Rm=Ih;Rm.Service=Ch()});var Qa=R((SE,_h)=>{"use strict";_h.exports={}});var Bh=R(Th=>{"use strict";var ft=Th;ft.build="minimal";ft.Writer=zs();ft.BufferWriter=dh();ft.Reader=Gs();ft.BufferReader=Eh();ft.util=Qt();ft.rpc=Ya();ft.roots=Qa();ft.configure=Ah;function Ah(){ft.util._configure(),ft.Writer._configure(ft.BufferWriter),ft.Reader._configure(ft.BufferReader)}Ah()});var Ph=R((DE,Rh)=>{"use strict";Rh.exports=Xa;function Xa(t,e){typeof t=="string"&&(e=t,t=void 0);var r=[];function n(s){if(typeof s!="string"){var o=i();if(Xa.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),f=new Array(a.length),u=0;u<a.length;)c[u]=a[u],f[u]=s[a[u++]];return c[u]=o,Function.apply(null,c).apply(null,f)}return Function(o)()}for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l]=arguments[++l];if(l=0,s=s.replace(/%([%dfijs])/g,function(p,g){var y=h[l++];switch(g){case"d":case"f":return String(Number(y));case"i":return String(Math.floor(y));case"j":return JSON.stringify(y);case"s":return String(y)}return"%"}),l!==h.length)throw Error("parameter count mismatch");return r.push(s),n}function i(s){return"function "+(s||e||"")+"("+(t&&t.join(",")||"")+`){
  `+r.join(`
  `)+`
}`}return n.toString=i,n}Xa.verbose=!1});var Oh=R((CE,kh)=>{"use strict";kh.exports=Vi;var Pm=Ls(),km=qs(),eu=km("fs");function Vi(t,e,r){return typeof e=="function"?(r=e,e={}):e||(e={}),r?!e.xhr&&eu&&eu.readFile?eu.readFile(t,function(i,s){return i&&typeof XMLHttpRequest<"u"?Vi.xhr(t,e,r):i?r(i):r(null,e.binary?s:s.toString("utf8"))}):Vi.xhr(t,e,r):Pm(Vi,this,t,e)}Vi.xhr=function(e,r,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return n(Error("status "+i.status));if(r.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return n(null,i.responseText)}},r.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var Lh=R(Nh=>{"use strict";var ru=Nh,Mh=ru.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},tu=ru.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var r=e.split("/"),n=Mh(e),i="";n&&(i=r.shift()+"/");for(var s=0;s<r.length;)r[s]===".."?s>0&&r[s-1]!==".."?r.splice(--s,2):n?r.splice(s,1):++s:r[s]==="."?r.splice(s,1):++s;return i+r.join("/")};ru.resolve=function(e,r,n){return n||(r=tu(r)),Mh(r)?r:(n||(e=tu(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?tu(e+"/"+r):r)}});var vn=R(Fh=>{"use strict";var Gi=Fh,Om=He(),Mm=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Hi(t,e){var r=0,n={};for(e|=0;r<t.length;)n[Mm[r+e]]=t[r++];return n}Gi.basic=Hi([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Gi.defaults=Hi([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Om.emptyArray,null]);Gi.long=Hi([0,0,0,1,1],7);Gi.mapKey=Hi([0,0,0,5,5,0,0,0,1,1,0,2],2);Gi.packed=Hi([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Wr=R((AE,Kh)=>{"use strict";Kh.exports=It;var Hs=bn();((It.prototype=Object.create(Hs.prototype)).constructor=It).className="Field";var Uh=Kt(),qh=vn(),Ke=He(),nu,Nm=/^required|optional|repeated$/;It.fromJSON=function(e,r){return new It(e,r.id,r.type,r.rule,r.extend,r.options,r.comment)};function It(t,e,r,n,i,s,o){if(Ke.isObject(n)?(o=i,s=n,n=i=void 0):Ke.isObject(i)&&(o=s,s=i,i=void 0),Hs.call(this,t,s),!Ke.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Ke.isString(r))throw TypeError("type must be a string");if(n!==void 0&&!Nm.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!Ke.isString(i))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=r,this.id=e,this.extend=i||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Ke.Long?qh.long[r]!==void 0:!1,this.bytes=r==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(It.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});It.prototype.setOption=function(e,r,n){return e==="packed"&&(this._packed=null),Hs.prototype.setOption.call(this,e,r,n)};It.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return Ke.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};It.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=qh.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof nu?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Uh&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Uh))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Ke.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Ke.base64.test(this.typeDefault)?Ke.base64.decode(this.typeDefault,e=Ke.newBuffer(Ke.base64.length(this.typeDefault)),0):Ke.utf8.write(this.typeDefault,e=Ke.newBuffer(Ke.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Ke.emptyObject:this.repeated?this.defaultValue=Ke.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof nu&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Hs.prototype.resolve.call(this)};It.d=function(e,r,n,i){return typeof r=="function"?r=Ke.decorateType(r).name:r&&typeof r=="object"&&(r=Ke.decorateEnum(r).name),function(o,a){Ke.decorateType(o.constructor).add(new It(a,e,r,n,{default:i}))}};It._configure=function(e){nu=e}});var ri=R((TE,Hh)=>{"use strict";Hh.exports=oe;var iu=bn();((oe.prototype=Object.create(iu.prototype)).constructor=oe).className="Namespace";var zh=Wr(),Ws=He(),ei,Wi,ti;oe.fromJSON=function(e,r){return new oe(e,r.options).addJSON(r.nested)};function Vh(t,e){if(!!(t&&t.length)){for(var r={},n=0;n<t.length;++n)r[t[n].name]=t[n].toJSON(e);return r}}oe.arrayToJSON=Vh;oe.isReservedId=function(e,r){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=r&&e[n][1]>r)return!0}return!1};oe.isReservedName=function(e,r){if(e){for(var n=0;n<e.length;++n)if(e[n]===r)return!0}return!1};function oe(t,e){iu.call(this,t,e),this.nested=void 0,this._nestedArray=null}function Gh(t){return t._nestedArray=null,t}Object.defineProperty(oe.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Ws.toArray(this.nested))}});oe.prototype.toJSON=function(e){return Ws.toObject(["options",this.options,"nested",Vh(this.nestedArray,e)])};oe.prototype.addJSON=function(e){var r=this;if(e)for(var n=Object.keys(e),i=0,s;i<n.length;++i)s=e[n[i]],r.add((s.fields!==void 0?ei.fromJSON:s.values!==void 0?ti.fromJSON:s.methods!==void 0?Wi.fromJSON:s.id!==void 0?zh.fromJSON:oe.fromJSON)(n[i],s));return this};oe.prototype.get=function(e){return this.nested&&this.nested[e]||null};oe.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof ti)return this.nested[e].values;throw Error("no such enum: "+e)};oe.prototype.add=function(e){if(!(e instanceof zh&&e.extend!==void 0||e instanceof ei||e instanceof ti||e instanceof Wi||e instanceof oe))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var r=this.get(e.name);if(r)if(r instanceof oe&&e instanceof oe&&!(r instanceof ei||r instanceof Wi)){for(var n=r.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(r),this.nested||(this.nested={}),e.setOptions(r.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),Gh(this)};oe.prototype.remove=function(e){if(!(e instanceof iu))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Gh(this)};oe.prototype.define=function(e,r){if(Ws.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(n=n.nested[i],!(n instanceof oe))throw Error("path conflicts with non-namespace objects")}else n.add(n=new oe(i))}return r&&n.addJSON(r),n};oe.prototype.resolveAll=function(){for(var e=this.nestedArray,r=0;r<e.length;)e[r]instanceof oe?e[r++].resolveAll():e[r++].resolve();return this.resolve()};oe.prototype.lookup=function(e,r,n){if(typeof r=="boolean"?(n=r,r=void 0):r&&!Array.isArray(r)&&(r=[r]),Ws.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),r);var i=this.get(e[0]);if(i){if(e.length===1){if(!r||r.indexOf(i.constructor)>-1)return i}else if(i instanceof oe&&(i=i.lookup(e.slice(1),r,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof oe&&(i=this._nestedArray[s].lookup(e,r,!0)))return i;return this.parent===null||n?null:this.parent.lookup(e,r)};oe.prototype.lookupType=function(e){var r=this.lookup(e,[ei]);if(!r)throw Error("no such type: "+e);return r};oe.prototype.lookupEnum=function(e){var r=this.lookup(e,[ti]);if(!r)throw Error("no such Enum '"+e+"' in "+this);return r};oe.prototype.lookupTypeOrEnum=function(e){var r=this.lookup(e,[ei,ti]);if(!r)throw Error("no such Type or Enum '"+e+"' in "+this);return r};oe.prototype.lookupService=function(e){var r=this.lookup(e,[Wi]);if(!r)throw Error("no such Service '"+e+"' in "+this);return r};oe._configure=function(t,e,r){ei=t,Wi=e,ti=r}});var $i=R((BE,jh)=>{"use strict";jh.exports=_t;var js=bn();((_t.prototype=Object.create(js.prototype)).constructor=_t).className="OneOf";var Wh=Wr(),$s=He();function _t(t,e,r,n){if(Array.isArray(e)||(r=e,e=void 0),js.call(this,t,r),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}_t.fromJSON=function(e,r){return new _t(e,r.oneof,r.options,r.comment)};_t.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return $s.toObject(["options",this.options,"oneof",this.oneof,"comment",r?this.comment:void 0])};function $h(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}_t.prototype.add=function(e){if(!(e instanceof Wh))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,$h(this),this};_t.prototype.remove=function(e){if(!(e instanceof Wh))throw TypeError("field must be a Field");var r=this.fieldsArray.indexOf(e);if(r<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(r,1),r=this.oneof.indexOf(e.name),r>-1&&this.oneof.splice(r,1),e.partOf=null,this};_t.prototype.onAdd=function(e){js.prototype.onAdd.call(this,e);for(var r=this,n=0;n<this.oneof.length;++n){var i=e.get(this.oneof[n]);i&&!i.partOf&&(i.partOf=r,r.fieldsArray.push(i))}$h(this)};_t.prototype.onRemove=function(e){for(var r=0,n;r<this.fieldsArray.length;++r)(n=this.fieldsArray[r]).parent&&n.parent.remove(n);js.prototype.onRemove.call(this,e)};_t.d=function(){for(var e=new Array(arguments.length),r=0;r<arguments.length;)e[r]=arguments[r++];return function(i,s){$s.decorateType(i.constructor).add(new _t(s,e)),Object.defineProperty(i,s,{get:$s.oneOfGetter(e),set:$s.oneOfSetter(e)})}}});var Js=R((RE,Jh)=>{"use strict";Jh.exports=Ir;var su=Wr();((Ir.prototype=Object.create(su.prototype)).constructor=Ir).className="MapField";var Lm=vn(),ji=He();function Ir(t,e,r,n,i,s){if(su.call(this,t,e,n,void 0,void 0,i,s),!ji.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}Ir.fromJSON=function(e,r){return new Ir(e,r.id,r.keyType,r.type,r.options,r.comment)};Ir.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return ji.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};Ir.prototype.resolve=function(){if(this.resolved)return this;if(Lm.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return su.prototype.resolve.call(this)};Ir.d=function(e,r,n){return typeof n=="function"?n=ji.decorateType(n).name:n&&typeof n=="object"&&(n=ji.decorateEnum(n).name),function(s,o){ji.decorateType(s.constructor).add(new Ir(o,e,r,n))}}});var Zs=R((PE,Zh)=>{"use strict";Zh.exports=wn;var ou=bn();((wn.prototype=Object.create(ou.prototype)).constructor=wn).className="Method";var ni=He();function wn(t,e,r,n,i,s,o,a,c){if(ni.isObject(i)?(o=i,i=s=void 0):ni.isObject(s)&&(o=s,s=void 0),!(e===void 0||ni.isString(e)))throw TypeError("type must be a string");if(!ni.isString(r))throw TypeError("requestType must be a string");if(!ni.isString(n))throw TypeError("responseType must be a string");ou.call(this,t,o),this.type=e||"rpc",this.requestType=r,this.requestStream=i?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}wn.fromJSON=function(e,r){return new wn(e,r.type,r.requestType,r.responseType,r.requestStream,r.responseStream,r.options,r.comment,r.parsedOptions)};wn.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return ni.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",r?this.comment:void 0,"parsedOptions",this.parsedOptions])};wn.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),ou.prototype.resolve.call(this))}});var Ys=R((kE,Qh)=>{"use strict";Qh.exports=At;var $r=ri();((At.prototype=Object.create($r.prototype)).constructor=At).className="Service";var au=Zs(),Ji=He(),Fm=Ya();function At(t,e){$r.call(this,t,e),this.methods={},this._methodsArray=null}At.fromJSON=function(e,r){var n=new At(e,r.options);if(r.methods)for(var i=Object.keys(r.methods),s=0;s<i.length;++s)n.add(au.fromJSON(i[s],r.methods[i[s]]));return r.nested&&n.addJSON(r.nested),n.comment=r.comment,n};At.prototype.toJSON=function(e){var r=$r.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return Ji.toObject(["options",r&&r.options||void 0,"methods",$r.arrayToJSON(this.methodsArray,e)||{},"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(At.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Ji.toArray(this.methods))}});function Yh(t){return t._methodsArray=null,t}At.prototype.get=function(e){return this.methods[e]||$r.prototype.get.call(this,e)};At.prototype.resolveAll=function(){for(var e=this.methodsArray,r=0;r<e.length;++r)e[r].resolve();return $r.prototype.resolve.call(this)};At.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof au?(this.methods[e.name]=e,e.parent=this,Yh(this)):$r.prototype.add.call(this,e)};At.prototype.remove=function(e){if(e instanceof au){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Yh(this)}return $r.prototype.remove.call(this,e)};At.prototype.create=function(e,r,n){for(var i=new Fm.Service(e,r,n),s=0,o;s<this.methodsArray.length;++s){var a=Ji.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Ji.codegen(["r","c"],Ji.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var Qs=R((OE,Xh)=>{"use strict";Xh.exports=tr;var Um=Qt();function tr(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)this[e[r]]=t[e[r]]}tr.create=function(e){return this.$type.create(e)};tr.encode=function(e,r){return this.$type.encode(e,r)};tr.encodeDelimited=function(e,r){return this.$type.encodeDelimited(e,r)};tr.decode=function(e){return this.$type.decode(e)};tr.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};tr.verify=function(e){return this.$type.verify(e)};tr.fromObject=function(e){return this.$type.fromObject(e)};tr.toObject=function(e,r){return this.$type.toObject(e,r)};tr.prototype.toJSON=function(){return this.$type.toObject(this,Um.toJSONOptions)}});var uu=R((ME,tl)=>{"use strict";tl.exports=zm;var qm=Kt(),_r=vn(),el=He();function Km(t){return"missing required '"+t.name+"'"}function zm(t){var e=el.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var r=0;r<t.fieldsArray.length;++r){var n=t._fieldsArray[r].resolve(),i=n.resolvedType instanceof qm?"int32":n.type,s="m"+el.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),_r.defaults[n.keyType]!==void 0?e("k=%j",_r.defaults[n.keyType]):e("k=null"),_r.defaults[i]!==void 0?e("value=%j",_r.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),_r.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",r):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),_r.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):n.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),_r.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),_r.basic[i]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,r):e("%s.push(r.%s())",s,i)):_r.basic[i]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,r):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<t._fieldsArray.length;++r){var o=t._fieldsArray[r];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",Km(o))}return e("return m")}});var hu=R((NE,rl)=>{"use strict";rl.exports=Hm;var Vm=Kt(),cu=He();function Tt(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function fu(t,e,r,n){if(e.resolvedType)if(e.resolvedType instanceof Vm){t("switch(%s){",n)("default:")("return%j",Tt(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)t("case %i:",e.resolvedType.values[i[s]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",r,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",n)("return%j",Tt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",Tt(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',n)("return%j",Tt(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',n)("return%j",Tt(e,"boolean"));break;case"string":t("if(!util.isString(%s))",n)("return%j",Tt(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",Tt(e,"buffer"));break}return t}function Gm(t,e,r){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",r)("return%j",Tt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",r)("return%j",Tt(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",r)("return%j",Tt(e,"boolean key"));break}return t}function Hm(t){var e=cu.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=t.oneofsArray,n={};r.length&&e("var p={}");for(var i=0;i<t.fieldsArray.length;++i){var s=t._fieldsArray[i].resolve(),o="m"+cu.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",Tt(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),Gm(e,s,"k[i]"),fu(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",Tt(s,"array"))("for(var i=0;i<%s.length;++i){",o),fu(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=cu.safeProp(s.partOf.name);n[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,e("p%s=1",a)}fu(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var du=R(il=>{"use strict";var nl=il,Zi=Kt(),rr=He();function lu(t,e,r,n){if(e.resolvedType)if(e.resolvedType instanceof Zi){t("switch(d%s){",n);for(var i=e.resolvedType.values,s=Object.keys(i),o=0;o<s.length;++o)e.repeated&&i[s[o]]===e.typeDefault&&t("default:"),t("case%j:",s[o])("case %i:",i[s[o]])("m%s=%j",n,i[s[o]])("break");t("}")}else t('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var a=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",n,n);break;case"uint64":a=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,a)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,a?"true":"");break;case"bytes":t('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":t("m%s=String(d%s)",n,n);break;case"bool":t("m%s=Boolean(d%s)",n,n);break}}return t}nl.fromObject=function(e){var r=e.fieldsArray,n=rr.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!r.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<r.length;++i){var s=r[i].resolve(),o=rr.safeProp(s.name);s.map?(n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),lu(n,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),lu(n,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Zi||n("if(d%s!=null){",o),lu(n,s,i,o),s.resolvedType instanceof Zi||n("}"))}return n("return m")};function pu(t,e,r,n){if(e.resolvedType)e.resolvedType instanceof Zi?t("d%s=o.enums===String?types[%i].values[m%s]:m%s",n,r,n,n):t("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var i=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,i?"true":"",n);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:t("d%s=m%s",n,n);break}}return t}nl.toObject=function(e){var r=e.fieldsArray.slice().sort(rr.compareFieldsById);if(!r.length)return rr.codegen()("return {}");for(var n=rr.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<r.length;++a)r[a].partOf||(r[a].resolve().repeated?i:r[a].map?s:o).push(r[a]);if(i.length){for(n("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)n("d%s=[]",rr.safeProp(i[a].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),a=0;a<s.length;++a)n("d%s={}",rr.safeProp(s[a].name));n("}")}if(o.length){for(n("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],f=rr.safeProp(c.name);if(c.resolvedType instanceof Zi)n("d%s=o.enums===String?%j:%j",f,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",f)("}else")("d%s=o.longs===String?%j:%i",f,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var u="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",f,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",f,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",f,f)("}")}else n("d%s=%j",f,c.typeDefault)}n("}")}var h=!1;for(a=0;a<r.length;++a){var c=r[a],l=e._fieldsArray.indexOf(c),f=rr.safeProp(c.name);c.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",f,f)("d%s={}",f)("for(var j=0;j<ks2.length;++j){"),pu(n,c,l,f+"[ks2[j]]")("}")):c.repeated?(n("if(m%s&&m%s.length){",f,f)("d%s=[]",f)("for(var j=0;j<m%s.length;++j){",f),pu(n,c,l,f+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",f,c.name),pu(n,c,l,f),c.partOf&&n("if(o.oneofs)")("d%s=%j",rr.safeProp(c.partOf.name),c.name)),n("}")}return n("return d")}});var gu=R(sl=>{"use strict";var Wm=sl,$m=Qs();Wm[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),r=this.lookup(e);if(r){var n=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var r="type.googleapis.com/",n="",i="";if(e&&e.json&&t.type_url&&t.value){i=t.type_url.substring(t.type_url.lastIndexOf("/")+1),n=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(t=s.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof $m){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return n===""&&(n=r),i=n+a,o["@type"]=i,o}return this.toObject(t,e)}}});var to=R((UE,al)=>{"use strict";al.exports=me;var zt=ri();((me.prototype=Object.create(zt.prototype)).constructor=me).className="Type";var jm=Kt(),vu=$i(),Xs=Wr(),Jm=Js(),Zm=Ys(),yu=Qs(),mu=Gs(),Ym=zs(),et=He(),Qm=bu(),Xm=uu(),ev=hu(),ol=du(),tv=gu();function me(t,e){zt.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(me.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var r=this.fields[t[e]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=et.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=et.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=me.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof yu||((t.prototype=new yu).constructor=t,et.merge(t.prototype,e)),t.$type=t.prototype.$type=this,et.merge(t,yu,!0),this._ctor=t;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:et.oneOfGetter(this._oneofsArray[r].oneof),set:et.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(t.prototype,n)}}});me.generateConstructor=function(e){for(var r=et.codegen(["p"],e.name),n=0,i;n<e.fieldsArray.length;++n)(i=e._fieldsArray[n]).map?r("this%s={}",et.safeProp(i.name)):i.repeated&&r("this%s=[]",et.safeProp(i.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function eo(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}me.fromJSON=function(e,r){var n=new me(e,r.options);n.extensions=r.extensions,n.reserved=r.reserved;for(var i=Object.keys(r.fields),s=0;s<i.length;++s)n.add((typeof r.fields[i[s]].keyType<"u"?Jm.fromJSON:Xs.fromJSON)(i[s],r.fields[i[s]]));if(r.oneofs)for(i=Object.keys(r.oneofs),s=0;s<i.length;++s)n.add(vu.fromJSON(i[s],r.oneofs[i[s]]));if(r.nested)for(i=Object.keys(r.nested),s=0;s<i.length;++s){var o=r.nested[i[s]];n.add((o.id!==void 0?Xs.fromJSON:o.fields!==void 0?me.fromJSON:o.values!==void 0?jm.fromJSON:o.methods!==void 0?Zm.fromJSON:zt.fromJSON)(i[s],o))}return r.extensions&&r.extensions.length&&(n.extensions=r.extensions),r.reserved&&r.reserved.length&&(n.reserved=r.reserved),r.group&&(n.group=!0),r.comment&&(n.comment=r.comment),n};me.prototype.toJSON=function(e){var r=zt.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return et.toObject(["options",r&&r.options||void 0,"oneofs",zt.arrayToJSON(this.oneofsArray,e),"fields",zt.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};me.prototype.resolveAll=function(){for(var e=this.fieldsArray,r=0;r<e.length;)e[r++].resolve();var n=this.oneofsArray;for(r=0;r<n.length;)n[r++].resolve();return zt.prototype.resolveAll.call(this)};me.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};me.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof Xs&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),eo(this)}return e instanceof vu?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),eo(this)):zt.prototype.add.call(this,e)};me.prototype.remove=function(e){if(e instanceof Xs&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),eo(this)}if(e instanceof vu){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),eo(this)}return zt.prototype.remove.call(this,e)};me.prototype.isReservedId=function(e){return zt.isReservedId(this.reserved,e)};me.prototype.isReservedName=function(e){return zt.isReservedName(this.reserved,e)};me.prototype.create=function(e){return new this.ctor(e)};me.prototype.setup=function(){for(var e=this.fullName,r=[],n=0;n<this.fieldsArray.length;++n)r.push(this._fieldsArray[n].resolve().resolvedType);this.encode=Qm(this)({Writer:Ym,types:r,util:et}),this.decode=Xm(this)({Reader:mu,types:r,util:et}),this.verify=ev(this)({types:r,util:et}),this.fromObject=ol.fromObject(this)({types:r,util:et}),this.toObject=ol.toObject(this)({types:r,util:et});var i=tv[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};me.prototype.encode=function(e,r){return this.setup().encode(e,r)};me.prototype.encodeDelimited=function(e,r){return this.encode(e,r&&r.len?r.fork():r).ldelim()};me.prototype.decode=function(e,r){return this.setup().decode(e,r)};me.prototype.decodeDelimited=function(e){return e instanceof mu||(e=mu.create(e)),this.decode(e,e.uint32())};me.prototype.verify=function(e){return this.setup().verify(e)};me.prototype.fromObject=function(e){return this.setup().fromObject(e)};me.prototype.toObject=function(e,r){return this.setup().toObject(e,r)};me.d=function(e){return function(n){et.decorateType(n,e)}}});var io=R((qE,ll)=>{"use strict";ll.exports=vt;var no=ri();((vt.prototype=Object.create(no.prototype)).constructor=vt).className="Root";var xu=Wr(),cl=Kt(),rv=$i(),jr=He(),fl,wu,Yi;function vt(t){no.call(this,"",t),this.deferred=[],this.files=[]}vt.fromJSON=function(e,r){return r||(r=new vt),e.options&&r.setOptions(e.options),r.addJSON(e.nested)};vt.prototype.resolvePath=jr.path.resolve;vt.prototype.fetch=jr.fetch;function hl(){}vt.prototype.load=function t(e,r,n){typeof r=="function"&&(n=r,r=void 0);var i=this;if(!n)return jr.asPromise(t,i,e,r);var s=n===hl;function o(d,p){if(!!n){var g=n;if(n=null,s)throw d;g(d,p)}}function a(d){var p=d.lastIndexOf("google/protobuf/");if(p>-1){var g=d.substring(p);if(g in Yi)return g}return null}function c(d,p){try{if(jr.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!jr.isString(p))i.setOptions(p.options).addJSON(p.nested);else{wu.filename=d;var g=wu(p,i,r),y,v=0;if(g.imports)for(;v<g.imports.length;++v)(y=a(g.imports[v])||i.resolvePath(d,g.imports[v]))&&f(y);if(g.weakImports)for(v=0;v<g.weakImports.length;++v)(y=a(g.weakImports[v])||i.resolvePath(d,g.weakImports[v]))&&f(y,!0)}}catch(x){o(x)}!s&&!u&&o(null,i)}function f(d,p){if(!(i.files.indexOf(d)>-1)){if(i.files.push(d),d in Yi){s?c(d,Yi[d]):(++u,setTimeout(function(){--u,c(d,Yi[d])}));return}if(s){var g;try{g=jr.fs.readFileSync(d).toString("utf8")}catch(y){p||o(y);return}c(d,g)}else++u,i.fetch(d,function(y,v){if(--u,!!n){if(y){p?u||o(null,i):o(y);return}c(d,v)}})}}var u=0;jr.isString(e)&&(e=[e]);for(var h=0,l;h<e.length;++h)(l=i.resolvePath("",e[h]))&&f(l);if(s)return i;u||o(null,i)};vt.prototype.loadSync=function(e,r){if(!jr.isNode)throw Error("not supported");return this.load(e,r,hl)};vt.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return no.prototype.resolveAll.call(this)};var ro=/^[A-Z]/;function ul(t,e){var r=e.parent.lookup(e.extend);if(r){var n=new xu(e.fullName,e.id,e.type,e.rule,void 0,e.options);return n.declaringField=e,e.extensionField=n,r.add(n),!0}return!1}vt.prototype._handleAdd=function(e){if(e instanceof xu)e.extend!==void 0&&!e.extensionField&&(ul(this,e)||this.deferred.push(e));else if(e instanceof cl)ro.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof rv)){if(e instanceof fl)for(var r=0;r<this.deferred.length;)ul(this,this.deferred[r])?this.deferred.splice(r,1):++r;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);ro.test(e.name)&&(e.parent[e.name]=e)}};vt.prototype._handleRemove=function(e){if(e instanceof xu){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var r=this.deferred.indexOf(e);r>-1&&this.deferred.splice(r,1)}}else if(e instanceof cl)ro.test(e.name)&&delete e.parent[e.name];else if(e instanceof no){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);ro.test(e.name)&&delete e.parent[e.name]}};vt._configure=function(t,e,r){fl=t,wu=e,Yi=r}});var He=R((KE,dl)=>{"use strict";var Me=dl.exports=Qt(),pl=Qa(),Su,Eu;Me.codegen=Ph();Me.fetch=Oh();Me.path=Lh();Me.fs=Me.inquire("fs");Me.toArray=function(e){if(e){for(var r=Object.keys(e),n=new Array(r.length),i=0;i<r.length;)n[i]=e[r[i++]];return n}return[]};Me.toObject=function(e){for(var r={},n=0;n<e.length;){var i=e[n++],s=e[n++];s!==void 0&&(r[i]=s)}return r};var nv=/\\/g,iv=/"/g;Me.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Me.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Me.isReserved(e)?'["'+e.replace(nv,"\\\\").replace(iv,'\\"')+'"]':"."+e};Me.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var sv=/_([a-z])/g;Me.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(sv,function(r,n){return n.toUpperCase()})};Me.compareFieldsById=function(e,r){return e.id-r.id};Me.decorateType=function(e,r){if(e.$type)return r&&e.$type.name!==r&&(Me.decorateRoot.remove(e.$type),e.$type.name=r,Me.decorateRoot.add(e.$type)),e.$type;Su||(Su=to());var n=new Su(r||e.name);return Me.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var ov=0;Me.decorateEnum=function(e){if(e.$type)return e.$type;Eu||(Eu=Kt());var r=new Eu("Enum"+ov++,e);return Me.decorateRoot.add(r),Object.defineProperty(e,"$type",{value:r,enumerable:!1}),r};Me.setProperty=function(e,r,n){function i(s,o,a){var c=o.shift();if(c==="__proto__")return s;if(o.length>0)s[c]=i(s[c]||{},o,a);else{var f=s[c];f&&(a=[].concat(f).concat(a)),s[c]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!r)throw TypeError("path must be specified");return r=r.split("."),i(e,r,n)};Object.defineProperty(Me,"decorateRoot",{get:function(){return pl.decorated||(pl.decorated=new(io()))}})});var bn=R((zE,gl)=>{"use strict";gl.exports=bt;bt.className="ReflectionObject";var so=He(),oo;function bt(t,e){if(!so.isString(t))throw TypeError("name must be a string");if(e&&!so.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(bt.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});bt.prototype.toJSON=function(){throw Error()};bt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var r=e.root;r instanceof oo&&r._handleAdd(this)};bt.prototype.onRemove=function(e){var r=e.root;r instanceof oo&&r._handleRemove(this),this.parent=null,this.resolved=!1};bt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof oo&&(this.resolved=!0),this)};bt.prototype.getOption=function(e){if(this.options)return this.options[e]};bt.prototype.setOption=function(e,r,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=r),this};bt.prototype.setParsedOption=function(e,r,n){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(n){var s=i.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];so.setProperty(o,n,r)}else s={},s[e]=so.setProperty({},n,r),i.push(s)}else{var a={};a[e]=r,i.push(a)}return this};bt.prototype.setOptions=function(e,r){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],r);return this};bt.prototype.toString=function(){var e=this.constructor.className,r=this.fullName;return r.length?e+" "+r:e};bt._configure=function(t){oo=t}});var Kt=R((VE,vl)=>{"use strict";vl.exports=nr;var yl=bn();((nr.prototype=Object.create(yl.prototype)).constructor=nr).className="Enum";var ml=ri(),ao=He();function nr(t,e,r,n,i){if(yl.call(this,t,r),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=i||{},this.reserved=void 0,e)for(var s=Object.keys(e),o=0;o<s.length;++o)typeof e[s[o]]=="number"&&(this.valuesById[this.values[s[o]]=e[s[o]]]=s[o])}nr.fromJSON=function(e,r){var n=new nr(e,r.values,r.options,r.comment,r.comments);return n.reserved=r.reserved,n};nr.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return ao.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",r?this.comment:void 0,"comments",r?this.comments:void 0])};nr.prototype.add=function(e,r,n){if(!ao.isString(e))throw TypeError("name must be a string");if(!ao.isInteger(r))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(r))throw Error("id "+r+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[r]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+r+" in "+this);this.values[e]=r}else this.valuesById[this.values[e]=r]=e;return this.comments[e]=n||null,this};nr.prototype.remove=function(e){if(!ao.isString(e))throw TypeError("name must be a string");var r=this.values[e];if(r==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[r],delete this.values[e],delete this.comments[e],this};nr.prototype.isReservedId=function(e){return ml.isReservedId(this.reserved,e)};nr.prototype.isReservedName=function(e){return ml.isReservedName(this.reserved,e)}});var bu=R((GE,wl)=>{"use strict";wl.exports=uv;var av=Kt(),Du=vn(),Cu=He();function bl(t,e,r,n){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(e.id<<3|2)>>>0)}function uv(t){for(var e=Cu.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),r,n,i=t.fieldsArray.slice().sort(Cu.compareFieldsById),r=0;r<i.length;++r){var s=i[r].resolve(),o=t._fieldsArray.indexOf(s),a=s.resolvedType instanceof av?"int32":s.type,c=Du.basic[a];n="m"+Cu.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Du.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,n),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",n,n),s.packed&&Du.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",a,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),c===void 0?bl(e,s,o,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,n)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),c===void 0?bl(e,s,o,n):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,n))}return e("return w")}});var Sl=R((HE,xl)=>{"use strict";var Q=xl.exports=Bh();Q.build="light";function cv(t,e,r){return typeof e=="function"?(r=e,e=new Q.Root):e||(e=new Q.Root),e.load(t,r)}Q.load=cv;function fv(t,e){return e||(e=new Q.Root),e.loadSync(t)}Q.loadSync=fv;Q.encoder=bu();Q.decoder=uu();Q.verifier=hu();Q.converter=du();Q.ReflectionObject=bn();Q.Namespace=ri();Q.Root=io();Q.Enum=Kt();Q.Type=to();Q.Field=Wr();Q.OneOf=$i();Q.MapField=Js();Q.Service=Ys();Q.Method=Zs();Q.Message=Qs();Q.wrappers=gu();Q.types=vn();Q.util=He();Q.ReflectionObject._configure(Q.Root);Q.Namespace._configure(Q.Type,Q.Service,Q.Enum);Q.Root._configure(Q.Type);Q.Field._configure(Q.Type)});var _u=R((WE,Cl)=>{"use strict";Cl.exports=Dl;var Iu=/[\s{}=;:[\],'"()<>]/g,hv=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,lv=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,pv=/^ *[*/]+ */,dv=/^\s*\*?\/*/,gv=/\n/g,yv=/\s/,mv=/\\(.?)/g,vv={0:"\0",r:"\r",n:`
`,t:"	"};function El(t){return t.replace(mv,function(e,r){switch(r){case"\\":case"":return r;default:return vv[r]||""}})}Dl.unescape=El;function Dl(t,e){t=t.toString();var r=0,n=t.length,i=1,s=0,o={},a=[],c=null;function f(D){return Error("illegal "+D+" (line "+i+")")}function u(){var D=c==="'"?lv:hv;D.lastIndex=r-1;var w=D.exec(t);if(!w)throw f("string");return r=D.lastIndex,y(c),c=null,El(w[1])}function h(D){return t.charAt(D)}function l(D,w,S){var P={type:t.charAt(D++),lineEmpty:!1,leading:S},L;e?L=2:L=3;var q=D-L,J;do if(--q<0||(J=t.charAt(q))===`
`){P.lineEmpty=!0;break}while(J===" "||J==="	");for(var he=t.substring(D,w).split(gv),Z=0;Z<he.length;++Z)he[Z]=he[Z].replace(e?dv:pv,"").trim();P.text=he.join(`
`).trim(),o[i]=P,s=i}function d(D){var w=p(D),S=t.substring(D,w),P=/^\s*\/{1,2}/.test(S);return P}function p(D){for(var w=D;w<n&&h(w)!==`
`;)w++;return w}function g(){if(a.length>0)return a.shift();if(c)return u();var D,w,S,P,L,q=r===0;do{if(r===n)return null;for(D=!1;yv.test(S=h(r));)if(S===`
`&&(q=!0,++i),++r===n)return null;if(h(r)==="/"){if(++r===n)throw f("comment");if(h(r)==="/")if(e){if(P=r,L=!1,d(r)){L=!0;do if(r=p(r),r===n||(r++,!q))break;while(d(r))}else r=Math.min(n,p(r)+1);L&&(l(P,r,q),q=!0),i++,D=!0}else{for(L=h(P=r+1)==="/";h(++r)!==`
`;)if(r===n)return null;++r,L&&(l(P,r-1,q),q=!0),++i,D=!0}else if((S=h(r))==="*"){P=r+1,L=e||h(P)==="*";do{if(S===`
`&&++i,++r===n)throw f("comment");w=S,S=h(r)}while(w!=="*"||S!=="/");++r,L&&(l(P,r-2,q),q=!0),D=!0}else return"/"}}while(D);var J=r;Iu.lastIndex=0;var he=Iu.test(h(J++));if(!he)for(;J<n&&!Iu.test(h(J));)++J;var Z=t.substring(r,r=J);return(Z==='"'||Z==="'")&&(c=Z),Z}function y(D){a.push(D)}function v(){if(!a.length){var D=g();if(D===null)return null;y(D)}return a[0]}function x(D,w){var S=v(),P=S===D;if(P)return g(),!0;if(!w)throw f("token '"+S+"', '"+D+"' expected");return!1}function C(D){var w=null,S;return D===void 0?(S=o[i-1],delete o[i-1],S&&(e||S.type==="*"||S.lineEmpty)&&(w=S.leading?S.text:null)):(s<D&&v(),S=o[D],delete o[D],S&&!S.lineEmpty&&(e||S.type==="/")&&(w=S.leading?null:S.text)),w}return Object.defineProperty({next:g,peek:v,push:y,skip:x,cmnt:C},"line",{get:function(){return i}})}});var Rl=R(($E,Bl)=>{"use strict";Bl.exports=Ar;Ar.filename=null;Ar.defaults={keepCase:!1};var bv=_u(),Il=io(),_l=to(),Al=Wr(),wv=Js(),Tl=$i(),xv=Kt(),Sv=Ys(),Ev=Zs(),Au=vn(),Tu=He(),Dv=/^[1-9][0-9]*$/,Cv=/^-?[1-9][0-9]*$/,Iv=/^0[x][0-9a-fA-F]+$/,_v=/^-?0[x][0-9a-fA-F]+$/,Av=/^0[0-7]+$/,Tv=/^-?0[0-7]+$/,Bv=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,ir=/^[a-zA-Z_][a-zA-Z_0-9]*$/,sr=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,Rv=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Ar(t,e,r){e instanceof Il||(r=e,e=new Il),r||(r=Ar.defaults);var n=r.preferTrailingComment||!1,i=bv(t,r.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,c=i.skip,f=i.cmnt,u=!0,h,l,d,p,g=!1,y=e,v=r.keepCase?function(T){return T}:Tu.camelCase;function x(T,B,k){var G=Ar.filename;return k||(Ar.filename=null),Error("illegal "+(B||"token")+" '"+T+"' ("+(G?G+", ":"")+"line "+i.line+")")}function C(){var T=[],B;do{if((B=s())!=='"'&&B!=="'")throw x(B);T.push(s()),c(B),B=a()}while(B==='"'||B==="'");return T.join("")}function D(T){var B=s();switch(B){case"'":case'"':return o(B),C();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return S(B,!0)}catch{if(T&&sr.test(B))return B;throw x(B,"value")}}function w(T,B){var k,G;do B&&((k=a())==='"'||k==="'")?T.push(C()):T.push([G=P(s()),c("to",!0)?P(s()):G]);while(c(",",!0));c(";")}function S(T,B){var k=1;switch(T.charAt(0)==="-"&&(k=-1,T=T.substring(1)),T){case"inf":case"INF":case"Inf":return k*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(Dv.test(T))return k*parseInt(T,10);if(Iv.test(T))return k*parseInt(T,16);if(Av.test(T))return k*parseInt(T,8);if(Bv.test(T))return k*parseFloat(T);throw x(T,"number",B)}function P(T,B){switch(T){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!B&&T.charAt(0)==="-")throw x(T,"id");if(Cv.test(T))return parseInt(T,10);if(_v.test(T))return parseInt(T,16);if(Tv.test(T))return parseInt(T,8);throw x(T,"id")}function L(){if(h!==void 0)throw x("package");if(h=s(),!sr.test(h))throw x(h,"name");y=y.define(h),c(";")}function q(){var T=a(),B;switch(T){case"weak":B=d||(d=[]),s();break;case"public":s();default:B=l||(l=[]);break}T=C(),c(";"),B.push(T)}function J(){if(c("="),p=C(),g=p==="proto3",!g&&p!=="proto2")throw x(p,"syntax");c(";")}function he(T,B){switch(B){case"option":return ut(T,B),c(";"),!0;case"message":return qr(T,B),!0;case"enum":return Mi(T,B),!0;case"service":return ty(T,B),!0;case"extend":return ny(T,B),!0}return!1}function Z(T,B,k){var G=i.line;if(T&&(typeof T.comment!="string"&&(T.comment=f()),T.filename=Ar.filename),c("{",!0)){for(var K;(K=s())!=="}";)B(K);c(";",!0)}else k&&k(),c(";"),T&&(typeof T.comment!="string"||n)&&(T.comment=f(G)||T.comment)}function qr(T,B){if(!ir.test(B=s()))throw x(B,"type name");var k=new _l(B);Z(k,function(K){if(!he(k,K))switch(K){case"map":Xe(k,K);break;case"required":case"repeated":Ze(k,K);break;case"optional":g?Ze(k,"proto3_optional"):Ze(k,"optional");break;case"oneof":V(k,K);break;case"extensions":w(k.extensions||(k.extensions=[]));break;case"reserved":w(k.reserved||(k.reserved=[]),!0);break;default:if(!g||!sr.test(K))throw x(K);o(K),Ze(k,"optional");break}}),T.add(k)}function Ze(T,B,k){var G=s();if(G==="group"){_e(T,B);return}if(!sr.test(G))throw x(G,"type");var K=s();if(!ir.test(K))throw x(K,"name");K=v(K),c("=");var re=new Al(K,P(s()),G,B,k);if(Z(re,function(Lt){if(Lt==="option")ut(re,Lt),c(";");else throw x(Lt)},function(){ha(re)}),B==="proto3_optional"){var Ye=new Tl("_"+K);re.setOption("proto3_optional",!0),Ye.add(re),T.add(Ye)}else T.add(re);!g&&re.repeated&&(Au.packed[G]!==void 0||Au.basic[G]===void 0)&&re.setOption("packed",!1,!0)}function _e(T,B){var k=s();if(!ir.test(k))throw x(k,"name");var G=Tu.lcFirst(k);k===G&&(k=Tu.ucFirst(k)),c("=");var K=P(s()),re=new _l(k);re.group=!0;var Ye=new Al(G,K,k,B);Ye.filename=Ar.filename,Z(re,function(Lt){switch(Lt){case"option":ut(re,Lt),c(";");break;case"required":case"repeated":Ze(re,Lt);break;case"optional":g?Ze(re,"proto3_optional"):Ze(re,"optional");break;default:throw x(Lt)}}),T.add(re).add(Ye)}function Xe(T){c("<");var B=s();if(Au.mapKey[B]===void 0)throw x(B,"type");c(",");var k=s();if(!sr.test(k))throw x(k,"type");c(">");var G=s();if(!ir.test(G))throw x(G,"name");c("=");var K=new wv(v(G),P(s()),B,k);Z(K,function(Ye){if(Ye==="option")ut(K,Ye),c(";");else throw x(Ye)},function(){ha(K)}),T.add(K)}function V(T,B){if(!ir.test(B=s()))throw x(B,"name");var k=new Tl(v(B));Z(k,function(K){K==="option"?(ut(k,K),c(";")):(o(K),Ze(k,"optional"))}),T.add(k)}function Mi(T,B){if(!ir.test(B=s()))throw x(B,"name");var k=new xv(B);Z(k,function(K){switch(K){case"option":ut(k,K),c(";");break;case"reserved":w(k.reserved||(k.reserved=[]),!0);break;default:Ni(k,K)}}),T.add(k)}function Ni(T,B){if(!ir.test(B))throw x(B,"name");c("=");var k=P(s(),!0),G={};Z(G,function(re){if(re==="option")ut(G,re),c(";");else throw x(re)},function(){ha(G)}),T.add(B,k,G.comment)}function ut(T,B){var k=c("(",!0);if(!sr.test(B=s()))throw x(B,"name");var G=B,K=G,re;k&&(c(")"),G="("+G+")",K=G,B=a(),Rv.test(B)&&(re=B.slice(1),G+=B,s())),c("=");var Ye=Vn(T,G);ey(T,K,Ye,re)}function Vn(T,B){if(c("{",!0)){for(var k={};!c("}",!0);){if(!ir.test(ct=s()))throw x(ct,"name");var G,K=ct;if(c(":",!0),a()==="{")G=Vn(T,B+"."+ct);else if(a()==="["){G=[];var re;if(c("[",!0)){do re=D(!0),G.push(re);while(c(",",!0));c("]"),typeof re<"u"&&Gn(T,B+"."+ct,re)}}else G=D(!0),Gn(T,B+"."+ct,G);var Ye=k[K];Ye&&(G=[].concat(Ye).concat(G)),k[K]=G,c(",",!0),c(";",!0)}return k}var Kr=D(!0);return Gn(T,B,Kr),Kr}function Gn(T,B,k){T.setOption&&T.setOption(B,k)}function ey(T,B,k,G){T.setParsedOption&&T.setParsedOption(B,k,G)}function ha(T){if(c("[",!0)){do ut(T,"option");while(c(",",!0));c("]")}return T}function ty(T,B){if(!ir.test(B=s()))throw x(B,"service name");var k=new Sv(B);Z(k,function(K){if(!he(k,K))if(K==="rpc")ry(k,K);else throw x(K)}),T.add(k)}function ry(T,B){var k=f(),G=B;if(!ir.test(B=s()))throw x(B,"name");var K=B,re,Ye,Kr,Lt;if(c("("),c("stream",!0)&&(Ye=!0),!sr.test(B=s())||(re=B,c(")"),c("returns"),c("("),c("stream",!0)&&(Lt=!0),!sr.test(B=s())))throw x(B);Kr=B,c(")");var Bs=new Ev(K,G,re,Kr,Ye,Lt);Bs.comment=k,Z(Bs,function(la){if(la==="option")ut(Bs,la),c(";");else throw x(la)}),T.add(Bs)}function ny(T,B){if(!sr.test(B=s()))throw x(B,"reference");var k=B;Z(null,function(K){switch(K){case"required":case"repeated":Ze(T,K,k);break;case"optional":g?Ze(T,"proto3_optional",k):Ze(T,"optional",k);break;default:if(!g||!sr.test(K))throw x(K);o(K),Ze(T,"optional",k);break}})}for(var ct;(ct=s())!==null;)switch(ct){case"package":if(!u)throw x(ct);L();break;case"import":if(!u)throw x(ct);q();break;case"syntax":if(!u)throw x(ct);J();break;case"option":ut(y,ct),c(";");break;default:if(he(y,ct)){u=!1;continue}throw x(ct)}return Ar.filename=null,{package:h,imports:l,weakImports:d,syntax:p,root:e}}});var Ol=R((jE,kl)=>{"use strict";kl.exports=Vt;var Pv=/\/|\./;function Vt(t,e){Pv.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Vt[t]=e}Vt("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Pl;Vt("duration",{Duration:Pl={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Vt("timestamp",{Timestamp:Pl});Vt("empty",{Empty:{fields:{}}});Vt("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Vt("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Vt("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Vt.get=function(e){return Vt[e]||null}});var Nl=R((JE,Ml)=>{"use strict";var Jr=Ml.exports=Sl();Jr.build="full";Jr.tokenize=_u();Jr.parse=Rl();Jr.common=Ol();Jr.Root._configure(Jr.Type,Jr.parse,Jr.common)});var Bu=R((ZE,Ll)=>{"use strict";Ll.exports=Nl()});var le=R((f3,ql)=>{ql.exports={options:{usePureJavaScript:!1}}});var Vl=R((h3,zl)=>{var Mu={};zl.exports=Mu;var Kl={};Mu.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Mv(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%s,f=f/s|0;for(;f>0;)a.push(f%s),f=f/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Mu.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Kl[e];if(!r){r=Kl[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<o.length;++c)f+=o[c]*i,o[c]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var u=0;t[u]===s&&u<t.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Mv(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Ne=R((l3,$l)=>{var Gl=le(),Hl=Vl(),m=$l.exports=Gl.util=Gl.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){m.nextTick=process.nextTick,typeof setImmediate=="function"?m.setImmediate=setImmediate:m.setImmediate=m.nextTick;return}if(typeof setImmediate=="function"){m.setImmediate=function(){return setImmediate.apply(void 0,arguments)},m.nextTick=function(a){return setImmediate(a)};return}if(m.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var o=a,t="forge.setImmediate",e=[];m.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var s=m.setImmediate;m.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}m.nextTick=m.setImmediate})();m.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;m.globalScope=function(){return m.isNodejs?globalThis:typeof self>"u"?window:self}();m.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};m.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};m.isArrayBufferView=function(t){return t&&m.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Qi(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}m.ByteBuffer=Nu;function Nu(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(m.isArrayBuffer(t)||m.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Nu||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}m.ByteStringBuffer=Nu;var Nv=4096;m.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Nv&&(this.data.substr(0,1),this._constructedStringLength=0)};m.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};m.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};m.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};m.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};m.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};m.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(m.encodeUtf8(t))};m.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};m.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};m.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};m.ByteStringBuffer.prototype.putInt=function(t,e){Qi(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};m.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};m.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};m.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};m.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};m.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};m.ByteStringBuffer.prototype.getInt=function(t){Qi(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};m.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};m.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};m.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};m.ByteStringBuffer.prototype.copy=function(){var t=m.createBuffer(this.data);return t.read=this.read,t};m.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};m.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};m.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};m.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.ByteStringBuffer.prototype.toString=function(){return m.decodeUtf8(this.bytes())};function Lv(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=m.isArrayBuffer(t),n=m.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}m.DataBuffer=Lv;m.DataBuffer.prototype.length=function(){return this.write-this.read};m.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};m.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};m.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};m.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};m.DataBuffer.prototype.putBytes=function(t,e){if(m.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(m.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof m.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&m.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof m.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=m.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=m.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};m.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};m.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};m.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};m.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};m.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};m.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};m.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};m.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};m.DataBuffer.prototype.putInt=function(t,e){Qi(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};m.DataBuffer.prototype.putSignedInt=function(t,e){return Qi(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};m.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};m.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};m.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};m.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};m.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};m.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};m.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};m.DataBuffer.prototype.getInt=function(t){Qi(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};m.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};m.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};m.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};m.DataBuffer.prototype.copy=function(){return new m.DataBuffer(this)};m.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};m.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};m.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};m.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return m.binary.raw.encode(e);if(t==="hex")return m.binary.hex.encode(e);if(t==="base64")return m.binary.base64.encode(e);if(t==="utf8")return m.text.utf8.decode(e);if(t==="utf16")return m.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};m.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=m.encodeUtf8(t)),new m.ByteBuffer(t)};m.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};m.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};m.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};m.bytesToHex=function(t){return m.createBuffer(t).toHex()};m.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Zr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Yr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Wl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";m.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=Zr.charAt(i>>2),r+=Zr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Zr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Zr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Yr[t.charCodeAt(o++)-43],n=Yr[t.charCodeAt(o++)-43],i=Yr[t.charCodeAt(o++)-43],s=Yr[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};m.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};m.decodeUtf8=function(t){return decodeURIComponent(escape(t))};m.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Hl.encode,decode:Hl.decode}};m.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};m.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};m.binary.hex.encode=m.bytesToHex;m.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};m.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=Zr.charAt(i>>2),r+=Zr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Zr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Zr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,f=r;c<t.length;)i=Yr[t.charCodeAt(c++)-43],s=Yr[t.charCodeAt(c++)-43],o=Yr[t.charCodeAt(c++)-43],a=Yr[t.charCodeAt(c++)-43],n[f++]=i<<2|s>>4,o!==64&&(n[f++]=(s&15)<<4|o>>2,a!==64&&(n[f++]=(o&3)<<6|a));return e?f-r:n.subarray(0,f)};m.binary.base58.encode=function(t,e){return m.binary.baseN.encode(t,Wl,e)};m.binary.base58.decode=function(t,e){return m.binary.baseN.decode(t,Wl,e)};m.text={utf8:{},utf16:{}};m.text.utf8.encode=function(t,e,r){t=m.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};m.text.utf8.decode=function(t){return m.decodeUtf8(String.fromCharCode.apply(null,t))};m.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};m.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};m.deflate=function(t,e,r){if(e=m.decode64(t.deflate(m.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};m.inflate=function(t,e,r){var n=t.inflate(m.encode64(e)).rval;return n===null?null:m.decode64(n)};var Lu=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=m.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Fu=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(m.decode64(r))),r},Fv=function(t,e,r,n){var i=Fu(t,e);i===null&&(i={}),i[r]=n,Lu(t,e,i)},Uv=function(t,e,r){var n=Fu(t,e);return n!==null&&(n=r in n?n[r]:null),n},qv=function(t,e,r){var n=Fu(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Lu(t,e,n)}},Kv=function(t,e){Lu(t,e,null)},fo=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};m.setItem=function(t,e,r,n,i){fo(Fv,arguments,i)};m.getItem=function(t,e,r,n){return fo(Uv,arguments,n)};m.removeItem=function(t,e,r,n){fo(qv,arguments,n)};m.clearItems=function(t,e,r){fo(Kv,arguments,r)};m.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};m.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};m.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-f).toFixed(s).slice(2):"")};m.formatSize=function(t){return t>=1073741824?t=m.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=m.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=m.formatNumber(t/1024,0)+" KiB":t=m.formatNumber(t,0)+" bytes",t};m.bytesFromIP=function(t){return t.indexOf(".")!==-1?m.bytesFromIPv4(t):t.indexOf(":")!==-1?m.bytesFromIPv6(t):null};m.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=m.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};m.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=m.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=m.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};m.bytesToIP=function(t){return t.length===4?m.bytesToIPv4(t):t.length===16?m.bytesToIPv6(t):null};m.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};m.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=m.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};m.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in m&&!t.update)return e(null,m.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return m.cores=navigator.hardwareConcurrency,e(null,m.cores);if(typeof Worker>"u")return m.cores=1,e(null,m.cores);if(typeof Blob>"u")return m.cores=2,e(null,m.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var f=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return m.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,m.cores)}i(c,function(u,h){o.push(s(c,h)),n(o,a-1,c)})}function i(o,a){for(var c=[],f=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===o){for(var d=0;d<o;++d)c[d].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<o;++u)c[u].postMessage(u)}function s(o,a){for(var c=[],f=0;f<o;++f)for(var u=a[f],h=c[f]=[],l=0;l<o;++l)if(f!==l){var d=a[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return c.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var ho=R((p3,jl)=>{var Xi=le();Xi.pki=Xi.pki||{};var Uu=jl.exports=Xi.pki.oids=Xi.oids=Xi.oids||{};function A(t,e){Uu[t]=e,Uu[e]=t}function fe(t,e){Uu[t]=e}A("1.2.840.113549.1.1.1","rsaEncryption");A("1.2.840.113549.1.1.4","md5WithRSAEncryption");A("1.2.840.113549.1.1.5","sha1WithRSAEncryption");A("1.2.840.113549.1.1.7","RSAES-OAEP");A("1.2.840.113549.1.1.8","mgf1");A("1.2.840.113549.1.1.9","pSpecified");A("1.2.840.113549.1.1.10","RSASSA-PSS");A("1.2.840.113549.1.1.11","sha256WithRSAEncryption");A("1.2.840.113549.1.1.12","sha384WithRSAEncryption");A("1.2.840.113549.1.1.13","sha512WithRSAEncryption");A("1.3.101.112","EdDSA25519");A("1.2.840.10040.4.3","dsa-with-sha1");A("1.3.14.3.2.7","desCBC");A("1.3.14.3.2.26","sha1");A("1.3.14.3.2.29","sha1WithRSASignature");A("2.16.840.1.101.3.4.2.1","sha256");A("2.16.840.1.101.3.4.2.2","sha384");A("2.16.840.1.101.3.4.2.3","sha512");A("2.16.840.1.101.3.4.2.4","sha224");A("2.16.840.1.101.3.4.2.5","sha512-224");A("2.16.840.1.101.3.4.2.6","sha512-256");A("1.2.840.113549.2.2","md2");A("1.2.840.113549.2.5","md5");A("1.2.840.113549.1.7.1","data");A("1.2.840.113549.1.7.2","signedData");A("1.2.840.113549.1.7.3","envelopedData");A("1.2.840.113549.1.7.4","signedAndEnvelopedData");A("1.2.840.113549.1.7.5","digestedData");A("1.2.840.113549.1.7.6","encryptedData");A("1.2.840.113549.1.9.1","emailAddress");A("1.2.840.113549.1.9.2","unstructuredName");A("1.2.840.113549.1.9.3","contentType");A("1.2.840.113549.1.9.4","messageDigest");A("1.2.840.113549.1.9.5","signingTime");A("1.2.840.113549.1.9.6","counterSignature");A("1.2.840.113549.1.9.7","challengePassword");A("1.2.840.113549.1.9.8","unstructuredAddress");A("1.2.840.113549.1.9.14","extensionRequest");A("1.2.840.113549.1.9.20","friendlyName");A("1.2.840.113549.1.9.21","localKeyId");A("1.2.840.113549.1.9.22.1","x509Certificate");A("1.2.840.113549.1.12.10.1.1","keyBag");A("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");A("1.2.840.113549.1.12.10.1.3","certBag");A("1.2.840.113549.1.12.10.1.4","crlBag");A("1.2.840.113549.1.12.10.1.5","secretBag");A("1.2.840.113549.1.12.10.1.6","safeContentsBag");A("1.2.840.113549.1.5.13","pkcs5PBES2");A("1.2.840.113549.1.5.12","pkcs5PBKDF2");A("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");A("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");A("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");A("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");A("1.2.840.113549.2.7","hmacWithSHA1");A("1.2.840.113549.2.8","hmacWithSHA224");A("1.2.840.113549.2.9","hmacWithSHA256");A("1.2.840.113549.2.10","hmacWithSHA384");A("1.2.840.113549.2.11","hmacWithSHA512");A("1.2.840.113549.3.7","des-EDE3-CBC");A("2.16.840.1.101.3.4.1.2","aes128-CBC");A("2.16.840.1.101.3.4.1.22","aes192-CBC");A("2.16.840.1.101.3.4.1.42","aes256-CBC");A("2.5.4.3","commonName");A("2.5.4.4","surname");A("2.5.4.5","serialNumber");A("2.5.4.6","countryName");A("2.5.4.7","localityName");A("2.5.4.8","stateOrProvinceName");A("2.5.4.9","streetAddress");A("2.5.4.10","organizationName");A("2.5.4.11","organizationalUnitName");A("2.5.4.12","title");A("2.5.4.13","description");A("2.5.4.15","businessCategory");A("2.5.4.17","postalCode");A("2.5.4.42","givenName");A("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");A("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");A("2.16.840.1.113730.1.1","nsCertType");A("2.16.840.1.113730.1.13","nsComment");fe("2.5.29.1","authorityKeyIdentifier");fe("2.5.29.2","keyAttributes");fe("2.5.29.3","certificatePolicies");fe("2.5.29.4","keyUsageRestriction");fe("2.5.29.5","policyMapping");fe("2.5.29.6","subtreesConstraint");fe("2.5.29.7","subjectAltName");fe("2.5.29.8","issuerAltName");fe("2.5.29.9","subjectDirectoryAttributes");fe("2.5.29.10","basicConstraints");fe("2.5.29.11","nameConstraints");fe("2.5.29.12","policyConstraints");fe("2.5.29.13","basicConstraints");A("2.5.29.14","subjectKeyIdentifier");A("2.5.29.15","keyUsage");fe("2.5.29.16","privateKeyUsagePeriod");A("2.5.29.17","subjectAltName");A("2.5.29.18","issuerAltName");A("2.5.29.19","basicConstraints");fe("2.5.29.20","cRLNumber");fe("2.5.29.21","cRLReason");fe("2.5.29.22","expirationDate");fe("2.5.29.23","instructionCode");fe("2.5.29.24","invalidityDate");fe("2.5.29.25","cRLDistributionPoints");fe("2.5.29.26","issuingDistributionPoint");fe("2.5.29.27","deltaCRLIndicator");fe("2.5.29.28","issuingDistributionPoint");fe("2.5.29.29","certificateIssuer");fe("2.5.29.30","nameConstraints");A("2.5.29.31","cRLDistributionPoints");A("2.5.29.32","certificatePolicies");fe("2.5.29.33","policyMappings");fe("2.5.29.34","policyConstraints");A("2.5.29.35","authorityKeyIdentifier");fe("2.5.29.36","policyConstraints");A("2.5.29.37","extKeyUsage");fe("2.5.29.46","freshestCRL");fe("2.5.29.54","inhibitAnyPolicy");A("1.3.6.1.4.1.11129.2.4.2","timestampList");A("1.3.6.1.5.5.7.1.1","authorityInfoAccess");A("1.3.6.1.5.5.7.3.1","serverAuth");A("1.3.6.1.5.5.7.3.2","clientAuth");A("1.3.6.1.5.5.7.3.3","codeSigning");A("1.3.6.1.5.5.7.3.4","emailProtection");A("1.3.6.1.5.5.7.3.8","timeStamping")});var ts=R((d3,Zl)=>{var Se=le();Ne();ho();var O=Zl.exports=Se.asn1=Se.asn1||{};O.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};O.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};O.create=function(t,e,r,n,i){if(Se.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||Se.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=O.copy(a)),a};O.copy=function(t,e){var r;if(Se.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(O.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:O.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};O.equals=function(t,e,r){if(Se.util.isArray(t)){if(!Se.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!O.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&O.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};O.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function es(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var zv=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;es(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};O.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=Se.util.createBuffer(t));var r=t.length(),n=lo(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function lo(t,e,r,n){var i;es(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=zv(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(s&32)===32;if(l)if(u=[],c===void 0)for(;;){if(es(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(lo(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(lo(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&o===O.Class.UNIVERSAL&&a===O.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&o===O.Class.UNIVERSAL&&a===O.Type.BITSTRING&&c>1){var d=t.read,p=e,g=0;if(a===O.Type.BITSTRING&&(es(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},v=lo(t,e,r+1,y),x=i-t.length();e-=x,a==O.Type.BITSTRING&&x++;var C=v.tagClass;x===c&&(C===O.Class.UNIVERSAL||C===O.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===O.Type.BMPSTRING)for(u="";c>0;c-=2)es(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var D=h===void 0?null:{bitStringContents:h};return O.create(o,a,l,u,D)}O.toDer=function(t){var e=Se.util.createBuffer(),r=t.tagClass|t.type,n=Se.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=O.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(O.toDer(t.value[s]))}else if(t.type===O.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===O.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};O.oidToDer=function(t){var e=t.split("."),r=Se.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};O.derToOid=function(t){var e;typeof t=="string"&&(t=Se.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};O.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};O.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);f=d*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};O.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};O.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};O.integerToDer=function(t){var e=Se.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};O.derToInteger=function(t){typeof t=="string"&&(t=Se.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};O.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&Se.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=O.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Jl=/[^\\u0000-\\u00ff]/;O.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case O.Class.UNIVERSAL:n+="Universal:";break;case O.Class.APPLICATION:n+="Application:";break;case O.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case O.Class.PRIVATE:n+="Private:";break}if(t.tagClass===O.Class.UNIVERSAL)switch(n+=t.type,t.type){case O.Type.NONE:n+=" (None)";break;case O.Type.BOOLEAN:n+=" (Boolean)";break;case O.Type.INTEGER:n+=" (Integer)";break;case O.Type.BITSTRING:n+=" (Bit string)";break;case O.Type.OCTETSTRING:n+=" (Octet string)";break;case O.Type.NULL:n+=" (Null)";break;case O.Type.OID:n+=" (Object Identifier)";break;case O.Type.ODESC:n+=" (Object Descriptor)";break;case O.Type.EXTERNAL:n+=" (External or Instance of)";break;case O.Type.REAL:n+=" (Real)";break;case O.Type.ENUMERATED:n+=" (Enumerated)";break;case O.Type.EMBEDDED:n+=" (Embedded PDV)";break;case O.Type.UTF8:n+=" (UTF8)";break;case O.Type.ROID:n+=" (Relative Object Identifier)";break;case O.Type.SEQUENCE:n+=" (Sequence)";break;case O.Type.SET:n+=" (Set)";break;case O.Type.PRINTABLESTRING:n+=" (Printable String)";break;case O.Type.IA5String:n+=" (IA5String (ASCII))";break;case O.Type.UTCTIME:n+=" (UTC time)";break;case O.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case O.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=O.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===O.Type.OID){var c=O.derToOid(t.value);n+=c,Se.pki&&Se.pki.oids&&c in Se.pki.oids&&(n+=" ("+Se.pki.oids[c]+") ")}if(t.type===O.Type.INTEGER)try{n+=O.derToInteger(t.value)}catch{n+="0x"+Se.util.bytesToHex(t.value)}else if(t.type===O.Type.BITSTRING){if(t.value.length>1?n+="0x"+Se.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===O.Type.OCTETSTRING)Jl.test(t.value)||(n+="("+t.value+") "),n+="0x"+Se.util.bytesToHex(t.value);else if(t.type===O.Type.UTF8)try{n+=Se.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+Se.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===O.Type.PRINTABLESTRING||t.type===O.Type.IA5String?n+=t.value:Jl.test(t.value)?n+="0x"+Se.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ku=R((g3,Yl)=>{var We=le();Ne();Yl.exports=We.cipher=We.cipher||{};We.cipher.algorithms=We.cipher.algorithms||{};We.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=We.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new We.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};We.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=We.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new We.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};We.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),We.cipher.algorithms[t]=e};We.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in We.cipher.algorithms?We.cipher.algorithms[t]:null};var qu=We.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};qu.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=We.util.createBuffer(),this.output=t.output||We.util.createBuffer(),this.mode.start(e)};qu.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};qu.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Vu=R((y3,Ql)=>{var $e=le();Ne();$e.cipher=$e.cipher||{};var j=Ql.exports=$e.cipher.modes=$e.cipher.modes||{};j.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};j.ecb.prototype.start=function(t){};j.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};j.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};j.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};j.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};j.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};j.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=po(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};j.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};j.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};j.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};j.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};j.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=$e.util.createBuffer(),this._partialBytes=0};j.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=po(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};j.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};j.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};j.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=$e.util.createBuffer(),this._partialBytes=0};j.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=po(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};j.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};j.ofb.prototype.decrypt=j.ofb.prototype.encrypt;j.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=$e.util.createBuffer(),this._partialBytes=0};j.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=po(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};j.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}go(this._inBlock)};j.ctr.prototype.decrypt=j.ctr.prototype.encrypt;j.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=$e.util.createBuffer(),this._partialBytes=0,this._R=3774873600};j.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=$e.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=$e.util.createBuffer(t.additionalData):r=$e.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=$e.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(zu(n*8)))}this._inBlock=this._j0.slice(0),go(this._inBlock),this._partialBytes=0,r=$e.util.createBuffer(r),this._aDataLength=zu(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};j.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),go(this._inBlock)};j.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),go(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};j.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=$e.util.createBuffer();var n=this._aDataLength.concat(zu(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};j.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};j.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};j.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};j.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};j.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,f=(n-1-o%n)*e;a[c]=1<<e-1<<f,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};j.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var f=i[s^n];i[s]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function po(t,e){if(typeof t=="string"&&(t=$e.util.createBuffer(t)),$e.util.isArray(t)&&t.length>4){var r=t;t=$e.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!$e.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function go(t){t[t.length-1]=t[t.length-1]+1&4294967295}function zu(t){return[t/4294967296|0,t&4294967295]}});var mo=R((m3,r0)=>{var be=le();Ku();Vu();Ne();r0.exports=be.aes=be.aes||{};be.aes.startEncrypting=function(t,e,r,n){var i=yo({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};be.aes.createEncryptionCipher=function(t,e){return yo({key:t,output:null,decrypt:!1,mode:e})};be.aes.startDecrypting=function(t,e,r,n){var i=yo({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};be.aes.createDecryptionCipher=function(t,e){return yo({key:t,output:null,decrypt:!0,mode:e})};be.aes.Algorithm=function(t,e){Wu||e0();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Hu(r._w,n,i,!1)},decrypt:function(n,i){return Hu(r._w,n,i,!0)}}}),r._init=!1};be.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=be.util.createBuffer(e);else if(be.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=be.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!be.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!be.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=t0(e,t.decrypt&&!o),this._init=!0}};be.aes._expandKey=function(t,e){return Wu||e0(),t0(t,e)};be.aes._updateBlock=Hu;oi("AES-ECB",be.cipher.modes.ecb);oi("AES-CBC",be.cipher.modes.cbc);oi("AES-CFB",be.cipher.modes.cfb);oi("AES-OFB",be.cipher.modes.ofb);oi("AES-CTR",be.cipher.modes.ctr);oi("AES-GCM",be.cipher.modes.gcm);function oi(t,e){var r=function(){return new be.aes.Algorithm(t,e)};be.cipher.registerAlgorithm(t,r)}var Wu=!1,si=4,rt,Gu,Xl,xn,Gt;function e0(){Wu=!0,Xl=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;rt=new Array(256),Gu=new Array(256),xn=new Array(4),Gt=new Array(4);for(var e=0;e<4;++e)xn[e]=new Array(256),Gt[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,f,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,rt[r]=a,Gu[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],f=c<<24^a<<16^a<<8^(a^c),u=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)xn[h][r]=f,Gt[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function t0(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=si*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=rt[n>>>16&255]<<24^rt[n>>>8&255]<<16^rt[n&255]<<8^rt[n>>>24]^Xl[i]<<24,i++):s>6&&c%s===4&&(n=rt[n>>>24]<<24^rt[n>>>16&255]<<16^rt[n>>>8&255]<<8^rt[n&255]),r[c]=r[c-s]^n;if(e){var f,u=Gt[0],h=Gt[1],l=Gt[2],d=Gt[3],p=r.slice(0);a=r.length;for(var c=0,g=a-si;c<a;c+=si,g-=si)if(c===0||c===a-si)p[c]=r[g],p[c+1]=r[g+3],p[c+2]=r[g+2],p[c+3]=r[g+1];else for(var y=0;y<si;++y)f=r[g+y],p[c+(3&-y)]=u[rt[f>>>24]]^h[rt[f>>>16&255]]^l[rt[f>>>8&255]]^d[rt[f&255]];r=p}return r}function Hu(t,e,r,n){var i=t.length/4-1,s,o,a,c,f;n?(s=Gt[0],o=Gt[1],a=Gt[2],c=Gt[3],f=Gu):(s=xn[0],o=xn[1],a=xn[2],c=xn[3],f=rt);var u,h,l,d,p,g,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,x=1;x<i;++x)p=s[u>>>24]^o[h>>>16&255]^a[l>>>8&255]^c[d&255]^t[++v],g=s[h>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[u&255]^t[++v],y=s[l>>>24]^o[d>>>16&255]^a[u>>>8&255]^c[h&255]^t[++v],d=s[d>>>24]^o[u>>>16&255]^a[h>>>8&255]^c[l&255]^t[++v],u=p,h=g,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[d&255]^t[++v],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[d>>>8&255]<<8^f[u&255]^t[++v],r[2]=f[l>>>24]<<24^f[d>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++v],r[n?1:3]=f[d>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++v]}function yo(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=be.cipher.createDecipher(r,t.key):n=be.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof be.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var s0=R((v3,i0)=>{var Ce=le();Ku();Vu();Ne();i0.exports=Ce.des=Ce.des||{};Ce.des.startEncrypting=function(t,e,r,n){var i=vo({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Ce.des.createEncryptionCipher=function(t,e){return vo({key:t,output:null,decrypt:!1,mode:e})};Ce.des.startDecrypting=function(t,e,r,n){var i=vo({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Ce.des.createDecryptionCipher=function(t,e){return vo({key:t,output:null,decrypt:!0,mode:e})};Ce.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return n0(r._keys,n,i,!1)},decrypt:function(n,i){return n0(r._keys,n,i,!0)}}}),r._init=!1};Ce.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Ce.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Yv(e),this._init=!0}};ur("DES-ECB",Ce.cipher.modes.ecb);ur("DES-CBC",Ce.cipher.modes.cbc);ur("DES-CFB",Ce.cipher.modes.cfb);ur("DES-OFB",Ce.cipher.modes.ofb);ur("DES-CTR",Ce.cipher.modes.ctr);ur("3DES-ECB",Ce.cipher.modes.ecb);ur("3DES-CBC",Ce.cipher.modes.cbc);ur("3DES-CFB",Ce.cipher.modes.cfb);ur("3DES-OFB",Ce.cipher.modes.ofb);ur("3DES-CTR",Ce.cipher.modes.ctr);function ur(t,e){var r=function(){return new Ce.des.Algorithm(t,e)};Ce.cipher.registerAlgorithm(t,r)}var Vv=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Gv=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Hv=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Wv=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],$v=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],jv=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Jv=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Zv=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Yv(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,y=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,C,D=0;D<g;D++){var w=t.getInt32(),S=t.getInt32();C=(w>>>4^S)&252645135,S^=C,w^=C<<4,C=(S>>>-16^w)&65535,w^=C,S^=C<<-16,C=(w>>>2^S)&858993459,S^=C,w^=C<<2,C=(S>>>-16^w)&65535,w^=C,S^=C<<-16,C=(w>>>1^S)&1431655765,S^=C,w^=C<<1,C=(S>>>8^w)&16711935,w^=C,S^=C<<8,C=(w>>>1^S)&1431655765,S^=C,w^=C<<1,C=w<<8|S>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=C;for(var P=0;P<v.length;++P){v[P]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),w&=-15,S&=-15;var L=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|s[w>>>12&15]|o[w>>>8&15]|a[w>>>4&15],q=c[S>>>28]|f[S>>>24&15]|u[S>>>20&15]|h[S>>>16&15]|l[S>>>12&15]|d[S>>>8&15]|p[S>>>4&15];C=(q>>>16^L)&65535,y[x++]=L^C,y[x++]=q^C<<16}}return y}function n0(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=s[f+1],h=s[f+2],l=s[f];l!=u;l+=h){var d=c^t[l],p=(c>>>4|c<<28)^t[l+1];o=a,a=c,c=o^(Gv[d>>>24&63]|Wv[d>>>16&63]|jv[d>>>8&63]|Zv[d&63]|Vv[p>>>24&63]|Hv[p>>>16&63]|$v[p>>>8&63]|Jv[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function vo(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Ce.cipher.createDecipher(r,t.key):n=Ce.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof Ce.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Sn=R((b3,o0)=>{var bo=le();o0.exports=bo.md=bo.md||{};bo.md.algorithms=bo.md.algorithms||{}});var u0=R((w3,a0)=>{var Pr=le();Sn();Ne();var Qv=a0.exports=Pr.hmac=Pr.hmac||{};Qv.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Pr.md.algorithms)e=Pr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Pr.util.createBuffer(o);else if(Pr.util.isArray(o)){var a=o;o=Pr.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var f=o.length();f>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Pr.util.createBuffer(),n=Pr.util.createBuffer(),f=o.length();for(var c=0;c<f;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var ai=R(()=>{});var $u=R((E3,c0)=>{var nt=le();u0();Sn();Ne();var Xv=nt.pkcs5=nt.pkcs5||{},kr;nt.util.isNodejs&&!nt.options.usePureJavaScript&&(kr=ai());c0.exports=nt.pbkdf2=Xv.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),nt.util.isNodejs&&!nt.options.usePureJavaScript&&kr.pbkdf2&&(i===null||typeof i!="object")&&(kr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?kr.pbkdf2Sync.length===4?kr.pbkdf2(t,e,r,n,function(C,D){if(C)return s(C);s(null,D.toString("binary"))}):kr.pbkdf2(t,e,r,n,i,function(C,D){if(C)return s(C);s(null,D.toString("binary"))}):kr.pbkdf2Sync.length===4?kr.pbkdf2Sync(t,e,r,n).toString("binary"):kr.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in nt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=nt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),f=n-(c-1)*o,u=nt.hmac.create();u.start(i,t);var h="",l,d,p;if(!s){for(var g=1;g<=c;++g){u.start(null,null),u.update(e),u.update(nt.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=nt.util.xorBytes(l,d,o),p=d;h+=g<c?l:l.substr(0,f)}return h}var g=1,y;function v(){if(g>c)return s(null,h);u.start(null,null),u.update(e),u.update(nt.util.int32ToBytes(g)),l=p=u.digest().getBytes(),y=2,x()}function x(){if(y<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=nt.util.xorBytes(l,d,o),p=d,++y,nt.util.setImmediate(x);h+=g<c?l:l.substr(0,f),++g,v()}v()}});var l0=R((D3,h0)=>{var xo=le();Ne();var f0=h0.exports=xo.pem=xo.pem||{};f0.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=wo(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=wo(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=wo(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=wo(t.headers[i]);return t.procType&&(r+=`\r
`),r+=xo.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};f0.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:xo.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(i),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)d.values.push(e1(p[g]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function wo(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function e1(t){return t.replace(/^\s+/,"")}});var v0=R((C3,m0)=>{var cr=le();Sn();Ne();var d0=m0.exports=cr.sha256=cr.sha256||{};cr.md.sha256=cr.md.algorithms.sha256=d0;d0.create=function(){g0||t1();var t=null,e=cr.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=cr.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=cr.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),p0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=cr.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ju.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};p0(h,r,i);var l=cr.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var ju=null,g0=!1,y0=null;function t1(){ju=String.fromCharCode(128),ju+=cr.util.fillString(String.fromCharCode(0),64),y0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g0=!0}function p0(t,e,r){for(var n,i,s,o,a,c,f,u,h,l,d,p,g,y,v,x=r.length();x>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,y=t.h6,v=t.h7,f=0;f<64;++f)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(g^y),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=v+o+a+y0[f]+e[f],i=s+c,v=y,y=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+y|0,t.h7=t.h7+v|0,x-=64}}});var w0=R((I3,b0)=>{var fr=le();Ne();var So=null;fr.util.isNodejs&&!fr.options.usePureJavaScript&&!process.versions["node-webkit"]&&(So=ai());var r1=b0.exports=fr.prng=fr.prng||{};r1.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=fr.util.createBuffer();e.key=null,y();function y(v){if(v)return u(v);if(g.length()>=f)return u(null,g.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return fr.util.nextTick(function(){s(y)});var x=h(e.key,e.seed);e.generated+=x.length,g.putBytes(x),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),fr.util.setImmediate(y)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=fr.util.createBuffer();p.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(f)};function s(f){if(e.pools[0].messageLength>=32)return a(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),a(),f()})}function o(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=fr.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(w){return l.getRandomValues(w)});var d=fr.util.createBuffer();if(u)for(;d.length()<f;){var p=Math.max(1,Math.min(f-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var y=0;y<g.length;++y)d.putInt32(g[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(d.length()<f)for(var v,x,C,D=Math.floor(Math.random()*65536);d.length()<f;){x=16807*(D&65535),v=16807*(D>>16),x+=(v&32767)<<16,x+=v>>15,x=(x&2147483647)+(x>>31),D=x&4294967295;for(var y=0;y<3;++y)C=D>>>(y<<3),C^=Math.floor(Math.random()*256),d.putByte(C&255)}return d.getBytes(f)}return So?(e.seedFile=function(f,u){So.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return So.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){f.postMessage({forge:{prng:{err:d,bytes:p}}})})};f.addEventListener("message",u)}},e}});var rs=R((_3,Ju)=>{var je=le();mo();v0();w0();Ne();(function(){if(je.random&&je.random.getBytes){Ju.exports=je.random;return}(function(t){var e={},r=new Array(4),n=je.util.createBuffer();e.formatKey=function(h){var l=je.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),je.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=je.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return je.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=je.md.sha256;function i(){var h=je.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=je.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),je.options.usePureJavaScript||!je.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}s.collect(f),f=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!je.random)je.random=s;else for(var u in s)je.random[u]=s[u];je.random.createInstance=i,Ju.exports=je.random})(typeof jQuery<"u"?jQuery:null)})()});var D0=R((A3,E0)=>{var ht=le();Ne();var Zu=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],x0=[1,2,3,5],n1=function(t,e){return t<<e&65535|(t&65535)>>16-e},i1=function(t,e){return(t&65535)>>e|t<<16-e&65535};E0.exports=ht.rc2=ht.rc2||{};ht.rc2.expandKey=function(t,e){typeof t=="string"&&(t=ht.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Zu[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Zu[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Zu[r.at(a+1)^r.at(a+s)]);return r};var S0=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,f,u,h=[];for(t=ht.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=n1(p[f],x0[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=i1(p[f],x0[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var g=[];for(f=0;f<4;f++){var y=i.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),g.push(y&65535)}u=r?0:63;for(var v=0;v<p.length;v++)for(var x=0;x<p[v][0];x++)p[v][1](g);for(f=0;f<4;f++)o!==null&&(r?o.putInt16Le(g[f]):g[f]^=o.getInt16Le()),s.putInt16Le(g[f])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=ht.util.createBuffer(p)),n=!1,i=ht.util.createBuffer(),s=g||new ht.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,s,!r);else{var v=s.length(),x=s.at(v-1);x>v?g=!1:s.truncate(x)}return g}},d};ht.rc2.startEncrypting=function(t,e,r){var n=ht.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};ht.rc2.createEncryptionCipher=function(t,e){return S0(t,e,!0)};ht.rc2.startDecrypting=function(t,e,r){var n=ht.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};ht.rc2.createDecryptionCipher=function(t,e){return S0(t,e,!1)}});var Co=R((T3,P0)=>{var Yu=le();P0.exports=Yu.jsbn=Yu.jsbn||{};var Or,s1=0xdeadbeefcafe,C0=(s1&16777215)==15715070;function I(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Yu.jsbn.BigInteger=I;function ie(){return new I(null)}function o1(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function a1(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=a*c+f*o;c=o*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function I0(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=a*c+f*o;c=o*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(I.prototype.am=I0,Or=28):C0&&navigator.appName=="Microsoft Internet Explorer"?(I.prototype.am=a1,Or=30):C0&&navigator.appName!="Netscape"?(I.prototype.am=o1,Or=26):(I.prototype.am=I0,Or=28);I.prototype.DB=Or;I.prototype.DM=(1<<Or)-1;I.prototype.DV=1<<Or;var Qu=52;I.prototype.FV=Math.pow(2,Qu);I.prototype.F1=Qu-Or;I.prototype.F2=2*Or-Qu;var u1="0123456789abcdefghijklmnopqrstuvwxyz",Eo=new Array,ui,Bt;ui="0".charCodeAt(0);for(Bt=0;Bt<=9;++Bt)Eo[ui++]=Bt;ui="a".charCodeAt(0);for(Bt=10;Bt<36;++Bt)Eo[ui++]=Bt;ui="A".charCodeAt(0);for(Bt=10;Bt<36;++Bt)Eo[ui++]=Bt;function _0(t){return u1.charAt(t)}function A0(t,e){var r=Eo[t.charCodeAt(e)];return r??-1}function c1(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function f1(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Qr(t){var e=ie();return e.fromInt(t),e}function h1(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:A0(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&I.ZERO.subTo(this,this)}function l1(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function p1(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=_0(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=_0(n));return i?s:"0"}function d1(){var t=ie();return I.ZERO.subTo(this,t),t}function g1(){return this.s<0?this.negate():this}function y1(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Do(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function m1(){return this.t<=0?0:this.DB*(this.t-1)+Do(this.data[this.t-1]^this.s&this.DM)}function v1(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function b1(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function w1(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function x1(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function S1(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function E1(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&I.ZERO.subTo(e,e)}function D1(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function C1(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ie());var s=ie(),o=this.s,a=t.s,c=this.DB-Do(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var f=s.t,u=s.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,y=g-f,v=e??ie();for(s.dlShiftTo(y,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),I.ONE.dlShiftTo(f,v),v.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--y>=0;){var x=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=s.am(0,x,r,y,0,f))<x)for(s.dlShiftTo(y,v),r.subTo(v,r);r.data[g]<--x;)r.subTo(v,r)}e!=null&&(r.drShiftTo(f,e),o!=a&&I.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&I.ZERO.subTo(r,r)}}}function I1(t){var e=ie();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(I.ZERO)>0&&t.subTo(e,e),e}function En(t){this.m=t}function _1(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function A1(t){return t}function T1(t){t.divRemTo(this.m,null,t)}function B1(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function R1(t,e){t.squareTo(e),this.reduce(e)}En.prototype.convert=_1;En.prototype.revert=A1;En.prototype.reduce=T1;En.prototype.mulTo=B1;En.prototype.sqrTo=R1;function P1(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Dn(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function k1(t){var e=ie();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(I.ZERO)>0&&this.m.subTo(e,e),e}function O1(t){var e=ie();return t.copyTo(e),this.reduce(e),e}function M1(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function N1(t,e){t.squareTo(e),this.reduce(e)}function L1(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Dn.prototype.convert=k1;Dn.prototype.revert=O1;Dn.prototype.reduce=M1;Dn.prototype.mulTo=L1;Dn.prototype.sqrTo=N1;function F1(){return(this.t>0?this.data[0]&1:this.s)==0}function U1(t,e){if(t>4294967295||t<1)return I.ONE;var r=ie(),n=ie(),i=e.convert(this),s=Do(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function q1(t,e){var r;return t<256||e.isEven()?r=new En(e):r=new Dn(e),this.exp(t,r)}I.prototype.copyTo=c1;I.prototype.fromInt=f1;I.prototype.fromString=h1;I.prototype.clamp=l1;I.prototype.dlShiftTo=v1;I.prototype.drShiftTo=b1;I.prototype.lShiftTo=w1;I.prototype.rShiftTo=x1;I.prototype.subTo=S1;I.prototype.multiplyTo=E1;I.prototype.squareTo=D1;I.prototype.divRemTo=C1;I.prototype.invDigit=P1;I.prototype.isEven=F1;I.prototype.exp=U1;I.prototype.toString=p1;I.prototype.negate=d1;I.prototype.abs=g1;I.prototype.compareTo=y1;I.prototype.bitLength=m1;I.prototype.mod=I1;I.prototype.modPowInt=q1;I.ZERO=Qr(0);I.ONE=Qr(1);function K1(){var t=ie();return this.copyTo(t),t}function z1(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function V1(){return this.t==0?this.s:this.data[0]<<24>>24}function G1(){return this.t==0?this.s:this.data[0]<<16>>16}function H1(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W1(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function $1(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Qr(r),i=ie(),s=ie(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function j1(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=A0(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&I.ZERO.subTo(this,this)}function J1(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(I.ONE.shiftLeft(t-1),Xu,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(I.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Z1(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Y1(t){return this.compareTo(t)==0}function Q1(t){return this.compareTo(t)<0?this:t}function X1(t){return this.compareTo(t)>0?this:t}function eb(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function tb(t,e){return t&e}function rb(t){var e=ie();return this.bitwiseTo(t,tb,e),e}function Xu(t,e){return t|e}function nb(t){var e=ie();return this.bitwiseTo(t,Xu,e),e}function T0(t,e){return t^e}function ib(t){var e=ie();return this.bitwiseTo(t,T0,e),e}function B0(t,e){return t&~e}function sb(t){var e=ie();return this.bitwiseTo(t,B0,e),e}function ob(){for(var t=ie(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function ab(t){var e=ie();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ub(t){var e=ie();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function cb(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function fb(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+cb(this.data[t]);return this.s<0?this.t*this.DB:-1}function hb(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function lb(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=hb(this.data[r]^e);return t}function pb(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function db(t,e){var r=I.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function gb(t){return this.changeBit(t,Xu)}function yb(t){return this.changeBit(t,B0)}function mb(t){return this.changeBit(t,T0)}function vb(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function bb(t){var e=ie();return this.addTo(t,e),e}function wb(t){var e=ie();return this.subTo(t,e),e}function xb(t){var e=ie();return this.multiplyTo(t,e),e}function Sb(t){var e=ie();return this.divRemTo(t,e,null),e}function Eb(t){var e=ie();return this.divRemTo(t,null,e),e}function Db(t){var e=ie(),r=ie();return this.divRemTo(t,e,r),new Array(e,r)}function Cb(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ib(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function ns(){}function R0(t){return t}function _b(t,e,r){t.multiplyTo(e,r)}function Ab(t,e){t.squareTo(e)}ns.prototype.convert=R0;ns.prototype.revert=R0;ns.prototype.mulTo=_b;ns.prototype.sqrTo=Ab;function Tb(t){return this.exp(t,new ns)}function Bb(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Rb(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function ci(t){this.r2=ie(),this.q3=ie(),I.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Pb(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ie();return t.copyTo(e),this.reduce(e),e}function kb(t){return t}function Ob(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Mb(t,e){t.squareTo(e),this.reduce(e)}function Nb(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ci.prototype.convert=Pb;ci.prototype.revert=kb;ci.prototype.reduce=Ob;ci.prototype.mulTo=Nb;ci.prototype.sqrTo=Mb;function Lb(t,e){var r=t.bitLength(),n,i=Qr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new En(e):e.isEven()?s=new ci(e):s=new Dn(e);var o=new Array,a=3,c=n-1,f=(1<<n)-1;if(o[1]=s.convert(this),n>1){var u=ie();for(s.sqrTo(o[1],u);a<=f;)o[a]=ie(),s.mulTo(u,o[a-2],o[a]),a+=2}var h=t.t-1,l,d=!0,p=ie(),g;for(r=Do(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;(l&1)==0;)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(g=i,i=p,p=g),s.mulTo(p,o[l],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function Fb(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Ub(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function qb(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return I.ZERO;for(var r=t.clone(),n=this.clone(),i=Qr(1),s=Qr(0),o=Qr(0),a=Qr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(I.ONE)!=0)return I.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Ht=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Kb=(1<<26)/Ht[Ht.length-1];function zb(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ht[Ht.length-1]){for(e=0;e<Ht.length;++e)if(r.data[0]==Ht[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ht.length;){for(var n=Ht[e],i=e+1;i<Ht.length&&n<Kb;)n*=Ht[i++];for(n=r.modInt(n);e<i;)if(n%Ht[e++]==0)return!1}return r.millerRabin(t)}function Vb(t){var e=this.subtract(I.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Gb(),s,o=0;o<t;++o){do s=new I(this.bitLength(),i);while(s.compareTo(I.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(I.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(I.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Gb(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}I.prototype.chunkSize=H1;I.prototype.toRadix=$1;I.prototype.fromRadix=j1;I.prototype.fromNumber=J1;I.prototype.bitwiseTo=eb;I.prototype.changeBit=db;I.prototype.addTo=vb;I.prototype.dMultiply=Cb;I.prototype.dAddOffset=Ib;I.prototype.multiplyLowerTo=Bb;I.prototype.multiplyUpperTo=Rb;I.prototype.modInt=Ub;I.prototype.millerRabin=Vb;I.prototype.clone=K1;I.prototype.intValue=z1;I.prototype.byteValue=V1;I.prototype.shortValue=G1;I.prototype.signum=W1;I.prototype.toByteArray=Z1;I.prototype.equals=Y1;I.prototype.min=Q1;I.prototype.max=X1;I.prototype.and=rb;I.prototype.or=nb;I.prototype.xor=ib;I.prototype.andNot=sb;I.prototype.not=ob;I.prototype.shiftLeft=ab;I.prototype.shiftRight=ub;I.prototype.getLowestSetBit=fb;I.prototype.bitCount=lb;I.prototype.testBit=pb;I.prototype.setBit=gb;I.prototype.clearBit=yb;I.prototype.flipBit=mb;I.prototype.add=bb;I.prototype.subtract=wb;I.prototype.multiply=xb;I.prototype.divide=Sb;I.prototype.remainder=Eb;I.prototype.divideAndRemainder=Db;I.prototype.modPow=Lb;I.prototype.modInverse=qb;I.prototype.pow=Tb;I.prototype.gcd=Fb;I.prototype.isProbablePrime=zb});var L0=R((B3,N0)=>{var hr=le();Sn();Ne();var O0=N0.exports=hr.sha1=hr.sha1||{};hr.md.sha1=hr.md.algorithms.sha1=O0;O0.create=function(){M0||Hb();var t=null,e=hr.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=hr.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=hr.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),k0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=hr.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ec.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};k0(h,r,i);var l=hr.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ec=null,M0=!1;function Hb(){ec=String.fromCharCode(128),ec+=hr.util.fillString(String.fromCharCode(0),64),M0=!0}function k0(t,e,r){for(var n,i,s,o,a,c,f,u,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s&o|a&(s^o),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var q0=R((R3,U0)=>{var lr=le();Ne();rs();L0();var F0=U0.exports=lr.pkcs1=lr.pkcs1||{};F0.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=lr.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=c-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=lr.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=s.digestLength,f}var g=Io(i,a-s.digestLength-1,o),y=lr.util.xorBytes(p,g,p.length),v=Io(y,s.digestLength,o),x=lr.util.xorBytes(i,v,i.length);return"\0"+x+y};F0.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(i===void 0?i=lr.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Io(u,i.digestLength,s),l=lr.util.xorBytes(f,h,f.length),d=Io(l,o-i.digestLength-1,s),p=lr.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),y=c!=="\0",v=0;v<i.digestLength;++v)y|=a.charAt(v)!==g.charAt(v);for(var x=1,C=i.digestLength,D=i.digestLength;D<p.length;D++){var w=p.charCodeAt(D),S=w&1^1,P=x?65534:0;y|=w&P,x=x&S,C+=x}if(y||p.charCodeAt(C)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(C+1)};function Io(t,e,r){r||(r=lr.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var K0=R((P3,tc)=>{var Xr=le();Ne();Co();rs();(function(){if(Xr.prime){tc.exports=Xr.prime;return}var t=tc.exports=Xr.prime=Xr.prime||{},e=Xr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Xr.random,y={nextBytes:function(v){for(var x=g.getBytesSync(v.length),C=0;C<v.length;++C)v[C]=x.charCodeAt(C)}};if(p.name==="PRIMEINC")return s(h,y,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?c(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var g=f(h,l),y=0,v=u(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var x=10;"maxBlockTime"in d&&(x=d.maxBlockTime),a(g,h,l,y,v,x,p)}function a(h,l,d,p,g,y,v){var x=+new Date;do{if(h.bitLength()>l&&(h=f(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-x<y);Xr.util.setImmediate(function(){a(h,l,d,p,g,y,v)})}function c(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var g=f(h,l),y=d.workers,v=d.workLoad||100,x=v*30/8,C=d.workerScript||"forge/prime.worker.js";if(y===-1)return Xr.util.estimateCores(function(w,S){w&&(S=2),y=S-1,D()});D();function D(){y=Math.max(1,y);for(var w=[],S=0;S<y;++S)w[S]=new Worker(C);for(var P=y,S=0;S<y;++S)w[S].addEventListener("message",q);var L=!1;function q(J){if(!L){--P;var he=J.data;if(he.found){for(var Z=0;Z<w.length;++Z)w[Z].terminate();return L=!0,p(null,new e(he.prime,16))}g.bitLength()>h&&(g=f(h,l));var qr=g.toString(16);J.target.postMessage({hex:qr,workLoad:v}),g.dAddOffset(x,0)}}}}function f(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Ao=R((k3,j0)=>{var z=le();ts();Co();ho();q0();K0();rs();Ne();typeof X>"u"&&(X=z.jsbn.BigInteger);var X,rc=z.util.isNodejs?ai():null,b=z.asn1,Rt=z.util;z.pki=z.pki||{};j0.exports=z.pki.rsa=z.rsa=z.rsa||{};var W=z.pki,Wb=[6,4,2,4,2,4,6,2],$b={name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},jb={name:"RSAPrivateKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Jb={name:"RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Zb=z.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Yb={name:"DigestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Qb=function(t){var e;if(t.algorithm in W.oids)e=W.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=b.oidToDer(e).getBytes(),i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),s=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);s.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,n)),s.value.push(b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,""));var o=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),b.toDer(i).getBytes()},W0=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(X.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(X.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new X(z.util.bytesToHex(z.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(X.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};W.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=$0(t,e,r)):(i=z.util.createBuffer(),i.putBytes(t));for(var o=new X(i.toHex(),16),a=W0(o,e,n),c=a.toString(16),f=z.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(z.util.hexToBytes(c)),f.getBytes()};W.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new X(z.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=W0(o,e,r),c=a.toString(16),f=z.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(z.util.hexToBytes(c)),n!==!1?_o(f.getBytes(),e,r):f.getBytes()};W.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||z.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new X(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};W.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new X(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new X(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(X.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(e2(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Wb[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(X.ONE),t.q1=t.q.subtract(X.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(X.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};W.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!z.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(z0("generateKeyPair"))return rc.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:W.privateKeyFromPem(f),publicKey:W.publicKeyFromPem(c)})});if(V0("generateKey")&&V0("exportKey"))return Rt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:H0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Rt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=W.privateKeyFromAsn1(b.fromDer(z.util.createBuffer(a)));n(null,{privateKey:c,publicKey:W.setRsaPublicKey(c.n,c.e)})}});if(G0("generateKey")&&G0("exportKey")){var i=Rt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:H0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=Rt.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=W.privateKeyFromAsn1(b.fromDer(z.util.createBuffer(h)));n(null,{privateKey:l,publicKey:W.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(z0("generateKeyPairSync")){var s=rc.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:W.privateKeyFromPem(s.privateKey),publicKey:W.publicKeyFromPem(s.publicKey)}}}var o=W.rsa.createKeyPairGenerationState(t,e,r);if(!n)return W.rsa.stepKeyPairGenerationState(o,0),o.keys;Xb(o,r,n)};W.setRsaPublicKey=W.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return $0(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return z.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return W.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=_o(f,r,!0);var u=b.fromDer(f,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!b.validate(u,Yb,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=b.derToOid(h.algorithmIdentifier);if(!(p===z.oids.md2||p===z.oids.md5||p===z.oids.sha1||p===z.oids.sha224||p===z.oids.sha256||p===z.oids.sha384||p===z.oids.sha512||p===z.oids["sha512-224"]||p===z.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===z.oids.md2||p===z.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=_o(f,r,!0),c===f}});var a=W.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};W.setRsaPrivateKey=W.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=W.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:_o};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return z.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Qb},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return W.rsa.encrypt(l,c,h)},c};W.wrapRsaPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(W.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(t).getBytes())])};W.privateKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,$b,e,r)&&(t=b.fromDer(z.util.createBuffer(e.privateKey))),e={},r=[],!b.validate(t,jb,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,f,u,h;return i=z.util.createBuffer(e.privateKeyModulus).toHex(),s=z.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=z.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=z.util.createBuffer(e.privateKeyPrime1).toHex(),c=z.util.createBuffer(e.privateKeyPrime2).toHex(),f=z.util.createBuffer(e.privateKeyExponent1).toHex(),u=z.util.createBuffer(e.privateKeyExponent2).toHex(),h=z.util.createBuffer(e.privateKeyCoefficient).toHex(),W.setRsaPrivateKey(new X(i,16),new X(s,16),new X(o,16),new X(a,16),new X(c,16),new X(f,16),new X(u,16),new X(h,16))};W.privateKeyToAsn1=W.privateKeyToRSAPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.e)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.d)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.p)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.q)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.dP)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.dQ)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.qInv))])};W.publicKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,Zb,e,r)){var n=b.derToOid(e.publicKeyOid);if(n!==W.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!b.validate(t,Jb,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=z.util.createBuffer(e.publicKeyModulus).toHex(),o=z.util.createBuffer(e.publicKeyExponent).toHex();return W.setRsaPublicKey(new X(s,16),new X(o,16))};W.publicKeyToAsn1=W.publicKeyToSubjectPublicKeyInfo=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(W.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,[W.publicKeyToRSAPublicKey(t)])])};W.publicKeyToRSAPublicKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,pr(t.e))])};function $0(t,e,r){var n=z.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var f=0,u=z.random.getBytes(o),c=0;c<o;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(t),n}function _o(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=z.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var u=s.getByte();if(u!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Xb(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){z.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)!==0){t.p=null,i();return}if(t.q.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(X.ONE),t.q1=t.q.subtract(X.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(X.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function pr(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=z.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function e2(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function z0(t){return z.util.isNodejs&&typeof rc[t]=="function"}function V0(t){return typeof Rt.globalScope<"u"&&typeof Rt.globalScope.crypto=="object"&&typeof Rt.globalScope.crypto.subtle=="object"&&typeof Rt.globalScope.crypto.subtle[t]=="function"}function G0(t){return typeof Rt.globalScope<"u"&&typeof Rt.globalScope.msCrypto=="object"&&typeof Rt.globalScope.msCrypto.subtle=="object"&&typeof Rt.globalScope.msCrypto.subtle[t]=="function"}function H0(t){for(var e=z.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var ep=R((O3,X0)=>{var M=le();mo();ts();s0();Sn();ho();$u();l0();rs();D0();Ao();Ne();typeof J0>"u"&&(J0=M.jsbn.BigInteger);var J0,E=M.asn1,$=M.pki=M.pki||{};X0.exports=$.pbe=M.pbe=M.pbe||{};var Cn=$.oids,t2={name:"EncryptedPrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},r2={name:"PBES2Algorithms",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n2={name:"pkcs-12PbeParams",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"iterations"}]};$.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=M.random.getBytesSync(r.saltSize),i=r.count,s=E.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":o=16,f=16,u=Cn["aes128-CBC"],h=M.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,u=Cn["aes192-CBC"],h=M.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,u=Cn["aes256-CBC"],h=M.aes.createEncryptionCipher;break;case"des":o=8,f=8,u=Cn.desCBC,h=M.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Q0(d),g=M.pkcs5.pbkdf2(e,n,i,o,p),y=M.random.getBytesSync(f),v=h(g);v.start(y),v.update(E.toDer(t)),v.finish(),c=v.output.getBytes();var x=i2(n,s,o,d);a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Cn.pkcs5PBES2).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Cn.pkcs5PBKDF2).getBytes()),x]),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(u).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var C=new M.util.ByteBuffer(n),g=$.pbe.generatePkcs12Key(e,C,1,i,o),y=$.pbe.generatePkcs12Key(e,C,2,i,o),v=M.des.createEncryptionCipher(g);v.start(y),v.update(E.toDer(t)),v.finish(),c=v.output.getBytes(),a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Cn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,n),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var D=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[a,E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,c)]);return D};$.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!E.validate(t,t2,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=E.derToOid(n.encryptionOid),a=$.pbe.getCipher(o,n.encryptionParams,e),c=M.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=E.fromDer(a.output)),r};$.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:E.toDer(t).getBytes()};return M.pem.encode(r,{maxline:e})};$.encryptedPrivateKeyFromPem=function(t){var e=M.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return E.fromDer(e.body)};$.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=$.wrapRsaPrivateKey($.privateKeyToAsn1(t));return n=$.encryptPrivateKeyInfo(n,e,r),$.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=M.random.getBytesSync(16),a=M.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=M.random.getBytesSync(16),a=M.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=M.random.getBytesSync(16),a=M.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=M.random.getBytesSync(8),a=M.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=M.random.getBytesSync(8),a=M.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=M.pbe.opensslDeriveBytes(e,s.substr(0,8),o),u=a(f);u.start(s),u.update(E.toDer($.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:M.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return M.pem.encode(h)};$.decryptRsaPrivateKey=function(t,e){var r=null,n=M.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=M.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=M.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=M.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=M.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=M.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return M.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return M.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return M.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=M.util.hexToBytes(n.dekInfo.parameters),c=M.pbe.opensslDeriveBytes(e,a.substr(0,8),s),f=o(c);if(f.start(a),f.update(M.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=$.decryptPrivateKeyInfo(E.fromDer(r),e):r=E.fromDer(r),r!==null&&(r=$.privateKeyFromAsn1(r)),r};$.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in M.md))throw new Error('"sha1" hash algorithm unavailable.');s=M.md.sha1.create()}var c=s.digestLength,f=s.blockLength,u=new M.util.ByteBuffer,h=new M.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=e.length(),p=new M.util.ByteBuffer;p.fillWithByte(r,f);var g=f*Math.ceil(d/f),y=new M.util.ByteBuffer;for(a=0;a<g;a++)y.putByte(e.at(a%d));var v=f*Math.ceil(l/f),x=new M.util.ByteBuffer;for(a=0;a<v;a++)x.putByte(h.at(a%l));var C=y;C.putBuffer(x);for(var D=Math.ceil(i/c),w=1;w<=D;w++){var S=new M.util.ByteBuffer;S.putBytes(p.bytes()),S.putBytes(C.bytes());for(var P=0;P<n;P++)s.start(),s.update(S.getBytes()),S=s.digest();var L=new M.util.ByteBuffer;for(a=0;a<f;a++)L.putByte(S.at(a%c));var q=Math.ceil(d/f)+Math.ceil(l/f),J=new M.util.ByteBuffer;for(o=0;o<q;o++){var he=new M.util.ByteBuffer(C.getBytes(f)),Z=511;for(a=L.length()-1;a>=0;a--)Z=Z>>8,Z+=L.at(a)+he.at(a),he.setAt(a,Z&255);J.putBuffer(he)}C=J,u.putBuffer(S)}return u.truncate(u.length()-i),u};$.pbe.getCipher=function(t,e,r){switch(t){case $.oids.pkcs5PBES2:return $.pbe.getCipherForPBES2(t,e,r);case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case $.oids["pbewithSHAAnd40BitRC2-CBC"]:return $.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};$.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!E.validate(e,r2,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=E.derToOid(n.kdfOid),t!==$.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=E.derToOid(n.encOid),t!==$.oids["aes128-CBC"]&&t!==$.oids["aes192-CBC"]&&t!==$.oids["aes256-CBC"]&&t!==$.oids["des-EDE3-CBC"]&&t!==$.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=M.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch($.oids[t]){case"aes128-CBC":c=16,f=M.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=M.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=M.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=M.des.createDecryptionCipher;break;case"desCBC":c=8,f=M.des.createDecryptionCipher;break}var u=Y0(n.prfOid),h=M.pkcs5.pbkdf2(r,o,a,c,u),l=n.encIv,d=f(h);return d.start(l),d};$.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!E.validate(e,n2,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=M.util.createBuffer(n.salt),a=M.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(t){case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=M.des.startDecrypting;break;case $.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(g,y){var v=M.rc2.createDecryptionCipher(g,40);return v.start(y,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=Y0(n.prfOid),l=$.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var d=$.pbe.generatePkcs12Key(r,o,2,a,f,h);return u(l,d)};$.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in M.md))throw new Error('"md5" hash algorithm unavailable.');n=M.md.md5.create()}e===null&&(e="");for(var i=[Z0(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(Z0(n,i[o-1]+t+e));return i.join("").substr(0,r)};function Z0(t,e){return t.start().update(e).digest().getBytes()}function Y0(t){var e;if(!t)e="hmacWithSHA1";else if(e=$.oids[E.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Q0(e)}function Q0(t){var e=M.md;switch(t){case"hmacWithSHA224":e=M.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function i2(t,e,r,n){var i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,t),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,M.util.hexToBytes(r.toString(16))),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer($.oids[n]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])),i}});var cp=R((g8,up)=>{var Ee=le();Sn();Ne();var is=up.exports=Ee.sha512=Ee.sha512||{};Ee.md.sha512=Ee.md.algorithms.sha512=is;var op=Ee.sha384=Ee.sha512.sha384=Ee.sha512.sha384||{};op.create=function(){return is.create("SHA-384")};Ee.md.sha384=Ee.md.algorithms.sha384=op;Ee.sha512.sha256=Ee.sha512.sha256||{create:function(){return is.create("SHA-512/256")}};Ee.md["sha512/256"]=Ee.md.algorithms["sha512/256"]=Ee.sha512.sha256;Ee.sha512.sha224=Ee.sha512.sha224||{create:function(){return is.create("SHA-512/224")}};Ee.md["sha512/224"]=Ee.md.algorithms["sha512/224"]=Ee.sha512.sha224;is.create=function(t){if(ap||c2(),typeof t>"u"&&(t="SHA-512"),!(t in In))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=In[t],r=null,n=Ee.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=Ee.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=Ee.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),sp(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=Ee.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(ic.substr(0,a.blockLength-u));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,c.putInt32(d>>>0),d=h>>>0;c.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);sp(g,i,c);var y=Ee.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)y.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&y.putInt32(g[p][1]);return y},a};var ic=null,ap=!1,sc=null,In=null;function c2(){ic=String.fromCharCode(128),ic+=Ee.util.fillString(String.fromCharCode(0),128),sc=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],In={},In["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],In["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],In["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],In["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ap=!0}function sp(t,e,r){for(var n,i,s,o,a,c,f,u,h,l,d,p,g,y,v,x,C,D,w,S,P,L,q,J,he,Z,qr,Ze,_e,Xe,V,Mi,Ni,ut,Vn,Gn=r.length();Gn>=128;){for(_e=0;_e<16;++_e)e[_e][0]=r.getInt32()>>>0,e[_e][1]=r.getInt32()>>>0;for(;_e<80;++_e)Mi=e[_e-2],Xe=Mi[0],V=Mi[1],n=((Xe>>>19|V<<13)^(V>>>29|Xe<<3)^Xe>>>6)>>>0,i=((Xe<<13|V>>>19)^(V<<3|Xe>>>29)^(Xe<<26|V>>>6))>>>0,ut=e[_e-15],Xe=ut[0],V=ut[1],s=((Xe>>>1|V<<31)^(Xe>>>8|V<<24)^Xe>>>7)>>>0,o=((Xe<<31|V>>>1)^(Xe<<24|V>>>8)^(Xe<<25|V>>>7))>>>0,Ni=e[_e-7],Vn=e[_e-16],V=i+Ni[1]+o+Vn[1],e[_e][0]=n+Ni[0]+s+Vn[0]+(V/4294967296>>>0)>>>0,e[_e][1]=V>>>0;for(g=t[0][0],y=t[0][1],v=t[1][0],x=t[1][1],C=t[2][0],D=t[2][1],w=t[3][0],S=t[3][1],P=t[4][0],L=t[4][1],q=t[5][0],J=t[5][1],he=t[6][0],Z=t[6][1],qr=t[7][0],Ze=t[7][1],_e=0;_e<80;++_e)f=((P>>>14|L<<18)^(P>>>18|L<<14)^(L>>>9|P<<23))>>>0,u=((P<<18|L>>>14)^(P<<14|L>>>18)^(L<<23|P>>>9))>>>0,h=(he^P&(q^he))>>>0,l=(Z^L&(J^Z))>>>0,a=((g>>>28|y<<4)^(y>>>2|g<<30)^(y>>>7|g<<25))>>>0,c=((g<<4|y>>>28)^(y<<30|g>>>2)^(y<<25|g>>>7))>>>0,d=(g&v|C&(g^v))>>>0,p=(y&x|D&(y^x))>>>0,V=Ze+u+l+sc[_e][1]+e[_e][1],n=qr+f+h+sc[_e][0]+e[_e][0]+(V/4294967296>>>0)>>>0,i=V>>>0,V=c+p,s=a+d+(V/4294967296>>>0)>>>0,o=V>>>0,qr=he,Ze=Z,he=q,Z=J,q=P,J=L,V=S+i,P=w+n+(V/4294967296>>>0)>>>0,L=V>>>0,w=C,S=D,C=v,D=x,v=g,x=y,V=i+o,g=n+s+(V/4294967296>>>0)>>>0,y=V>>>0;V=t[0][1]+y,t[0][0]=t[0][0]+g+(V/4294967296>>>0)>>>0,t[0][1]=V>>>0,V=t[1][1]+x,t[1][0]=t[1][0]+v+(V/4294967296>>>0)>>>0,t[1][1]=V>>>0,V=t[2][1]+D,t[2][0]=t[2][0]+C+(V/4294967296>>>0)>>>0,t[2][1]=V>>>0,V=t[3][1]+S,t[3][0]=t[3][0]+w+(V/4294967296>>>0)>>>0,t[3][1]=V>>>0,V=t[4][1]+L,t[4][0]=t[4][0]+P+(V/4294967296>>>0)>>>0,t[4][1]=V>>>0,V=t[5][1]+J,t[5][0]=t[5][0]+q+(V/4294967296>>>0)>>>0,t[5][1]=V>>>0,V=t[6][1]+Z,t[6][0]=t[6][0]+he+(V/4294967296>>>0)>>>0,t[6][1]=V>>>0,V=t[7][1]+Ze,t[7][0]=t[7][0]+qr+(V/4294967296>>>0)>>>0,t[7][1]=V>>>0,Gn-=128}}});var Sd=R((zD,xd)=>{xd.exports=Mc;var wd=128,ww=127,xw=~ww,Sw=Math.pow(2,31);function Mc(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Mc.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=Sw;)e[r++]=t&255|wd,t/=128;for(;t&xw;)e[r++]=t&255|wd,t>>>=7;return e[r]=t|0,Mc.bytes=r-n+1,e}});var Cd=R((VD,Dd)=>{Dd.exports=Nc;var Ew=128,Ed=127;function Nc(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a||i>49)throw Nc.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Ed)<<i:(o&Ed)*Math.pow(2,i),i+=7}while(o>=Ew);return Nc.bytes=s-n,r}});var _d=R((GD,Id)=>{var Dw=Math.pow(2,7),Cw=Math.pow(2,14),Iw=Math.pow(2,21),_w=Math.pow(2,28),Aw=Math.pow(2,35),Tw=Math.pow(2,42),Bw=Math.pow(2,49),Rw=Math.pow(2,56),Pw=Math.pow(2,63);Id.exports=function(t){return t<Dw?1:t<Cw?2:t<Iw?3:t<_w?4:t<Aw?5:t<Tw?6:t<Bw?7:t<Rw?8:t<Pw?9:10}});var Vo=R((HD,Ad)=>{Ad.exports={encode:Sd(),decode:Cd(),encodingLength:_d()}});var Gd=R((E4,Vd)=>{var Ei=1e3,Di=Ei*60,Ci=Di*60,On=Ci*24,Jw=On*7,Zw=On*365.25;Vd.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Yw(t);if(r==="number"&&isFinite(t))return e.long?Xw(t):Qw(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Yw(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Zw;case"weeks":case"week":case"w":return r*Jw;case"days":case"day":case"d":return r*On;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ci;case"minutes":case"minute":case"mins":case"min":case"m":return r*Di;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ei;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Qw(t){var e=Math.abs(t);return e>=On?Math.round(t/On)+"d":e>=Ci?Math.round(t/Ci)+"h":e>=Di?Math.round(t/Di)+"m":e>=Ei?Math.round(t/Ei)+"s":t+"ms"}function Xw(t){var e=Math.abs(t);return e>=On?jo(t,e,On,"day"):e>=Ci?jo(t,e,Ci,"hour"):e>=Di?jo(t,e,Di,"minute"):e>=Ei?jo(t,e,Ei,"second"):t+" ms"}function jo(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var Wd=R((D4,Hd)=>{function ex(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=Gd(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,d,p;function g(...y){if(!g.enabled)return;let v=g,x=Number(new Date),C=x-(h||x);v.diff=C,v.prev=h,v.curr=x,h=x,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let D=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(S,P)=>{if(S==="%%")return"%";D++;let L=r.formatters[P];if(typeof L=="function"){let q=y[D];S=L.call(v,q),y.splice(D,1),D--}return S}),r.formatArgs.call(v,y),(v.log||r.log).apply(v,y)}return g.namespace=u,g.useColors=r.useColors(),g.color=r.selectColor(u),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:y=>{l=y}}),typeof r.init=="function"&&r.init(g),g}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)!l[h]||(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Hd.exports=ex});var $d=R((Et,Jo)=>{Et.formatArgs=rx;Et.save=nx;Et.load=ix;Et.useColors=tx;Et.storage=sx();Et.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Et.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function tx(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function rx(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Jo.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Et.log=console.debug||console.log||(()=>{});function nx(t){try{t?Et.storage.setItem("debug",t):Et.storage.removeItem("debug")}catch{}}function ix(){let t;try{t=Et.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function sx(){try{return localStorage}catch{}}Jo.exports=Wd()(Et);var{formatters:ox}=Jo.exports;ox.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Yd=R((O4,Zd)=>{"use strict";Zd.exports=Je;var Es=fn();function Je(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ln=Je.zero=new Je(0,0);Ln.toNumber=function(){return 0};Ln.zzEncode=Ln.zzDecode=function(){return this};Ln.length=function(){return 1};var ax=Je.zeroHash="\0\0\0\0\0\0\0\0";Je.fromNumber=function(e){if(e===0)return Ln;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Je(n,i)};Je.from=function(e){if(typeof e=="number")return Je.fromNumber(e);if(Es.isString(e))if(Es.Long)e=Es.Long.fromString(e);else return Je.fromNumber(parseInt(e,10));return e.low||e.high?new Je(e.low>>>0,e.high>>>0):Ln};Je.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Je.prototype.toLong=function(e){return Es.Long?new Es.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var cn=String.prototype.charCodeAt;Je.fromHash=function(e){return e===ax?Ln:new Je((cn.call(e,0)|cn.call(e,1)<<8|cn.call(e,2)<<16|cn.call(e,3)<<24)>>>0,(cn.call(e,4)|cn.call(e,5)<<8|cn.call(e,6)<<16|cn.call(e,7)<<24)>>>0)};Je.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Je.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Je.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Je.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var fn=R(Wc=>{"use strict";var U=Wc;U.asPromise=Ls();U.base64=Ma();U.EventEmitter=Na();U.float=La();U.inquire=qs();U.utf8=Ua();U.pool=qa();U.LongBits=Yd();U.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);U.global=U.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Wc;U.emptyArray=Object.freeze?Object.freeze([]):[];U.emptyObject=Object.freeze?Object.freeze({}):{};U.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};U.isString=function(e){return typeof e=="string"||e instanceof String};U.isObject=function(e){return e&&typeof e=="object"};U.isset=U.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};U.Buffer=function(){try{var t=U.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();U._Buffer_from=null;U._Buffer_allocUnsafe=null;U.newBuffer=function(e){return typeof e=="number"?U.Buffer?U._Buffer_allocUnsafe(e):new U.Array(e):U.Buffer?U._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};U.Array=typeof Uint8Array<"u"?Uint8Array:Array;U.Long=U.global.dcodeIO&&U.global.dcodeIO.Long||U.global.Long||U.inquire("long");U.key2Re=/^true|false|0|1$/;U.key32Re=/^-?(?:0|[1-9][0-9]*)$/;U.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;U.longToHash=function(e){return e?U.LongBits.from(e).toHash():U.LongBits.zeroHash};U.longFromHash=function(e,r){var n=U.LongBits.fromHash(e);return U.Long?U.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Qd(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}U.merge=Qd;U.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Xd(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Qd(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}U.newError=Xd;U.ProtocolError=Xd("ProtocolError");U.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};U.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};U.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};U._configure=function(){var t=U.Buffer;if(!t){U._Buffer_from=U._Buffer_allocUnsafe=null;return}U._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},U._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Xc=R((N4,ng)=>{"use strict";ng.exports=se;var Mt=fn(),$c,Xo=Mt.LongBits,eg=Mt.base64,tg=Mt.utf8;function Ds(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Jc(){}function ux(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function se(){this.len=0,this.head=new Ds(Jc,0,0),this.tail=this.head,this.states=null}var rg=function(){return Mt.Buffer?function(){return(se.create=function(){return new $c})()}:function(){return new se}};se.create=rg();se.alloc=function(e){return new Mt.Array(e)};Mt.Array!==Array&&(se.alloc=Mt.pool(se.alloc,Mt.Array.prototype.subarray));se.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Ds(e,r,n),this.len+=r,this};function Zc(t,e,r){e[r]=t&255}function cx(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Yc(t,e){this.len=t,this.next=void 0,this.val=e}Yc.prototype=Object.create(Ds.prototype);Yc.prototype.fn=cx;se.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Yc((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};se.prototype.int32=function(e){return e<0?this._push(Qc,10,Xo.fromNumber(e)):this.uint32(e)};se.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Qc(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}se.prototype.uint64=function(e){var r=Xo.from(e);return this._push(Qc,r.length(),r)};se.prototype.int64=se.prototype.uint64;se.prototype.sint64=function(e){var r=Xo.from(e).zzEncode();return this._push(Qc,r.length(),r)};se.prototype.bool=function(e){return this._push(Zc,1,e?1:0)};function jc(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}se.prototype.fixed32=function(e){return this._push(jc,4,e>>>0)};se.prototype.sfixed32=se.prototype.fixed32;se.prototype.fixed64=function(e){var r=Xo.from(e);return this._push(jc,4,r.lo)._push(jc,4,r.hi)};se.prototype.sfixed64=se.prototype.fixed64;se.prototype.float=function(e){return this._push(Mt.float.writeFloatLE,4,e)};se.prototype.double=function(e){return this._push(Mt.float.writeDoubleLE,8,e)};var fx=Mt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};se.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Zc,1,0);if(Mt.isString(e)){var n=se.alloc(r=eg.length(e));eg.decode(e,n,0),e=n}return this.uint32(r)._push(fx,r,e)};se.prototype.string=function(e){var r=tg.length(e);return r?this.uint32(r)._push(tg.write,r,e):this._push(Zc,1,0)};se.prototype.fork=function(){return this.states=new ux(this),this.head=this.tail=new Ds(Jc,0,0),this.len=0,this};se.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ds(Jc,0,0),this.len=0),this};se.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};se.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};se._configure=function(t){$c=t,se.create=rg(),$c._configure()}});var og=R((L4,sg)=>{"use strict";sg.exports=vr;var ig=Xc();(vr.prototype=Object.create(ig.prototype)).constructor=vr;var hn=fn();function vr(){ig.call(this)}vr._configure=function(){vr.alloc=hn._Buffer_allocUnsafe,vr.writeBytesBuffer=hn.Buffer&&hn.Buffer.prototype instanceof Uint8Array&&hn.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};vr.prototype.bytes=function(e){hn.isString(e)&&(e=hn._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(vr.writeBytesBuffer,r,e),this};function hx(t,e,r){t.length<40?hn.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}vr.prototype.string=function(e){var r=hn.Buffer.byteLength(e);return this.uint32(r),r&&this._push(hx,r,e),this};vr._configure()});var rf=R((F4,hg)=>{"use strict";hg.exports=Ue;var br=fn(),tf,cg=br.LongBits,lx=br.utf8;function Zt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Ue(t){this.buf=t,this.pos=0,this.len=t.length}var ag=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ue(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ue(e);throw Error("illegal buffer")},fg=function(){return br.Buffer?function(r){return(Ue.create=function(i){return br.Buffer.isBuffer(i)?new tf(i):ag(i)})(r)}:ag};Ue.create=fg();Ue.prototype._slice=br.Array.prototype.subarray||br.Array.prototype.slice;Ue.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Zt(this,10);return e}}();Ue.prototype.int32=function(){return this.uint32()|0};Ue.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ef(){var t=new cg(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Zt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Zt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Ue.prototype.bool=function(){return this.uint32()!==0};function ea(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Ue.prototype.fixed32=function(){if(this.pos+4>this.len)throw Zt(this,4);return ea(this.buf,this.pos+=4)};Ue.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Zt(this,4);return ea(this.buf,this.pos+=4)|0};function ug(){if(this.pos+8>this.len)throw Zt(this,8);return new cg(ea(this.buf,this.pos+=4),ea(this.buf,this.pos+=4))}Ue.prototype.float=function(){if(this.pos+4>this.len)throw Zt(this,4);var e=br.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ue.prototype.double=function(){if(this.pos+8>this.len)throw Zt(this,4);var e=br.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ue.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Zt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Ue.prototype.string=function(){var e=this.bytes();return lx.read(e,0,e.length)};Ue.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Zt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Zt(this);while(this.buf[this.pos++]&128);return this};Ue.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Ue._configure=function(t){tf=t,Ue.create=fg(),tf._configure();var e=br.Long?"toLong":"toNumber";br.merge(Ue.prototype,{int64:function(){return ef.call(this)[e](!1)},uint64:function(){return ef.call(this)[e](!0)},sint64:function(){return ef.call(this).zzDecode()[e](!1)},fixed64:function(){return ug.call(this)[e](!0)},sfixed64:function(){return ug.call(this)[e](!1)}})}});var gg=R((U4,dg)=>{"use strict";dg.exports=Fn;var pg=rf();(Fn.prototype=Object.create(pg.prototype)).constructor=Fn;var lg=fn();function Fn(t){pg.call(this,t)}Fn._configure=function(){lg.Buffer&&(Fn.prototype._slice=lg.Buffer.prototype.slice)};Fn.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Fn._configure()});var mg=R((q4,yg)=>{"use strict";yg.exports=Cs;var nf=fn();(Cs.prototype=Object.create(nf.EventEmitter.prototype)).constructor=Cs;function Cs(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");nf.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Cs.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return nf.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,f){if(c)return o.emit("error",c,e),s(c);if(f===null){o.end(!0);return}if(!(f instanceof n))try{f=n[o.responseDelimited?"decodeDelimited":"decode"](f)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",f,e),s(null,f)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Cs.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var bg=R(vg=>{"use strict";var px=vg;px.Service=mg()});var xg=R((z4,wg)=>{"use strict";wg.exports={}});var Dg=R(Eg=>{"use strict";var gt=Eg;gt.build="minimal";gt.Writer=Xc();gt.BufferWriter=og();gt.Reader=rf();gt.BufferReader=gg();gt.util=fn();gt.rpc=bg();gt.roots=xg();gt.configure=Sg;function Sg(){gt.util._configure(),gt.Writer._configure(gt.BufferWriter),gt.Reader._configure(gt.BufferReader)}Sg()});var Ig=R((G4,Cg)=>{"use strict";Cg.exports=Dg()});var Ag=R((_g,Is)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof hf=="function"&&typeof Is=="object"&&Is&&Is.exports&&(Is.exports=e(Ig()))})(_g,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots.default||(t.roots.default={});return i.RPC=function(){function s(a){if(this.subscriptions=[],this.messages=[],a)for(var c=Object.keys(a),f=0;f<c.length;++f)a[c[f]]!=null&&(this[c[f]]=a[c[f]])}s.prototype.subscriptions=n.emptyArray,s.prototype.messages=n.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(c,f){if(f||(f=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var u=0;u<c.subscriptions.length;++u)i.RPC.SubOpts.encode(c.subscriptions[u],f.uint32(10).fork()).ldelim();if(c.messages!=null&&c.messages.length)for(var u=0;u<c.messages.length;++u)i.RPC.Message.encode(c.messages[u],f.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&i.RPC.ControlMessage.encode(c.control,f.uint32(26).fork()).ldelim(),f},s.decode=function(c,f){c instanceof e||(c=e.create(c));for(var u=f===void 0?c.len:c.pos+f,h=new i.RPC;c.pos<u;){var l=c.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(i.RPC.SubOpts.decode(c,c.uint32()));break;case 2:h.messages&&h.messages.length||(h.messages=[]),h.messages.push(i.RPC.Message.decode(c,c.uint32()));break;case 3:h.control=i.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(l&7);break}}return h},s.fromObject=function(c){if(c instanceof i.RPC)return c;var f=new i.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");f.subscriptions=[];for(var u=0;u<c.subscriptions.length;++u){if(typeof c.subscriptions[u]!="object")throw TypeError(".RPC.subscriptions: object expected");f.subscriptions[u]=i.RPC.SubOpts.fromObject(c.subscriptions[u])}}if(c.messages){if(!Array.isArray(c.messages))throw TypeError(".RPC.messages: array expected");f.messages=[];for(var u=0;u<c.messages.length;++u){if(typeof c.messages[u]!="object")throw TypeError(".RPC.messages: object expected");f.messages[u]=i.RPC.Message.fromObject(c.messages[u])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");f.control=i.RPC.ControlMessage.fromObject(c.control)}return f},s.toObject=function(c,f){f||(f={});var u={};if((f.arrays||f.defaults)&&(u.subscriptions=[],u.messages=[]),c.subscriptions&&c.subscriptions.length){u.subscriptions=[];for(var h=0;h<c.subscriptions.length;++h)u.subscriptions[h]=i.RPC.SubOpts.toObject(c.subscriptions[h],f)}if(c.messages&&c.messages.length){u.messages=[];for(var h=0;h<c.messages.length;++h)u.messages[h]=i.RPC.Message.toObject(c.messages[h],f)}return c.control!=null&&c.hasOwnProperty("control")&&(u.control=i.RPC.ControlMessage.toObject(c.control,f),f.oneofs&&(u._control="control")),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.subscribe=null,a.prototype.topic=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(c=["subscribe"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(c=["topic"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.subscribe!=null&&Object.hasOwnProperty.call(u,"subscribe")&&h.uint32(8).bool(u.subscribe),u.topic!=null&&Object.hasOwnProperty.call(u,"topic")&&h.uint32(18).string(u.topic),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.SubOpts;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.subscribe=u.bool();break;case 2:d.topic=u.string();break;default:u.skipType(p&7);break}}return d},a.fromObject=function(u){if(u instanceof i.RPC.SubOpts)return u;var h=new i.RPC.SubOpts;return u.subscribe!=null&&(h.subscribe=Boolean(u.subscribe)),u.topic!=null&&(h.topic=String(u.topic)),h},a.toObject=function(u,h){h||(h={});var l={};return u.subscribe!=null&&u.hasOwnProperty("subscribe")&&(l.subscribe=u.subscribe,h.oneofs&&(l._subscribe="subscribe")),u.topic!=null&&u.hasOwnProperty("topic")&&(l.topic=u.topic,h.oneofs&&(l._topic="topic")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(c=["from"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(c=["data"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(c=["seqno"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(c=["signature"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(c=["key"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.from!=null&&Object.hasOwnProperty.call(u,"from")&&h.uint32(10).bytes(u.from),u.data!=null&&Object.hasOwnProperty.call(u,"data")&&h.uint32(18).bytes(u.data),u.seqno!=null&&Object.hasOwnProperty.call(u,"seqno")&&h.uint32(26).bytes(u.seqno),h.uint32(34).string(u.topic),u.signature!=null&&Object.hasOwnProperty.call(u,"signature")&&h.uint32(42).bytes(u.signature),u.key!=null&&Object.hasOwnProperty.call(u,"key")&&h.uint32(50).bytes(u.key),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.Message;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.from=u.bytes();break;case 2:d.data=u.bytes();break;case 3:d.seqno=u.bytes();break;case 4:d.topic=u.string();break;case 5:d.signature=u.bytes();break;case 6:d.key=u.bytes();break;default:u.skipType(p&7);break}}if(!d.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:d});return d},a.fromObject=function(u){if(u instanceof i.RPC.Message)return u;var h=new i.RPC.Message;return u.from!=null&&(typeof u.from=="string"?n.base64.decode(u.from,h.from=n.newBuffer(n.base64.length(u.from)),0):u.from.length&&(h.from=u.from)),u.data!=null&&(typeof u.data=="string"?n.base64.decode(u.data,h.data=n.newBuffer(n.base64.length(u.data)),0):u.data.length&&(h.data=u.data)),u.seqno!=null&&(typeof u.seqno=="string"?n.base64.decode(u.seqno,h.seqno=n.newBuffer(n.base64.length(u.seqno)),0):u.seqno.length&&(h.seqno=u.seqno)),u.topic!=null&&(h.topic=String(u.topic)),u.signature!=null&&(typeof u.signature=="string"?n.base64.decode(u.signature,h.signature=n.newBuffer(n.base64.length(u.signature)),0):u.signature.length&&(h.signature=u.signature)),u.key!=null&&(typeof u.key=="string"?n.base64.decode(u.key,h.key=n.newBuffer(n.base64.length(u.key)),0):u.key.length&&(h.key=u.key)),h},a.toObject=function(u,h){h||(h={});var l={};return h.defaults&&(l.topic=""),u.from!=null&&u.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(u.from,0,u.from.length):h.bytes===Array?Array.prototype.slice.call(u.from):u.from,h.oneofs&&(l._from="from")),u.data!=null&&u.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(u.data,0,u.data.length):h.bytes===Array?Array.prototype.slice.call(u.data):u.data,h.oneofs&&(l._data="data")),u.seqno!=null&&u.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(u.seqno,0,u.seqno.length):h.bytes===Array?Array.prototype.slice.call(u.seqno):u.seqno,h.oneofs&&(l._seqno="seqno")),u.topic!=null&&u.hasOwnProperty("topic")&&(l.topic=u.topic),u.signature!=null&&u.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(u.signature,0,u.signature.length):h.bytes===Array?Array.prototype.slice.call(u.signature):u.signature,h.oneofs&&(l._signature="signature")),u.key!=null&&u.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(u.key,0,u.key.length):h.bytes===Array?Array.prototype.slice.call(u.key):u.key,h.oneofs&&(l._key="key")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(f,u){if(u||(u=r.create()),f.ihave!=null&&f.ihave.length)for(var h=0;h<f.ihave.length;++h)i.RPC.ControlIHave.encode(f.ihave[h],u.uint32(10).fork()).ldelim();if(f.iwant!=null&&f.iwant.length)for(var h=0;h<f.iwant.length;++h)i.RPC.ControlIWant.encode(f.iwant[h],u.uint32(18).fork()).ldelim();if(f.graft!=null&&f.graft.length)for(var h=0;h<f.graft.length;++h)i.RPC.ControlGraft.encode(f.graft[h],u.uint32(26).fork()).ldelim();if(f.prune!=null&&f.prune.length)for(var h=0;h<f.prune.length;++h)i.RPC.ControlPrune.encode(f.prune[h],u.uint32(34).fork()).ldelim();return u},a.decode=function(f,u){f instanceof e||(f=e.create(f));for(var h=u===void 0?f.len:f.pos+u,l=new i.RPC.ControlMessage;f.pos<h;){var d=f.uint32();switch(d>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(i.RPC.ControlIHave.decode(f,f.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(i.RPC.ControlIWant.decode(f,f.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(i.RPC.ControlGraft.decode(f,f.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(i.RPC.ControlPrune.decode(f,f.uint32()));break;default:f.skipType(d&7);break}}return l},a.fromObject=function(f){if(f instanceof i.RPC.ControlMessage)return f;var u=new i.RPC.ControlMessage;if(f.ihave){if(!Array.isArray(f.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");u.ihave=[];for(var h=0;h<f.ihave.length;++h){if(typeof f.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");u.ihave[h]=i.RPC.ControlIHave.fromObject(f.ihave[h])}}if(f.iwant){if(!Array.isArray(f.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");u.iwant=[];for(var h=0;h<f.iwant.length;++h){if(typeof f.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");u.iwant[h]=i.RPC.ControlIWant.fromObject(f.iwant[h])}}if(f.graft){if(!Array.isArray(f.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");u.graft=[];for(var h=0;h<f.graft.length;++h){if(typeof f.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");u.graft[h]=i.RPC.ControlGraft.fromObject(f.graft[h])}}if(f.prune){if(!Array.isArray(f.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");u.prune=[];for(var h=0;h<f.prune.length;++h){if(typeof f.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");u.prune[h]=i.RPC.ControlPrune.fromObject(f.prune[h])}}return u},a.toObject=function(f,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),f.ihave&&f.ihave.length){h.ihave=[];for(var l=0;l<f.ihave.length;++l)h.ihave[l]=i.RPC.ControlIHave.toObject(f.ihave[l],u)}if(f.iwant&&f.iwant.length){h.iwant=[];for(var l=0;l<f.iwant.length;++l)h.iwant[l]=i.RPC.ControlIWant.toObject(f.iwant[l],u)}if(f.graft&&f.graft.length){h.graft=[];for(var l=0;l<f.graft.length;++l)h.graft[l]=i.RPC.ControlGraft.toObject(f.graft[l],u)}if(f.prune&&f.prune.length){h.prune=[];for(var l=0;l<f.prune.length;++l)h.prune[l]=i.RPC.ControlPrune.toObject(f.prune[l],u)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.messageIDs!=null&&u.messageIDs.length)for(var l=0;l<u.messageIDs.length;++l)h.uint32(18).bytes(u.messageIDs[l]);return h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.ControlIHave;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.topicID=u.string();break;case 2:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return d},a.fromObject=function(u){if(u instanceof i.RPC.ControlIHave)return u;var h=new i.RPC.ControlIHave;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)typeof u.messageIDs[l]=="string"?n.base64.decode(u.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(u.messageIDs[l])),0):u.messageIDs[l].length&&(h.messageIDs[l]=u.messageIDs[l])}return h},a.toObject=function(u,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),u.messageIDs&&u.messageIDs.length){l.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)l.messageIDs[d]=h.bytes===String?n.base64.encode(u.messageIDs[d],0,u.messageIDs[d].length):h.bytes===Array?Array.prototype.slice.call(u.messageIDs[d]):u.messageIDs[d]}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(f,u){if(u||(u=r.create()),f.messageIDs!=null&&f.messageIDs.length)for(var h=0;h<f.messageIDs.length;++h)u.uint32(10).bytes(f.messageIDs[h]);return u},a.decode=function(f,u){f instanceof e||(f=e.create(f));for(var h=u===void 0?f.len:f.pos+u,l=new i.RPC.ControlIWant;f.pos<h;){var d=f.uint32();switch(d>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(f.bytes());break;default:f.skipType(d&7);break}}return l},a.fromObject=function(f){if(f instanceof i.RPC.ControlIWant)return f;var u=new i.RPC.ControlIWant;if(f.messageIDs){if(!Array.isArray(f.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");u.messageIDs=[];for(var h=0;h<f.messageIDs.length;++h)typeof f.messageIDs[h]=="string"?n.base64.decode(f.messageIDs[h],u.messageIDs[h]=n.newBuffer(n.base64.length(f.messageIDs[h])),0):f.messageIDs[h].length&&(u.messageIDs[h]=f.messageIDs[h])}return u},a.toObject=function(f,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.messageIDs=[]),f.messageIDs&&f.messageIDs.length){h.messageIDs=[];for(var l=0;l<f.messageIDs.length;++l)h.messageIDs[l]=u.bytes===String?n.base64.encode(f.messageIDs[l],0,f.messageIDs[l].length):u.bytes===Array?Array.prototype.slice.call(f.messageIDs[l]):f.messageIDs[l]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.ControlGraft;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.topicID=u.string();break;default:u.skipType(p&7);break}}return d},a.fromObject=function(u){if(u instanceof i.RPC.ControlGraft)return u;var h=new i.RPC.ControlGraft;return u.topicID!=null&&(h.topicID=String(u.topicID)),h},a.toObject=function(u,h){h||(h={});var l={};return u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(f){if(this.peers=[],f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(c=["backoff"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.peers!=null&&u.peers.length)for(var l=0;l<u.peers.length;++l)i.RPC.PeerInfo.encode(u.peers[l],h.uint32(18).fork()).ldelim();return u.backoff!=null&&Object.hasOwnProperty.call(u,"backoff")&&h.uint32(24).uint64(u.backoff),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.ControlPrune;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.topicID=u.string();break;case 2:d.peers&&d.peers.length||(d.peers=[]),d.peers.push(i.RPC.PeerInfo.decode(u,u.uint32()));break;case 3:d.backoff=u.uint64();break;default:u.skipType(p&7);break}}return d},a.fromObject=function(u){if(u instanceof i.RPC.ControlPrune)return u;var h=new i.RPC.ControlPrune;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.peers){if(!Array.isArray(u.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<u.peers.length;++l){if(typeof u.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=i.RPC.PeerInfo.fromObject(u.peers[l])}}return u.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(u.backoff)).unsigned=!0:typeof u.backoff=="string"?h.backoff=parseInt(u.backoff,10):typeof u.backoff=="number"?h.backoff=u.backoff:typeof u.backoff=="object"&&(h.backoff=new n.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(u,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),u.peers&&u.peers.length){l.peers=[];for(var d=0;d<u.peers.length;++d)l.peers[d]=i.RPC.PeerInfo.toObject(u.peers[d],h)}return u.backoff!=null&&u.hasOwnProperty("backoff")&&(typeof u.backoff=="number"?l.backoff=h.longs===String?String(u.backoff):u.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(u.backoff):h.longs===Number?new n.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0):u.backoff,h.oneofs&&(l._backoff="backoff")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(c=["peerID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(c=["signedPeerRecord"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.peerID!=null&&Object.hasOwnProperty.call(u,"peerID")&&h.uint32(10).bytes(u.peerID),u.signedPeerRecord!=null&&Object.hasOwnProperty.call(u,"signedPeerRecord")&&h.uint32(18).bytes(u.signedPeerRecord),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,d=new i.RPC.PeerInfo;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:d.peerID=u.bytes();break;case 2:d.signedPeerRecord=u.bytes();break;default:u.skipType(p&7);break}}return d},a.fromObject=function(u){if(u instanceof i.RPC.PeerInfo)return u;var h=new i.RPC.PeerInfo;return u.peerID!=null&&(typeof u.peerID=="string"?n.base64.decode(u.peerID,h.peerID=n.newBuffer(n.base64.length(u.peerID)),0):u.peerID.length&&(h.peerID=u.peerID)),u.signedPeerRecord!=null&&(typeof u.signedPeerRecord=="string"?n.base64.decode(u.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(u.signedPeerRecord)),0):u.signedPeerRecord.length&&(h.signedPeerRecord=u.signedPeerRecord)),h},a.toObject=function(u,h){h||(h={});var l={};return u.peerID!=null&&u.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(u.peerID,0,u.peerID.length):h.bytes===Array?Array.prototype.slice.call(u.peerID):u.peerID,h.oneofs&&(l._peerID="peerID")),u.signedPeerRecord!=null&&u.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(u.signedPeerRecord,0,u.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(u.signedPeerRecord):u.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),i})});var Ug=R((dC,Fg)=>{"use strict";function Be(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}Be.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};Be.prototype.get=function(e){return this.peekAt(e)};Be.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Be.prototype.peekFront=function(){return this.peek()};Be.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Be.prototype,"length",{get:function(){return this.size()}});Be.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Be.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};Be.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return s}}};Be.prototype.remove=function(e,r){var n=e,i,s=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=o)return i=this.toArray(),this.clear(),i;n+r>o&&(r=o-n);var c;for(i=new Array(r),c=0;c<r;c++)i[c]=this._list[this._head+n+c&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;s>0;)this._list[n=n-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),i}}};Be.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var s,o,a,c=arguments.length,f=this._list.length,u=2;if(!i||n<i/2){for(o=new Array(n),s=0;s<n;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+f&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+f&this._capacityMask);c>u;)this.unshift(arguments[--c]);for(s=n;s>0;s--)this.unshift(o[s-1])}else{o=new Array(i-(n+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+n+r+s&this._capacityMask];for(r===0?(a=[],n!=i&&(this._tail=this._head+n+f&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+f&this._capacityMask);u<c;)this.push(arguments[u++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(n,r)}};Be.prototype.clear=function(){this._head=0,this._tail=0};Be.prototype.isEmpty=function(){return this._head===this._tail};Be.prototype.toArray=function(){return this._copyArray(!1)};Be.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};Be.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,s;if(e||this._head>this._tail){for(s=this._head;s<i;s++)r.push(n[s]);for(s=0;s<this._tail;s++)r.push(n[s])}else for(s=this._head;s<this._tail;s++)r.push(n[s]);return r};Be.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Be.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Fg.exports=Be});var aS={};Qe(aS,{GossipSub:()=>fa,multicodec:()=>oS});var Ps=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Hn=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ps(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new Ps(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function pn(t={}){return fy(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function fy(t,e){e=e??{};let r=e.onEnd,n=new Hn,i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((g,y)=>{s=v=>{s=null,n.push(v);try{g(t(n))}catch(x){y(x)}return i}}):t(n),c=g=>s!=null?s(g):(n.push(g),i),f=g=>(n=new Hn,s!=null?s({error:g}):(n.push({error:g}),i)),u=g=>{if(o)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},h=g=>o?i:(o=!0,g!=null?f(g):c({done:!0})),l=()=>(n=new Hn,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:u,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:u,end(g){return p.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return p.readableLength}},i}var Sf=H(xf(),1),py=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},Ef=t=>t!=null&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),da=t=>t!=null&&typeof t.sink=="function"&&Ef(t.source),dy=t=>e=>{let r=t.sink(e);if(r.then!=null){let n=pn({objectMode:!0});return r.then(()=>{n.end()},s=>{n.end(s)}),(0,Sf.default)(n,async function*(){yield*t.source,n.end()}())}return t.source};function Wn(t,...e){if(da(t)){let n=t;t=()=>n.source}else if(Ef(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&da(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)da(r[n])&&(r[n]=dy(r[n]));return py(...r)}var pd=H(Re(),1);var ba={};Qe(ba,{identity:()=>xy});function yy(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,y=0,v=0,x=p.length;v!==x&&p[v]===0;)v++,g++;for(var C=(x-v)*u+1>>>0,D=new Uint8Array(C);v!==x;){for(var w=p[v],S=0,P=C-1;(w!==0||S<y)&&P!==-1;P--,S++)w+=256*D[P]>>>0,D[P]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=S,v++}for(var L=C-y;L!==C&&D[L]===0;)L++;for(var q=c.repeat(g);L<C;++L)q+=t.charAt(D[L]);return q}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var y=0,v=0;p[g]===c;)y++,g++;for(var x=(p.length-g)*f+1>>>0,C=new Uint8Array(x);p[g];){var D=r[p.charCodeAt(g)];if(D===255)return;for(var w=0,S=x-1;(D!==0||w<v)&&S!==-1;S--,w++)D+=a*C[S]>>>0,C[S]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");v=w,g++}if(p[g]!==" "){for(var P=x-v;P!==x&&C[P]===0;)P++;for(var L=new Uint8Array(y+(x-P)),q=y;P!==x;)L[q++]=C[P++];return L}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var my=yy,vy=my,If=vy;var ES=new Uint8Array(0);var _f=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Er=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Af=t=>new TextEncoder().encode(t),Tf=t=>new TextDecoder().decode(t);var ga=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ya=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Rf(this,e)}},ma=class{constructor(e){this.decoders=e}or(e){return Rf(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Rf=(t,e)=>new ma({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),va=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ga(e,r,n),this.decoder=new ya(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},$n=({name:t,prefix:e,encode:r,decode:n})=>new va(t,e,r,n),zr=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=If(r,e);return $n({prefix:t,name:e,encode:n,decode:s=>Er(i(s))})},by=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},wy=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Ae=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>$n({prefix:e,name:t,encode(i){return wy(i,n,r)},decode(i){return by(i,n,r,t)}});var xy=$n({prefix:"\0",name:"identity",encode:t=>Tf(t),decode:t=>Af(t)});var wa={};Qe(wa,{base2:()=>Sy});var Sy=Ae({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var xa={};Qe(xa,{base8:()=>Ey});var Ey=Ae({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Sa={};Qe(Sa,{base10:()=>Dy});var Dy=zr({prefix:"9",name:"base10",alphabet:"0123456789"});var Ea={};Qe(Ea,{base16:()=>Cy,base16upper:()=>Iy});var Cy=Ae({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Iy=Ae({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Da={};Qe(Da,{base32:()=>Ft,base32hex:()=>By,base32hexpad:()=>Py,base32hexpadupper:()=>ky,base32hexupper:()=>Ry,base32pad:()=>Ay,base32padupper:()=>Ty,base32upper:()=>_y,base32z:()=>Oy});var Ft=Ae({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_y=Ae({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ay=Ae({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ty=Ae({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),By=Ae({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ry=Ae({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Py=Ae({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ky=Ae({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Oy=Ae({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ca={};Qe(Ca,{base36:()=>My,base36upper:()=>Ny});var My=zr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ny=zr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ia={};Qe(Ia,{base58btc:()=>Pe,base58flickr:()=>Ly});var Pe=zr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ly=zr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _a={};Qe(_a,{base64:()=>jn,base64pad:()=>Fy,base64url:()=>Uy,base64urlpad:()=>qy});var jn=Ae({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fy=Ae({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Uy=Ae({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qy=Ae({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Aa={};Qe(Aa,{base256emoji:()=>Hy});var Pf=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ky=Pf.reduce((t,e,r)=>(t[r]=e,t),[]),zy=Pf.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Vy(t){return t.reduce((e,r)=>(e+=Ky[r],e),"")}function Gy(t){let e=[];for(let r of t){let n=zy[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Hy=$n({prefix:"\u{1F680}",name:"base256emoji",encode:Vy,decode:Gy});var Pa={};Qe(Pa,{sha256:()=>qe,sha512:()=>fm});var Wy=Mf,kf=128,$y=127,jy=~$y,Jy=Math.pow(2,31);function Mf(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Jy;)e[r++]=t&255|kf,t/=128;for(;t&jy;)e[r++]=t&255|kf,t>>>=7;return e[r]=t|0,Mf.bytes=r-n+1,e}var Zy=Ta,Yy=128,Of=127;function Ta(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw Ta.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Of)<<i:(o&Of)*Math.pow(2,i),i+=7}while(o>=Yy);return Ta.bytes=s-n,r}var Qy=Math.pow(2,7),Xy=Math.pow(2,14),em=Math.pow(2,21),tm=Math.pow(2,28),rm=Math.pow(2,35),nm=Math.pow(2,42),im=Math.pow(2,49),sm=Math.pow(2,56),om=Math.pow(2,63),am=function(t){return t<Qy?1:t<Xy?2:t<em?3:t<tm?4:t<rm?5:t<nm?6:t<im?7:t<sm?8:t<om?9:10},um={encode:Wy,decode:Zy,encodingLength:am},cm=um,Li=cm;var Fi=t=>[Li.decode(t),Li.decode.bytes],Jn=(t,e,r=0)=>(Li.encode(t,e,r),e),Zn=t=>Li.encodingLength(t);var Yt=(t,e)=>{let r=e.byteLength,n=Zn(t),i=n+Zn(r),s=new Uint8Array(i+r);return Jn(t,s,0),Jn(r,s,n),s.set(e,i),new Yn(t,r,e,s)},dn=t=>{let e=Er(t),[r,n]=Fi(e),[i,s]=Fi(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Yn(r,i,o,e)},Nf=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&_f(t.bytes,e.bytes),Yn=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Ra=({name:t,code:e,encode:r})=>new Ba(t,e,r),Ba=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Yt(this.code,r):r.then(n=>Yt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Ff=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),qe=Ra({name:"sha2-256",code:18,encode:Ff("SHA-256")}),fm=Ra({name:"sha2-512",code:19,encode:Ff("SHA-512")});var ka={};Qe(ka,{identity:()=>Vr});var Uf=0,hm="identity",qf=Er,lm=t=>Yt(Uf,qf(t)),Vr={code:Uf,name:hm,encode:qf,digest:lm};var GS=new TextEncoder,HS=new TextDecoder;var ye=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Ms,byteLength:Ms,code:Os,version:Os,multihash:Os,bytes:Os,_baseCache:Ms,asCID:Ms})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Ui)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==vm)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ye.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Yt(e,r);return ye.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Nf(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return ym(r,i,e||Pe.encoder);default:return mm(r,i,e||Ft.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return wm(/^0\.0/,xm),!!(e&&(e[zf]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof ye)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new ye(r,n,i,s||Kf(r,n,i.bytes))}else if(e!=null&&e[zf]===!0){let{version:r,multihash:n,code:i}=e,s=dn(n);return ye.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Ui)throw new Error(`Version 0 CID must use dag-pb (code: ${Ui}) block encoding`);return new ye(e,r,n,n.bytes)}case 1:{let i=Kf(e,r,n.bytes);return new ye(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return ye.create(0,Ui,e)}static createV1(e,r){return ye.create(1,e,r)}static decode(e){let[r,n]=ye.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ye.inspectBytes(e),n=r.size-r.multihashSize,i=Er(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Yn(r.multihashCode,r.digestSize,s,i);return[r.version===0?ye.createV0(o):ye.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Fi(e.subarray(r));return r+=l,h},i=n(),s=Ui;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=gm(e,r),s=ye.decode(i);return s._baseCache.set(n,e),s}},gm=(t,e)=>{switch(t[0]){case"Q":{let r=e||Pe;return[Pe.prefix,r.decode(`${Pe.prefix}${t}`)]}case Pe.prefix:{let r=e||Pe;return[Pe.prefix,r.decode(t)]}case Ft.prefix:{let r=e||Ft;return[Ft.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},ym=(t,e,r)=>{let{prefix:n}=r;if(n!==Pe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},mm=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Ui=112,vm=18,Kf=(t,e,r)=>{let n=Zn(t),i=n+Zn(e),s=new Uint8Array(i+r.byteLength);return Jn(t,s,0),Jn(e,s,n),s.set(r,i),s},zf=Symbol.for("@ipld/js-cid/CID"),Os={writable:!1,configurable:!1,enumerable:!0},Ms={writable:!1,enumerable:!1,configurable:!1},bm="0.0.0-dev",wm=(t,e)=>{if(t.test(bm))console.warn(e);else throw new Error(e)},xm=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var Qn={...ba,...wa,...xa,...Sa,...Ea,...Da,...Ca,...Ia,..._a,...Aa},XS={...Pa,...ka};function Dr(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null?globalThis.Buffer.alloc(t):new Uint8Array(t)}function Cr(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Gf(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Vf=Gf("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Oa=Gf("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Cr(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Sm={utf8:Vf,"utf-8":Vf,hex:Qn.base16,latin1:Oa,ascii:Oa,binary:Oa,...Qn},Ns=Sm;function Te(t,e="utf8"){let r=Ns[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function ke(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Fl=H(Bu(),1),Ru=Fl.default.Reader,kv=["uint64","int64","sint64","fixed64","sfixed64"];kv.forEach(t=>{let e=Ru.prototype[t];Ru.prototype[t]=function(){return BigInt(e.call(this).toString())}});function Tr(t,e){let r=Ru.create(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}var Ul=H(Bu(),1),Pu=Ul.default.Writer,Ov=["uint64","int64","sint64","fixed64","sfixed64"];Ov.forEach(t=>{let e=Pu.prototype[t];Pu.prototype[t]=function(r){return e.call(this,r.toString())}});function Br(t,e){let r=Pu.create();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var ii;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(ii||(ii={}));function uo(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ku(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(s,o){let a=e(s);o.int32(a)},n=function(s){let o=s.uint32();return e(o)};return uo("enum",ii.VARINT,r,n)}function Rr(t,e){return uo("message",ii.LENGTH_DELIMITED,t,e)}var ve;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(ve||(ve={}));var Ou;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ou||(Ou={}));(function(t){t.codec=()=>ku(Ou)})(ve||(ve={}));var or;(function(t){let e;t.codec=()=>(e==null&&(e=Rr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.Type!=null)n.uint32(8),ve.codec().encode(r.Type,n);else throw new Error('Protocol error: required field "Type" was not found in object');if(r.Data!=null)n.uint32(18),n.bytes(r.Data);else throw new Error('Protocol error: required field "Data" was not found in object');i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={Type:ve.RSA,Data:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=ve.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}if(i.Type==null)throw new Error('Protocol error: value for required field "Type" was not found in protobuf');if(i.Data==null)throw new Error('Protocol error: value for required field "Data" was not found in protobuf');return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Tr(r,t.codec())})(or||(or={}));var ar;(function(t){let e;t.codec=()=>(e==null&&(e=Rr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.Type!=null)n.uint32(8),ve.codec().encode(r.Type,n);else throw new Error('Protocol error: required field "Type" was not found in object');if(r.Data!=null)n.uint32(18),n.bytes(r.Data);else throw new Error('Protocol error: required field "Data" was not found in object');i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={Type:ve.RSA,Data:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=ve.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}if(i.Type==null)throw new Error('Protocol error: value for required field "Type" was not found in protobuf');if(i.Data==null)throw new Error('Protocol error: value for required field "Data" was not found in protobuf');return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Tr(r,t.codec())})(ar||(ar={}));var Q8=H(ts(),1),X8=H(ep(),1),Q2=H(le(),1),nd=H(Re(),1);var s2=H(Re(),1);function Le(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=Cr(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var lt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var o2=H(Re(),1);var j3=H(Ne(),1),J3=H(Co(),1),rp=H(le(),1);function Y(t,e="utf8"){let r=Ns[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Wt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Le([new Uint8Array(e-r.length),r])}return Y(r,"base64url")}function wt(t){let e=np(t);return new rp.default.jsbn.BigInteger(Y(e,"base16"),16)}function np(t,e){let r=Te(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Le([new Uint8Array(e-r.length),r])}return r}var a2={"P-256":256,"P-384":384,"P-521":521},u2=Object.keys(a2),s8=u2.join(" / ");function nc(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,o=t?.iterations??32767,a=lt.get();r*=8;async function c(h,l){let d=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=Te(l));let y={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},v=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),x=await a.subtle.deriveKey(y,v,{name:e,length:r},!0,["encrypt"]),C=await a.subtle.encrypt(g,x,h);return Le([d,g.iv,new Uint8Array(C)])}async function f(h,l){let d=h.slice(0,s),p=h.slice(s,s+n),g=h.slice(s+n),y={name:e,iv:p};typeof l=="string"&&(l=Te(l));let v={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},x=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),C=await a.subtle.deriveKey(v,x,{name:e,length:r},!0,["decrypt"]),D=await a.subtle.decrypt(y,C,g);return new Uint8Array(D)}return{encrypt:c,decrypt:f}}var yc={};Qe(yc,{RsaPrivateKey:()=>di,RsaPublicKey:()=>cs,fromJwk:()=>R2,generateKeyPair:()=>P2,unmarshalRsaPrivateKey:()=>T2,unmarshalRsaPublicKey:()=>B2});var gc=H(Re(),1);var N8=H(cp(),1),us=H(le(),1);var f2=H(ai(),1);var ae=BigInt(0),ge=BigInt(1),Fe=BigInt(2),os=BigInt(3),h2=BigInt(8),uc=Fe**BigInt(256),we={a:ae,b:BigInt(7),P:uc-Fe**BigInt(32)-BigInt(977),n:uc-BigInt("432420386565659656852420866394968145599"),h:ge,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function fp(t){let{a:e,b:r}=we,n=N(t*t),i=N(n*t);return N(i+e*t+r)}var To=we.a===ae,ce=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof ue))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new ce(e.x,e.y,ge)}static toAffineBatch(e){let r=g2(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return ce.toAffineBatch(e).map(ce.fromAffine)}equals(e){if(!(e instanceof ce))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=N(i**Fe),f=N(a**Fe),u=N(r*f),h=N(s*c),l=N(N(n*a)*f),d=N(N(o*i)*c);return u===h&&l===d}negate(){return new ce(this.x,N(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=N(e**Fe),s=N(r**Fe),o=N(s**Fe),a=N(Fe*(N((e+s)**Fe)-i-o)),c=N(os*i),f=N(c**Fe),u=N(f-Fe*a),h=N(c*(a-u)-h2*o),l=N(Fe*r*n);return new ce(u,h,l)}add(e){if(!(e instanceof ce))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e;if(s===ae||o===ae)return this;if(r===ae||n===ae)return e;let c=N(i**Fe),f=N(a**Fe),u=N(r*f),h=N(s*c),l=N(N(n*a)*f),d=N(N(o*i)*c),p=N(h-u),g=N(d-l);if(p===ae)return g===ae?this.double():ce.ZERO;let y=N(p**Fe),v=N(p*y),x=N(u*y),C=N(g**Fe-v-Fe*x),D=N(g*(x-C)-l*v),w=N(i*a*p);return new ce(C,D,w)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=ce.ZERO;if(typeof e=="bigint"&&e===ae)return r;let n=pp(e);if(n===ge)return this;if(!To){let h=r,l=this;for(;n>ae;)n&ge&&(h=h.add(l)),l=l.double(),n>>=ge;return h}let{k1neg:i,k1:s,k2neg:o,k2:a}=gp(n),c=r,f=r,u=this;for(;s>ae||a>ae;)s&ge&&(c=c.add(u)),a&ge&&(f=f.add(u)),u=u.double(),s>>=ge,a>>=ge;return i&&(c=c.negate()),o&&(f=f.negate()),f=new ce(N(f.x*we.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=To?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(ce.BASE)&&(r=ue.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&cc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=ce.normalizeZ(i),cc.set(r,i)));let s=ce.ZERO,o=ce.ZERO,a=1+(To?128/n:256/n),c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=ge),p===0){let g=i[d];l%2&&(g=g.negate()),o=o.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),s=s.add(g)}}return{p:s,f:o}}multiply(e,r){let n=pp(e),i,s;if(To){let{k1neg:o,k1:a,k2neg:c,k2:f}=gp(n),{p:u,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(f,r);o&&(u=u.negate()),c&&(l=l.negate()),l=new ce(N(l.x*we.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return ce.normalizeZ([i,s])[0]}toAffine(e=li(this.z)){let{x:r,y:n,z:i}=this,s=e,o=N(s*s),a=N(o*s),c=N(r*o),f=N(n*a);if(N(i*s)!==ge)throw new Error("invZ was invalid");return new ue(c,f)}};ce.BASE=new ce(we.Gx,we.Gy,ge);ce.ZERO=new ce(ae,ge,ae);var cc=new WeakMap,ue=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,cc.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=gr(r?e:e.subarray(1));if(!ac(n))throw new Error("Point is not on curve");let i=fp(n),s=d2(i),o=(s&ge)===ge;r?o&&(s=N(-s)):(e[0]&1)===1!==o&&(s=N(-s));let a=new ue(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=gr(e.subarray(1,33)),n=gr(e.subarray(33,65)),i=new ue(r,n);return i.assertValidity(),i}static fromHex(e){let r=Tn(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return ue.BASE.multiply(_n(e))}static fromSignature(e,r,n){e=Tn(e);let i=yp(e),{r:s,s:o}=mp(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let a=n&1?"03":"02",c=ue.fromHex(a+An(s)),{n:f}=we,u=li(s,f),h=N(-i*u,f),l=N(o*u,f),d=ue.BASE.multiplyAndAddUnsafe(c,h,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return en(this.toHex(e))}toHex(e=!1){let r=An(this.x);return e?`${this.y&ge?"03":"02"}${r}`:`04${r}${An(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!ac(r)||!ac(n))throw new Error(e);let i=N(n*n),s=fp(r);if(N(i-s)!==ae)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ue(this.x,N(-this.y))}double(){return ce.fromAffine(this).double().toAffine()}add(e){return ce.fromAffine(this).add(ce.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ce.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=ce.fromAffine(this),s=r===ae||r===ge||this!==ue.BASE?i.multiplyUnsafe(r):i.multiply(r),o=ce.fromAffine(e).multiplyUnsafe(n),a=s.add(o);return a.equals(ce.ZERO)?void 0:a.toAffine()}};ue.BASE=new ue(we.Gx,we.Gy);ue.ZERO=new ue(ae,ae);function hp(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function lp(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${hi(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:gr(r),left:t.subarray(e+2)}}function l2(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${hi(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=lp(t.subarray(2)),{data:n,left:i}=lp(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${hi(i)}`);return{r:e,s:n}}var dr=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=Po(e),n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?hi(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new dr(ko(i.slice(0,64)),ko(i.slice(64,128)))}static fromDER(e){let r=Po(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=l2(r?e:en(e));return new dr(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!as(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!as(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=we.n>>ge;return this.s>e}normalizeS(){return this.hasHighS()?new dr(this.r,we.n-this.s):this}toDERRawBytes(e=!1){return en(this.toDERHex(e))}toDERHex(e=!1){let r=hp(ss(this.s));if(e)return r;let n=hp(ss(this.r)),i=ss(n.length/2),s=ss(r.length/2);return`30${ss(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return en(this.toCompactHex())}toCompactHex(){return An(this.r)+An(this.s)}};function fi(...t){if(!t.every(Po))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function Po(t){return t instanceof Uint8Array}var p2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function hi(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=p2[t[r]];return e}function An(t){if(t>uc)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function oc(t){return en(An(t))}function ss(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ko(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function en(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function gr(t){return ko(hi(t))}function Tn(t){return t instanceof Uint8Array?Uint8Array.from(t):en(t)}function pp(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&as(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function N(t,e=we.P){let r=t%e;return r>=ae?r:e+r}function Pt(t,e){let{P:r}=we,n=t;for(;e-- >ae;)n*=n,n%=r;return n}function d2(t){let{P:e}=we,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=t*t*t%e,f=c*c*t%e,u=Pt(f,os)*f%e,h=Pt(u,os)*f%e,l=Pt(h,Fe)*c%e,d=Pt(l,n)*l%e,p=Pt(d,i)*d%e,g=Pt(p,o)*p%e,y=Pt(g,a)*g%e,v=Pt(y,o)*p%e,x=Pt(v,os)*f%e,C=Pt(x,s)*d%e,D=Pt(C,r)*c%e;return Pt(D,Fe)}function li(t,e=we.P){if(t===ae||e<=ae)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=N(t,e),n=e,i=ae,s=ge,o=ge,a=ae;for(;r!==ae;){let f=n/r,u=n%r,h=i-o*f,l=s-a*f;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==ge)throw new Error("invert: does not exist");return N(i,e)}function g2(t,e=we.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===ae?s:(r[a]=s,N(s*o,e)),ge),i=li(n,e);return t.reduceRight((s,o,a)=>o===ae?s:(r[a]=N(s*r[a],e),N(s*o,e)),i),r}var dp=(t,e)=>(t+e/Fe)/e,Bo=Fe**BigInt(128);function gp(t){let{n:e}=we,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ge*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=dp(s*t,e),a=dp(-n*t,e),c=N(t-o*r-a*i,e),f=N(-o*n-a*s,e),u=c>Bo,h=f>Bo;if(u&&(c=e-c),h&&(f=e-f),c>Bo||f>Bo)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:u,k1:c,k2neg:h,k2:f}}function yp(t){let{n:e}=we,n=t.length*8-256,i=gr(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var fc=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return it.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof it.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=it.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function as(t){return ae<t&&t<we.n}function ac(t){return ae<t&&t<we.P}function y2(t,e,r){let n=gr(t);if(!as(n))return;let{n:i}=we,s=ue.BASE.multiply(n),o=N(s.x,i);if(o===ae)return;let a=N(li(n,i)*N(e+r*o,i),i);if(a===ae)return;let c=new dr(o,a),f=(s.x===c.r?0:2)|Number(s.y&ge);return{sig:c,recovery:f}}function _n(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=ko(t)}else if(Po(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=gr(t)}else throw new TypeError("Expected valid private key");if(!as(e))throw new Error("Expected private key: 0 < key < n");return e}function m2(t){return t instanceof ue?(t.assertValidity(),t):ue.fromHex(t)}function mp(t){if(t instanceof dr)return t.assertValidity(),t;try{return dr.fromDER(t)}catch{return dr.fromCompact(t)}}function hc(t,e=!1){return ue.fromPrivateKey(t).toRawBytes(e)}function vp(t){let e=t.length>32?t.slice(0,32):t;return gr(e)}function v2(t){let e=vp(t),r=N(e,we.n);return bp(r<ae?e:r)}function bp(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=An(t);return en(e)}function b2(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Tn(t),i=_n(e),s=[bp(i),v2(n)];if(r!=null){r===!0&&(r=it.randomBytes(32));let c=Tn(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let o=fi(...s),a=vp(n);return{seed:o,m:a,d:i}}function w2(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function wp(t,e,r={}){let{seed:n,m:i,d:s}=b2(t,e,r.extraEntropy),o,a=new fc;for(await a.reseed(n);!(o=y2(await a.generate(),i,s));)await a.reseed();return w2(o,r)}var x2={strict:!0};function xp(t,e,r,n=x2){let i;try{i=mp(t),e=Tn(e)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=yp(e),c;try{c=m2(r)}catch{return!1}let{n:f}=we,u=li(o,f),h=N(a*u,f),l=N(s*u,f),d=ue.BASE.multiplyAndAddUnsafe(c,h,l);return d?N(d.x,f)===s:!1}ue.BASE._setWindowSize(8);var xt={node:f2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Ro={},it={isValidPrivateKey(t){try{return _n(t),!0}catch{return!1}},privateAdd:(t,e)=>{let r=_n(t),n=_n(e);return oc(N(r+n,we.n))},privateNegate:t=>{let e=_n(t);return oc(we.n-e)},pointAddScalar:(t,e,r)=>{let n=ue.fromHex(t),i=_n(e),s=ue.BASE.multiplyAndAddUnsafe(n,i,ge);if(!s)throw new Error("Tweaked point at infinity");return s.toRawBytes(r)},pointMultiply:(t,e,r)=>{let n=ue.fromHex(t),i=gr(Tn(e));return n.multiply(i).toRawBytes(r)},hashToPrivateKey:t=>{if(t=Tn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=N(gr(t),we.n-ge)+ge;return oc(e)},randomBytes:(t=32)=>{if(xt.web)return xt.web.getRandomValues(new Uint8Array(t));if(xt.node){let{randomBytes:e}=xt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>it.hashToPrivateKey(it.randomBytes(40)),bytesToHex:hi,hexToBytes:en,concatBytes:fi,mod:N,invert:li,sha256:async(...t)=>{if(xt.web){let e=await xt.web.subtle.digest("SHA-256",fi(...t));return new Uint8Array(e)}else if(xt.node){let{createHash:e}=xt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(xt.web){let r=await xt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=fi(...e),i=await xt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(xt.node){let{createHmac:r}=xt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Ro[t];if(r===void 0){let n=await it.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=fi(n,n),Ro[t]=r}return it.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof it.sha256Sync!="function")throw new Error("utils.sha256Sync is undefined, you need to set it");let r=Ro[t];if(r===void 0){let n=it.sha256Sync(Uint8Array.from(t,i=>i.charCodeAt(0)));r=fi(n,n),Ro[t]=r}return it.sha256Sync(r,...e)},precompute(t=8,e=ue.BASE){let r=e===ue.BASE?e:new ue(e.x,e.y);return r._setWindowSize(t),r.multiply(os),r}};var Sp=H(Re(),1);function tn(t){if(isNaN(t)||t<=0)throw(0,Sp.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return it.randomBytes(t)}var Bn={};Qe(Bn,{jwkToPkcs1:()=>D2,jwkToPkix:()=>I2,pkcs1ToJwk:()=>E2,pkixToJwk:()=>C2});var v8=H(ts(),1),b8=H(Ao(),1),Mr=H(le(),1);var lc=H(Re(),1);function E2(t){let e=Mr.default.asn1.fromDer(Y(t,"ascii")),r=Mr.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e),d:Wt(r.d),p:Wt(r.p),q:Wt(r.q),dp:Wt(r.dP),dq:Wt(r.dQ),qi:Wt(r.qInv),alg:"RS256"}}function D2(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw(0,lc.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Mr.default.pki.privateKeyToAsn1({n:wt(t.n),e:wt(t.e),d:wt(t.d),p:wt(t.p),q:wt(t.q),dP:wt(t.dp),dQ:wt(t.dq),qInv:wt(t.qi)});return Te(Mr.default.asn1.toDer(e).getBytes(),"ascii")}function C2(t){let e=Mr.default.asn1.fromDer(Y(t,"ascii")),r=Mr.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e)}}function I2(t){if(t.n==null||t.e==null)throw(0,lc.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Mr.default.pki.publicKeyToAsn1({n:wt(t.n),e:wt(t.e)});return Te(Mr.default.asn1.toDer(e).getBytes(),"ascii")}var E8=H(Ao(),1),pc=H(le(),1);function Ep(t,e){return e.map(r=>wt(t[r]))}function Dp(t){return pc.default.pki.setRsaPrivateKey(...Ep(t,["n","e","d","p","q","dp","dq","qi"]))}function Cp(t){return pc.default.pki.setRsaPublicKey(...Ep(t,["n","e"]))}var Ip=H(Re(),1);async function _p(t){let e=await lt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Bp(e);return{privateKey:r[0],publicKey:r[1]}}async function dc(t){let r=[await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await _2(t)],n=await Bp({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Ap(t,e){let r=await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await lt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Tp(t,e,r){let n=await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await lt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Bp(t){if(t.privateKey==null||t.publicKey==null)throw(0,Ip.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([lt.get().subtle.exportKey("jwk",t.privateKey),lt.get().subtle.exportKey("jwk",t.publicKey)])}async function _2(t){return await lt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Rp(t,e,r,n){let i=e?Cp(t):Dp(t),s=Y(Uint8Array.from(r),"ascii"),o=n(s,i);return Te(o,"ascii")}function Pp(t,e){return Rp(t,!0,e,(r,n)=>n.encrypt(r))}function kp(t,e){return Rp(t,!1,e,(r,n)=>n.decrypt(r))}async function pi(t,e){let n=await nc().encrypt(t,e);return jn.encode(n)}var cs=class{constructor(e){this._key=e}async verify(e,r){return await Tp(this._key,r,e)}marshal(){return Bn.jwkToPkix(this._key)}get bytes(){return or.encode({Type:ve.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Pp(this._key,e)}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}},di=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return tn(16)}async sign(e){return await Ap(this._key,e)}get public(){if(this._publicKey==null)throw(0,gc.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new cs(this._publicKey)}decrypt(e){return kp(this._key,e)}marshal(){return Bn.jwkToPkcs1(this._key)}get bytes(){return ar.encode({Type:ve.RSA,Data:this.marshal()}).subarray()}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Y(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new us.default.util.ByteBuffer(this.marshal()),i=us.default.asn1.fromDer(n),s=us.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return us.default.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return await pi(this.bytes,e);throw(0,gc.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function T2(t){let e=Bn.pkcs1ToJwk(t),r=await dc(e);return new di(r.privateKey,r.publicKey)}function B2(t){let e=Bn.pkixToJwk(t);return new cs(e)}async function R2(t){let e=await dc(t);return new di(e.privateKey,e.publicKey)}async function P2(t){let e=await _p(t);return new di(e.privateKey,e.publicKey)}var Cc={};Qe(Cc,{Ed25519PrivateKey:()=>Pn,Ed25519PublicKey:()=>ds,generateKeyPair:()=>$2,generateKeyPairFromSeed:()=>Jp,unmarshalEd25519PrivateKey:()=>H2,unmarshalEd25519PublicKey:()=>W2});var Dc=H(Re(),1);var Lp=H(ai(),1);var Ve=BigInt(0),te=BigInt(1),st=BigInt(2),Fp=BigInt(255),Op=st**BigInt(252)+BigInt("27742317777372353535851937790883648493"),De={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:st**Fp-BigInt(19),l:Op,n:Op,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};var Up=st**BigInt(256),fs=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),F8=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),k2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),O2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),M2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),N2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),ee=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Ie))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Ie.ZERO)?ee.ZERO:new ee(e.x,e.y,te,_(e.x*e.y))}static toAffineBatch(e){let r=U2(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Mp(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=_(r*a),f=_(s*i),u=_(n*a),h=_(o*i);return c===f&&u===h}negate(){return new ee(_(-this.x),this.y,this.z,_(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=De,s=_(e**st),o=_(r**st),a=_(st*_(n**st)),c=_(i*s),f=_(_((e+r)**st)-s-o),u=c+o,h=u-a,l=c-o,d=_(f*h),p=_(u*l),g=_(f*l),y=_(h*u);return new ee(d,p,y,g)}add(e){Mp(e);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:c,t:f}=e,u=_((n-r)*(a+o)),h=_((n+r)*(a-o)),l=_(h-u);if(l===Ve)return this.double();let d=_(i*st*f),p=_(s*st*c),g=p+d,y=h+u,v=p-d,x=_(g*l),C=_(y*v),D=_(g*v),w=_(l*y);return new ee(x,C,w,D)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(ee.BASE)&&(r=Ie.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&wc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=ee.normalizeZ(i),wc.set(r,i)));let s=ee.ZERO,o=ee.ZERO,a=1+256/n,c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=te),p===0){let g=i[d];l%2&&(g=g.negate()),o=o.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),s=s.add(g)}}return ee.normalizeZ([s,o])[0]}multiply(e,r){return this.wNAF(Oo(e,De.l),r)}multiplyUnsafe(e){let r=Oo(e,De.l,!1),n=ee.BASE,i=ee.ZERO;if(r===Ve)return i;if(this.equals(i)||r===te)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>Ve;)r&te&&(s=s.add(o)),o=o.double(),r>>=te;return s}isSmallOrder(){return this.multiplyUnsafe(De.h).equals(ee.ZERO)}isTorsionFree(){return this.multiplyUnsafe(De.l).equals(ee.ZERO)}toAffine(e=Mo(this.z)){let{x:r,y:n,z:i}=this,s=_(r*e),o=_(n*e);if(_(i*e)!==te)throw new Error("invZ was invalid");return new Ie(s,o)}fromRistrettoBytes(){vc()}toRistrettoBytes(){vc()}fromRistrettoHash(){vc()}};ee.BASE=new ee(De.Gx,De.Gy,te,_(De.Gx*De.Gy));ee.ZERO=new ee(Ve,te,te,Ve);function Mp(t){if(!(t instanceof ee))throw new TypeError("ExtendedPoint expected")}function mc(t){if(!(t instanceof pt))throw new TypeError("RistrettoPoint expected")}function vc(){throw new Error("Legacy method: switch to RistrettoPoint")}var pt=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=De,n=_(fs*e*e),i=_((n+te)*M2),s=BigInt(-1),o=_((s-r*n)*_(n+r)),{isValid:a,value:c}=Sc(i,o),f=_(c*e);nn(f)||(f=_(-f)),a||(c=f),a||(s=n);let u=_(s*(n-te)*N2-o),h=c*c,l=_((c+c)*o),d=_(u*k2),p=_(te-h),g=_(te+h);return new ee(_(l*g),_(p*d),_(d*g),_(l*p))}static hashToCurve(e){e=sn(e,64);let r=bc(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=bc(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new pt(n.add(s))}static fromHex(e){e=sn(e,32);let{a:r,d:n}=De,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=bc(e);if(!K2(hs(s),e)||nn(s))throw new Error(i);let o=_(s*s),a=_(te+r*o),c=_(te-r*o),f=_(a*a),u=_(c*c),h=_(r*n*f-u),{isValid:l,value:d}=Np(_(h*u)),p=_(d*c),g=_(d*p*h),y=_((s+s)*p);nn(y)&&(y=_(-y));let v=_(a*g),x=_(y*v);if(!l||nn(x)||v===Ve)throw new Error(i);return new pt(new ee(y,v,te,x))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=_(_(n+r)*_(n-r)),o=_(e*r),{value:a}=Np(_(s*o**st)),c=_(a*s),f=_(a*o),u=_(c*f*i),h;if(nn(i*u)){let d=_(r*fs),p=_(e*fs);e=d,r=p,h=_(c*O2)}else h=f;nn(e*u)&&(r=_(-r));let l=_((n-r)*h);return nn(l)&&(l=_(-l)),hs(l)}toHex(){return ls(this.toRawBytes())}toString(){return this.toHex()}equals(e){mc(e);let r=this.ep,n=e.ep,i=_(r.x*n.y)===_(r.y*n.x),s=_(r.y*n.y)===_(r.x*n.x);return i||s}add(e){return mc(e),new pt(this.ep.add(e.ep))}subtract(e){return mc(e),new pt(this.ep.subtract(e.ep))}multiply(e){return new pt(this.ep.multiply(e))}multiplyUnsafe(e){return new pt(this.ep.multiplyUnsafe(e))}};pt.BASE=new pt(ee.BASE);pt.ZERO=new pt(ee.ZERO);var wc=new WeakMap,Ie=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,wc.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=De;e=sn(e,32);let s=e.slice();s[31]=e[31]&-129;let o=gi(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=Up)throw new Error("Expected 0 < hex < 2**256");let a=_(o*o),c=_(a-te),f=_(n*a+te),{isValid:u,value:h}=Sc(c,f);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&te)===te;return(e[31]&128)!==0!==l&&(h=_(-h)),new Ie(h,o)}static async fromPrivateKey(e){return(await No(e)).point}toRawBytes(){let e=hs(this.y);return e[31]|=this.x&te?128:0,e}toHex(){return ls(this.toRawBytes())}toX25519(){let{y:e}=this,r=_((te+e)*Mo(te-e));return hs(r)}isTorsionFree(){return ee.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Ie(_(-this.x),this.y)}add(e){return ee.fromAffine(this).add(ee.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ee.fromAffine(this).multiply(e,this).toAffine()}};Ie.BASE=new Ie(De.Gx,De.Gy);Ie.ZERO=new Ie(Ve,te);var Rn=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=sn(e,64),n=Ie.fromHex(r.slice(0,32),!1),i=gi(r.slice(32,64));return new Rn(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Ie))throw new Error("Expected Point instance");return Oo(r,De.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(hs(this.s),32),e}toHex(){return ls(this.toRawBytes())}};function L2(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var F2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ls(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=F2[t[r]];return e}function qp(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function Kp(t){let r=t.toString(16).padStart(64,"0");return qp(r)}function hs(t){return Kp(t).reverse()}function nn(t){return(_(t)&te)===te}function gi(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+ls(Uint8Array.from(t).reverse()))}function bc(t){return _(gi(t)&st**Fp-te)}function _(t,e=De.P){let r=t%e;return r>=Ve?r:e+r}function Mo(t,e=De.P){if(t===Ve||e<=Ve)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=_(t,e),n=e,i=Ve,s=te,o=te,a=Ve;for(;r!==Ve;){let f=n/r,u=n%r,h=i-o*f,l=s-a*f;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==te)throw new Error("invert: does not exist");return _(i,e)}function U2(t,e=De.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===Ve?s:(r[a]=s,_(s*o,e)),te),i=Mo(n,e);return t.reduceRight((s,o,a)=>o===Ve?s:(r[a]=_(s*r[a],e),_(s*o,e)),i),r}function yr(t,e){let{P:r}=De,n=t;for(;e-- >Ve;)n*=n,n%=r;return n}function q2(t){let{P:e}=De,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),c=t*t%e*t%e,f=yr(c,st)*c%e,u=yr(f,te)*t%e,h=yr(u,r)*u%e,l=yr(h,n)*h%e,d=yr(l,i)*l%e,p=yr(d,s)*d%e,g=yr(p,o)*p%e,y=yr(g,o)*p%e,v=yr(y,n)*h%e;return{pow_p_5_8:yr(v,st)*t%e,b2:c}}function Sc(t,e){let r=_(e*e*e),n=_(r*r*e),i=q2(t*n).pow_p_5_8,s=_(t*r*i),o=_(e*s*s),a=s,c=_(s*fs),f=o===t,u=o===_(-t),h=o===_(-t*fs);return f&&(s=a),(u||h)&&(s=c),nn(s)&&(s=_(-s)),{isValid:f||u,value:s}}function Np(t){return Sc(te,t)}async function xc(...t){let e=await ps.sha512(L2(...t)),r=gi(e);return _(r,De.l)}function K2(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function sn(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):qp(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Oo(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(Ve<t)return t}else if(Ve<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function z2(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}async function No(t){if(t=typeof t=="bigint"||typeof t=="number"?Kp(Oo(t,Up)):sn(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await ps.sha512(t),r=z2(e.slice(0,32)),n=e.slice(32,64),i=_(gi(r),De.l),s=Ie.BASE.multiply(i),o=s.toRawBytes();return{head:r,prefix:n,scalar:i,point:s,pointBytes:o}}async function Ec(t){return(await No(t)).pointBytes}async function zp(t,e){t=sn(t);let{prefix:r,scalar:n,pointBytes:i}=await No(e),s=await xc(r,t),o=Ie.BASE.multiply(s),a=await xc(o.toRawBytes(),i,t),c=_(s+a*n,De.l);return new Rn(o,c).toRawBytes()}async function Vp(t,e,r){e=sn(e),r instanceof Ie||(r=Ie.fromHex(r,!1));let{r:n,s:i}=t instanceof Rn?t.assertValidity():Rn.fromHex(t),s=ee.BASE.multiplyUnsafe(i),o=await xc(n.toRawBytes(),r.toRawBytes(),e),a=ee.fromAffine(r).multiplyUnsafe(o);return ee.fromAffine(n).add(a).subtract(s).multiplyUnsafe(De.h).equals(ee.ZERO)}Ie.BASE._setWindowSize(8);var rn={node:Lp.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},ps={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:ls,getExtendedPublicKey:No,mod:_,invert:Mo,hashToPrivateScalar:t=>{if(t=sn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=_(gi(t),De.l);if(e===Ve||e===te)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(rn.web)return rn.web.getRandomValues(new Uint8Array(t));if(rn.node){let{randomBytes:e}=rn.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ps.randomBytes(32),sha512:async t=>{if(rn.web){let e=await rn.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(rn.node)return Uint8Array.from(rn.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Ie.BASE){let r=e.equals(Ie.BASE)?e:new Ie(e.x,e.y);return r._setWindowSize(t),r.multiply(st),r}};var yi=32,Nr=64,Lo=32;async function Gp(){let t=ps.randomPrivateKey(),e=await Ec(t);return{privateKey:jp(t,e),publicKey:e}}async function Hp(t){if(t.length!==Lo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Ec(e);return{privateKey:jp(e,r),publicKey:r}}async function Wp(t,e){let r=t.slice(0,Lo);return await zp(e,r)}async function $p(t,e,r){return await Vp(e,r,t)}function jp(t,e){let r=new Uint8Array(Nr);for(let n=0;n<Lo;n++)r[n]=t[n],r[Lo+n]=e[n];return r}var ds=class{constructor(e){this._key=mi(e,yi)}async verify(e,r){return await $p(this._key,r,e)}marshal(){return this._key}get bytes(){return or.encode({Type:ve.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}},Pn=class{constructor(e,r){this._key=mi(e,Nr),this._publicKey=mi(r,yi)}async sign(e){return await Wp(this._key,e)}get public(){return new ds(this._publicKey)}marshal(){return this._key}get bytes(){return ar.encode({Type:ve.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}async id(){let e=await Vr.digest(this.public.bytes);return Pe.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await pi(this.bytes,e);throw(0,Dc.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function H2(t){if(t.length>Nr){t=mi(t,Nr+yi);let n=t.slice(0,Nr),i=t.slice(Nr,t.length);return new Pn(n,i)}t=mi(t,Nr);let e=t.slice(0,Nr),r=t.slice(yi);return new Pn(e,r)}function W2(t){return t=mi(t,yi),new ds(t)}async function $2(){let{privateKey:t,publicKey:e}=await Gp();return new Pn(t,e)}async function Jp(t){let{privateKey:e,publicKey:r}=await Hp(t);return new Pn(e,r)}function mi(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw(0,Dc.default)(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var _c={};Qe(_c,{Secp256k1PrivateKey:()=>ys,Secp256k1PublicKey:()=>gs,generateKeyPair:()=>Y2,unmarshalSecp256k1PrivateKey:()=>J2,unmarshalSecp256k1PublicKey:()=>Z2});var rd=H(Re(),1);var vi=H(Re(),1);function Zp(){return it.randomPrivateKey()}async function Yp(t,e){let{digest:r}=await qe.digest(e);try{return await wp(r,t)}catch(n){throw(0,vi.default)(n,"ERR_INVALID_INPUT")}}async function Qp(t,e,r){try{let{digest:n}=await qe.digest(r);return xp(e,n,t)}catch(n){throw(0,vi.default)(n,"ERR_INVALID_INPUT")}}function Xp(t){return ue.fromHex(t).toRawBytes(!0)}function ed(t){try{hc(t,!0)}catch(e){throw(0,vi.default)(e,"ERR_INVALID_PRIVATE_KEY")}}function Ic(t){try{ue.fromHex(t)}catch(e){throw(0,vi.default)(e,"ERR_INVALID_PUBLIC_KEY")}}function td(t){try{return hc(t,!0)}catch(e){throw(0,vi.default)(e,"ERR_INVALID_PRIVATE_KEY")}}var gs=class{constructor(e){Ic(e),this._key=e}async verify(e,r){return await Qp(this._key,r,e)}marshal(){return Xp(this._key)}get bytes(){return or.encode({Type:ve.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}},ys=class{constructor(e,r){this._key=e,this._publicKey=r??td(e),ed(this._key),Ic(this._publicKey)}async sign(e){return await Yp(this._key,e)}get public(){return new gs(this._publicKey)}marshal(){return this._key}get bytes(){return ar.encode({Type:ve.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ke(this.bytes,e.bytes)}async hash(){let{bytes:e}=await qe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Y(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await pi(this.bytes,e);throw(0,rd.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function J2(t){return new ys(t)}function Z2(t){return new gs(t)}async function Y2(){let t=await Zp();return new ys(t)}var on={rsa:yc,ed25519:Cc,secp256k1:_c};function Ac(t){let e=Object.keys(on).join(" / ");return(0,nd.default)(new Error(`invalid or unsupported key type ${t}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function X2(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return on[t];throw Ac(t)}function ms(t){let e=or.decode(t),r=e.Data;switch(e.Type){case ve.RSA:return on.rsa.unmarshalRsaPublicKey(r);case ve.Ed25519:return on.ed25519.unmarshalEd25519PublicKey(r);case ve.Secp256k1:return on.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Ac(e.Type)}}function id(t,e){return e=(e??"rsa").toLowerCase(),X2(e),t.bytes}async function Fo(t){let e=ar.decode(t),r=e.Data;switch(e.Type){case ve.RSA:return await on.rsa.unmarshalRsaPrivateKey(r);case ve.Ed25519:return on.ed25519.unmarshalEd25519PrivateKey(r);case ve.Secp256k1:return on.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Ac(e.Type)}}var sd={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var vs;(function(t){let e;t.codec=()=>(e==null&&(e=Rr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.publicKey!=null)n.uint32(10),n.bytes(r.publicKey);else throw new Error('Protocol error: required field "publicKey" was not found in object');if(r.payloadType!=null)n.uint32(18),n.bytes(r.payloadType);else throw new Error('Protocol error: required field "payloadType" was not found in object');if(r.payload!=null)n.uint32(26),n.bytes(r.payload);else throw new Error('Protocol error: required field "payload" was not found in object');if(r.signature!=null)n.uint32(42),n.bytes(r.signature);else throw new Error('Protocol error: required field "signature" was not found in object');i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(o&7);break}}if(i.publicKey==null)throw new Error('Protocol error: value for required field "publicKey" was not found in protobuf');if(i.payloadType==null)throw new Error('Protocol error: value for required field "payloadType" was not found in protobuf');if(i.payload==null)throw new Error('Protocol error: value for required field "payload" was not found in protobuf');if(i.signature==null)throw new Error('Protocol error: value for required field "signature" was not found in protobuf');return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Tr(r,t.codec())})(vs||(vs={}));var tw=H(Re(),1);var od=Symbol.for("@libp2p/peer-id");var ad=Object.values(Qn).map(t=>t.decoder).reduce((t,e)=>t.or(e),Qn.identity.decoder),ud=114,Tc=36,Bc=37,bs=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[od](){return!0}toString(){return this.string==null&&(this.string=Pe.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return ye.createV1(ud,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return ke(this.multihash.bytes,e);if(typeof e=="string")return Lr(e).equals(this);if(e?.multihash?.bytes!=null)return ke(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},bi=class extends bs{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},wi=class extends bs{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},xi=class extends bs{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function Lr(t,e){if(e=e??ad,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=dn(Pe.decode(`z${t}`));return t.startsWith("12D")?new wi({multihash:r}):t.startsWith("16U")?new xi({multihash:r}):new bi({multihash:r})}return an(ad.decode(t))}function an(t){try{let e=dn(t);if(e.code===Vr.code){if(e.digest.length===Tc)return new wi({multihash:e});if(e.digest.length===Bc)return new xi({multihash:e})}if(e.code===qe.code)return new bi({multihash:e})}catch{return rw(ye.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function rw(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==ud)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===qe.code)return new bi({multihash:t.multihash});if(e.code===Vr.code){if(e.digest.length===Tc)return new wi({multihash:t.multihash});if(e.digest.length===Bc)return new xi({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function cd(t,e){return t.length===Tc?new wi({multihash:Yt(Vr.code,t),privateKey:e}):t.length===Bc?new xi({multihash:Yt(Vr.code,t),privateKey:e}):new bi({multihash:await qe.digest(t),publicKey:t,privateKey:e})}var hd=Symbol.for("@achingbrain/uint8arraylist");function fd(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function Rc(t){return Boolean(t?.[hd])}var kt=class{constructor(...e){Object.defineProperty(this,hd,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Rc(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Rc(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=fd(this.bufs,e);return r.buf[r.index]}set(e,r){let n=fd(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Rc(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Le(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:Le(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),s=new kt;return s.length=i,s.bufs=n,s}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,c=a+o.byteLength;if(i=c,e>=c)continue;let f=e>=a&&e<c,u=r>a&&r<=c;if(f&&u){if(e===a&&r===c){n.push(o);break}let h=e-a;n.push(o.subarray(h,h+(r-e)));break}if(f){if(e===0){n.push(o);continue}n.push(o.subarray(e-a));continue}if(u){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-e}}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=Cr(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=Dr(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=Dr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=Dr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=Cr(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=Dr(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=Dr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=Dr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=Dr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=Dr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof kt)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!ke(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new kt;return n.bufs=e,r==null&&(r=e.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function Uo(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var ld=4294967296,St=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new St(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new St(r,n)}toBytes(e,r=0){let n=Uo(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new St;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>ld&&(i=0,++n>ld&&(n=0))),new St(n,i)}static fromNumber(e){if(e===0)return new St;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new St(i,n)}static fromBytes(e,r=0){let n=Uo(e),i=new St,s=0;if(e.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(e.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<e.byteLength)for(;s<5;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var nw=Math.pow(2,7),iw=Math.pow(2,14),sw=Math.pow(2,21),ow=Math.pow(2,28),aw=Math.pow(2,35),uw=Math.pow(2,42),cw=Math.pow(2,49),fw=Math.pow(2,56),hw=Math.pow(2,63),$t={encodingLength(t){return t<nw?1:t<iw?2:t<sw?3:t<ow?4:t<aw?5:t<uw?6:t<cw?7:t<fw?8:t<hw?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=Cr($t.encodingLength(t))),St.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return St.fromBytes(t,e).toNumber(!0)}};var lw,Ot=class{constructor(e){let{peerId:r,payloadType:n,payload:i,signature:s}=e;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=vs.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return ke(this.marshal(),e.marshal())}async validate(e){let r=dd(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await ms(this.peerId.publicKey).verify(r.subarray(),this.signature)}};lw=Ot;Ot.createFromProtobuf=async t=>{let e=vs.decode(t),r=await cd(e.publicKey);return new Ot({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Ot.seal=async(t,e)=>{if(e.privateKey==null)throw new Error("Missing private key");let r=t.domain,n=t.codec,i=t.marshal(),s=dd(r,n,i),a=await(await Fo(e.privateKey)).sign(s.subarray());return new Ot({peerId:e,payloadType:n,payload:i,signature:a})};Ot.openAndCertify=async(t,e)=>{let r=await Ot.createFromProtobuf(t);if(!await r.validate(e))throw(0,pd.default)(new Error("envelope signature is not valid for the given domain"),sd.ERR_SIGNATURE_NOT_VALID);return r};var dd=(t,e,r)=>{let n=Te(t),i=$t.encode(n.byteLength),s=$t.encode(e.length),o=$t.encode(r.length);return new kt(i,n,s,e,o,r)};var gd="[a-fA-F\\d:]",un=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${gd})|(?<=${gd})(?=\\s|$))`:"",jt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ze="[a-fA-F\\d]{1,4}",qo=`
(?:
(?:${ze}:){7}(?:${ze}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ze}:){6}(?:${jt}|:${ze}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ze}:){5}(?::${jt}|(?::${ze}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ze}:){4}(?:(?::${ze}){0,1}:${jt}|(?::${ze}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ze}:){3}(?:(?::${ze}){0,2}:${jt}|(?::${ze}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ze}:){2}(?:(?::${ze}){0,3}:${jt}|(?::${ze}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ze}:){1}(?:(?::${ze}){0,4}:${jt}|(?::${ze}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ze}){0,5}:${jt}|(?::${ze}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),pw=new RegExp(`(?:^${jt}$)|(?:^${qo}$)`),dw=new RegExp(`^${jt}$`),gw=new RegExp(`^${qo}$`),Pc=t=>t&&t.exact?pw:new RegExp(`(?:${un(t)}${jt}${un(t)})|(?:${un(t)}${qo}${un(t)})`,"g");Pc.v4=t=>t&&t.exact?dw:new RegExp(`${un(t)}${jt}${un(t)}`,"g");Pc.v6=t=>t&&t.exact?gw:new RegExp(`${un(t)}${qo}${un(t)}`,"g");var Ko=Pc;function zo(t){return Ko({exact:!0}).test(t)}function yd(t){return Ko.v6({exact:!0}).test(t)}function md(t){return Ko.v4({exact:!0}).test(t)}var vd=md,yw=yd,kc=function(t){let e=0,r;if(vd(t))r=new Uint8Array(e+4),t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255});else if(yw(t)){let n=t.split(":",8),i;for(i=0;i<n.length;i++){let s=vd(n[i]),o;s&&(o=kc(n[i]),n[i]=Y(o.slice(0,2),"base16")),o!=null&&++i<8&&n.splice(i,0,Y(o.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(i=0;i<n.length&&n[i]!=="";i++);let s=[i,1];for(i=9-n.length;i>0;i--)s.push("0");n.splice.apply(n,s)}for(r=new Uint8Array(e+16),i=0;i<n.length;i++){let s=parseInt(n[i],16);r[e++]=s>>8&255,r[e++]=s&255}}if(r==null)throw Error("Invalid ip address: "+t);return r},bd=function(t,e,r){e=~~e,r=r??t.length-e;let n=[],i="",s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};var ws={},Oc={},vw=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];vw.forEach(t=>{let e=bw(...t);Oc[e.code]=e,ws[e.name]=e});function bw(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}function xe(t){if(typeof t=="number"){if(Oc[t]!=null)return Oc[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(ws[t]!=null)return ws[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var kn=H(Vo(),1);function Rd(t,e){switch(xe(t).code){case 4:case 41:return kw(e);case 6:case 273:case 33:case 132:return kd(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return Mw(e);case 421:return Lw(e);case 444:return Bd(e);case 445:return Bd(e);default:return Y(e,"base16")}}function Pd(t,e){switch(xe(t).code){case 4:return Td(e);case 41:return Td(e);case 6:case 273:case 33:case 132:return Lc(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return Ow(e);case 421:return Nw(e);case 444:return Fw(e);case 445:return Uw(e);default:return Te(e,"base16")}}function Td(t){if(!zo(t))throw new Error("invalid ip address");return kc(t)}function kw(t){let e=bd(t,0,t.length);if(e==null||!zo(e))throw new Error("invalid ip address");return e}function Lc(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function kd(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Ow(t){let e=Te(t),r=Uint8Array.from(kn.default.encode(e.length));return Le([r,e],r.length+e.length)}function Mw(t){let e=kn.default.decode(t);if(t=t.slice(kn.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return Y(t)}function Nw(t){let e;t[0]==="Q"||t[0]==="1"?e=dn(Pe.decode(`z${t}`)).bytes:e=ye.parse(t).multihash.bytes;let r=Uint8Array.from(kn.default.encode(e.length));return Le([r,e],r.length+e.length)}function Lw(t){let e=kn.default.decode(t),r=t.slice(kn.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return Y(r,"base58btc")}function Fw(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Ft.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Lc(n);return Le([r,i],r.length+i.length)}function Uw(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Ft.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Lc(n);return Le([r,i],r.length+i.length)}function Bd(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Y(e,"base32"),i=kd(r);return`${n}:${i}`}var Si=H(Vo(),1);function qw(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=xe(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw Md("invalid address: "+t);if(s.path===!0){e.push([i,Kc(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function Kw(t){let e=[];return t.map(r=>{let n=Wo(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),Kc(e.join("/"))}function zw(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Wo(e);return e.length>1?[r.code,Pd(r.code,e[1])]:[r.code]})}function Fc(t){return t.map(e=>{let r=Wo(e);return e[1]!=null?[r.code,Rd(r.code,e[1])]:[r.code]})}function Uc(t){return Ho(Le(t.map(e=>{let r=Wo(e),n=Uint8Array.from(Si.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=Le([n,e[1]])),n})))}function qc(t,e){return t.size>0?t.size/8:t.size===0?0:Si.default.decode(e)+Si.default.decode.bytes}function xs(t){let e=[],r=0;for(;r<t.length;){let n=Si.default.decode(t,r),i=Si.default.decode.bytes,s=xe(n),o=qc(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw Md("Invalid address Uint8Array: "+Y(t,"base16"));e.push([n,a])}return e}function Go(t){let e=xs(t),r=Fc(e);return Kw(r)}function Vw(t){t=Kc(t);let e=qw(t),r=zw(e);return Uc(r)}function Od(t){return Vw(t)}function Ho(t){let e=Gw(t);if(e!=null)throw e;return Uint8Array.from(t)}function Gw(t){try{xs(t)}catch(e){return e}}function Kc(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Md(t){return new Error("Error parsing address: "+t)}function Wo(t){return xe(t[0])}var zc=H(Vo(),1);var Fd=H(Re(),1);var Ww=Symbol.for("nodejs.util.inspect.custom"),$w=[xe("ip4").code,xe("ip6").code],$o=[xe("dns").code,xe("dns4").code,xe("dns6").code,xe("dnsaddr").code],Nd=[xe("p2p").code,xe("ipfs").code],jw=[xe("tcp").code,xe("udp").code],Ud=new Map,Ld=Symbol.for("@multiformats/js-multiaddr/multiaddr"),dt=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Ld,{value:!0}),e instanceof Uint8Array)this.bytes=Ho(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Od(e)}else if(dt.isMultiaddr(e))this.bytes=Ho(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Go(this.bytes)}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),r=this.toString().split("/").slice(1),n,i;if(r.length>2)$o.includes(e[0])&&Nd.includes(e[1])?(n=xe("tcp").name,i=443):(n=xe(r[2]).name,i=parseInt(r[3]));else if($o.includes(e[0]))n=xe("tcp").name,i=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:r[1],transport:n,port:i}}protos(){return this.protoCodes().map(e=>Object.assign({},xe(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=zc.default.decode(r,n),s=zc.default.decode.bytes,o=xe(i);n+=qc(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return xs(this.bytes)}stringTuples(){let e=xs(this.bytes);return Fc(e)}encapsulate(e){return e=new dt(e),new dt(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new dt(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new dt(Uc(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===ws.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Y(Pe.decode(`z${n}`),"base58btc"):Y(ye.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>xe(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return ke(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=Ud.get(r.name);if(n==null)throw(0,Fd.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new dt(s))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1),i=xe(n[2]).code,s=parseInt(n[3]);if($o.includes(e[0])&&Nd.includes(e[1])&&(i=xe("tcp").code,s=443),n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');if(!$w.includes(e[0])&&!$o.includes(e[0]))throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns, dns4, dns6, dnsaddr}".`);if(!jw.includes(i))throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:s}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(e==null)throw new Error("requires node address object");if(r==null)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new dt("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return dt.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return Boolean(e?.[Ld])}[Ww](){return"<Multiaddr "+Y(this.bytes,"base16")+" - "+Go(this.bytes)+">"}inspect(){return"<Multiaddr "+Y(this.bytes,"base16")+" - "+Go(this.bytes)+">"}};dt.resolvers=Ud;function qd(t,e){let r=(n,i)=>n.toString().localeCompare(i.toString());return t.length===e.length&&e.sort(r)&&t.sort(r).every((n,i)=>e[i].equals(n))}var Ss;(function(t){let e;(function(n){let i;n.codec=()=>(i==null&&(i=Rr((s,o,a={})=>{if(a.lengthDelimited!==!1&&o.fork(),s.multiaddr!=null)o.uint32(10),o.bytes(s.multiaddr);else throw new Error('Protocol error: required field "multiaddr" was not found in object');a.lengthDelimited!==!1&&o.ldelim()},(s,o)=>{let a={multiaddr:new Uint8Array(0)},c=o==null?s.len:s.pos+o;for(;s.pos<c;){let f=s.uint32();switch(f>>>3){case 1:a.multiaddr=s.bytes();break;default:s.skipType(f&7);break}}if(a.multiaddr==null)throw new Error('Protocol error: value for required field "multiaddr" was not found in protobuf');return a})),i),n.encode=s=>Br(s,n.codec()),n.decode=s=>Tr(s,n.codec())})(e=t.AddressInfo||(t.AddressInfo={}));let r;t.codec=()=>(r==null&&(r=Rr((n,i,s={})=>{if(s.lengthDelimited!==!1&&i.fork(),n.peerId!=null)i.uint32(10),i.bytes(n.peerId);else throw new Error('Protocol error: required field "peerId" was not found in object');if(n.seq!=null)i.uint32(16),i.uint64(n.seq);else throw new Error('Protocol error: required field "seq" was not found in object');if(n.addresses!=null)for(let o of n.addresses)i.uint32(26),t.AddressInfo.codec().encode(o,i);else throw new Error('Protocol error: required field "addresses" was not found in object');s.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},o=i==null?n.len:n.pos+i;for(;n.pos<o;){let a=n.uint32();switch(a>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(t.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(a&7);break}}if(s.peerId==null)throw new Error('Protocol error: value for required field "peerId" was not found in protobuf');if(s.seq==null)throw new Error('Protocol error: value for required field "seq" was not found in protobuf');return s})),r),t.encode=n=>Br(n,t.codec()),t.decode=n=>Tr(n,t.codec())})(Ss||(Ss={}));var Kd="libp2p-peer-record",zd=Uint8Array.from([3,1]);var Jt=class{constructor(e){this.domain=Jt.DOMAIN,this.codec=Jt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Ss.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof Jt)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!qd(this.multiaddrs,e.multiaddrs))}};Jt.createFromProtobuf=t=>{let e=Ss.decode(t),r=an(e.peerId),n=(e.addresses??[]).map(s=>new dt(s.multiaddr)),i=e.seq;return new Jt({peerId:r,multiaddrs:n,seqNumber:i})};Jt.DOMAIN=Kd;Jt.CODEC=zd;var mr=H($d(),1);mr.default.formatters.b=t=>t==null?"undefined":Pe.baseEncode(t);mr.default.formatters.t=t=>t==null?"undefined":Ft.baseEncode(t);mr.default.formatters.m=t=>t==null?"undefined":jn.baseEncode(t);mr.default.formatters.p=t=>t==null?"undefined":t.toString();mr.default.formatters.c=t=>t==null?"undefined":t.toString();mr.default.formatters.k=t=>t==null?"undefined":t.toString();function Zo(t){return Object.assign((0,mr.default)(t),{error:(0,mr.default)(`${t}:error`),trace:(0,mr.default)(`${t}:trace`)})}var Vc=Symbol.for("@libp2p/topology");var jd=()=>{},Gc=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??jd,this.onDisconnect=e.onDisconnect??jd}get[Symbol.toStringTag](){return Vc.toString()}get[Vc](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function Jd(t){return new Gc(t)}var Mn=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Fr,Yo=class extends EventTarget{constructor(){super(...arguments),Fr.set(this,new Map)}listenerCount(e){let r=Mn(this,Fr,"f").get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let i=Mn(this,Fr,"f").get(e);i==null&&(i=[],Mn(this,Fr,"f").set(e,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let i=Mn(this,Fr,"f").get(e);i!=null&&(i=i.filter(({callback:s})=>s!==r),Mn(this,Fr,"f").set(e,i))}dispatchEvent(e){let r=super.dispatchEvent(e),n=Mn(this,Fr,"f").get(e.type);return n==null||(n=n.filter(({once:i})=>!i),Mn(this,Fr,"f").set(e.type,n)),r}};Fr=new WeakMap;var Hc=class extends Event{constructor(e,r){super(e,r),this.detail=r?.detail}},Nn=globalThis.CustomEvent??Hc;var Qo=class{constructor(e,r,n){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=n;for(let i=0;i<r;i++)this.history[i]=[]}get size(){return this.msgs.size}put(e,r,n=!1){let{msgIdStr:i}=e;return this.msgs.has(i)?!1:(this.msgs.set(i,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:r.topic}),!0)}observeDuplicate(e,r){let n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(!n)return null;let i=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,i),{msg:n.message,count:i}}getGossipIDs(e){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{let s=this.msgs.get(i.msgIdStr);if(s&&s.validated&&e.has(i.topic)){let o=r.get(i.topic);o||(o=[],r.set(i.topic,o)),o.push(i.msgId)}});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;let{message:n,originatingPeers:i}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:i}}shift(){this.history[this.history.length-1].forEach(r=>{this.msgs.delete(r.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};var Tg=H(Ag(),1),{RPC:Ii}=Tg.default;var sf="/floodsub/1.0.0",of="/meshsub/1.0.0",ta="/meshsub/1.1.0";var Bg="ERR_TOPIC_VALIDATOR_REJECT",Rg="ERR_TOPIC_VALIDATOR_IGNORE";function wr(t=[],e){return{subscriptions:[],messages:t,control:e?{graft:e.graft||[],prune:e.prune||[],ihave:e.ihave||[],iwant:e.iwant||[]}:void 0}}function xr(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}function Pg(t){return Y(t,"base64")}var Un="StrictSign",_i="StrictNoSign";var kg;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(kg||(kg={}));var ln;(function(t){t[t.Signing=0]="Signing",t[t.Anonymous=1]="Anonymous"})(ln||(ln={}));var Sr;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(Sr||(Sr={}));var ot;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(ot||(ot={}));var tt;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(tt||(tt={}));var Nt;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(Nt||(Nt={}));function af(t){switch(t){case Sr.Ignore:return ot.Ignore;case Sr.Reject:return ot.Reject}}async function uf(t,e){switch(t){case Un:{if(!e)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await Fo(e.privateKey);return{type:ln.Signing,author:e,key:e.publicKey,privateKey:r}}case _i:return{type:ln.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var pe="ERR_INVALID_PEER_SCORE_PARAMS";var de=H(Re(),1),gx={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},yx={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function Og(t={}){return{...gx,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=mx(n),e),{}):{}}}function mx(t={}){return{...yx,...t}}function Mg(t){for(let[e,r]of Object.entries(t.topics))try{vx(r)}catch(n){throw(0,de.default)(new Error(`invalid score parameters for topic ${e}: ${n.message}`),pe)}if(t.topicScoreCap<0)throw(0,de.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),pe);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw(0,de.default)(new Error("missing application specific score function"),pe);if(t.IPColocationFactorWeight>0)throw(0,de.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),pe);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw(0,de.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),pe);if(t.behaviourPenaltyWeight>0)throw(0,de.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),pe);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw(0,de.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),pe);if(t.decayInterval<1e3)throw(0,de.default)(new Error("invalid DecayInterval; must be at least 1s"),pe);if(t.decayToZero<=0||t.decayToZero>=1)throw(0,de.default)(new Error("invalid DecayToZero; must be between 0 and 1"),pe)}function vx(t){if(t.topicWeight<0)throw(0,de.default)(new Error("invalid topic weight; must be >= 0"),pe);if(t.timeInMeshQuantum===0)throw(0,de.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),pe);if(t.timeInMeshWeight<0)throw(0,de.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),pe);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw(0,de.default)(new Error("invalid TimeInMeshQuantum; must be positive"),pe);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw(0,de.default)(new Error("invalid TimeInMeshCap; must be positive"),pe);if(t.firstMessageDeliveriesWeight<0)throw(0,de.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),pe);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw(0,de.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),pe);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw(0,de.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),pe);if(t.meshMessageDeliveriesWeight>0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),pe);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw(0,de.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),pe);if(t.meshMessageDeliveriesWindow<0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),pe);if(t.meshFailurePenaltyWeight>0)throw(0,de.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),pe);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw(0,de.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),pe);if(t.invalidMessageDeliveriesWeight>0)throw(0,de.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),pe);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw(0,de.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),pe)}var bx=H(Re(),1),wx={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function Ng(t={}){return{...wx,...t}}function Lg(t,e,r,n){let i=0;if(Object.entries(e.topics).forEach(([o,a])=>{let c=r.topics[o];if(c===void 0)return;let f=0;if(a.inMesh){let d=a.meshTime/c.timeInMeshQuantum;d>c.timeInMeshCap&&(d=c.timeInMeshCap),f+=d*c.timeInMeshWeight}let u=a.firstMessageDeliveries;if(u>c.firstMessageDeliveriesCap&&(u=c.firstMessageDeliveriesCap),f+=u*c.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<c.meshMessageDeliveriesThreshold){let d=c.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;f+=d*d*c.meshMessageDeliveriesWeight}f+=a.meshFailurePenalty*c.meshFailurePenaltyWeight,f+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*c.invalidMessageDeliveriesWeight,i+=f*c.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),c=a?a.size:0;if(c>r.IPColocationFactorThreshold){let f=c-r.IPColocationFactorThreshold;i+=f*f*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let o=e.behaviourPenalty-r.behaviourPenaltyThreshold;i+=o*o*r.behaviourPenaltyWeight}return i}var qg=H(Ug(),1),at;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(at||(at={}));var ra=class{constructor(){this.records=new Map,this.queue=new qg.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:at.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};var mt=H(Re(),1);function qn(t){return t!=null&&typeof t.start=="function"&&typeof t.stop=="function"}function yt(t){return t!=null&&typeof t.init=="function"}var Ai=class{constructor(e={}){this.started=!1,e.peerId!=null&&this.setPeerId(e.peerId),e.addressManager!=null&&this.setAddressManager(e.addressManager),e.peerStore!=null&&this.setPeerStore(e.peerStore),e.upgrader!=null&&this.setUpgrader(e.upgrader),e.metrics!=null&&this.setMetrics(e.metrics),e.registrar!=null&&this.setRegistrar(e.registrar),e.connectionManager!=null&&this.setConnectionManager(e.connectionManager),e.transportManager!=null&&this.setTransportManager(e.transportManager),e.connectionGater!=null&&this.setConnectionGater(e.connectionGater),e.contentRouting!=null&&this.setContentRouting(e.contentRouting),e.peerRouting!=null&&this.setPeerRouting(e.peerRouting),e.datastore!=null&&this.setDatastore(e.datastore),e.connectionProtector!=null&&this.setConnectionProtector(e.connectionProtector),e.dht!=null&&this.setDHT(e.dht),e.pubsub!=null&&this.setPubSub(e.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{e.beforeStart!=null&&await e.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{await e.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{e.afterStart!=null&&await e.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{e.beforeStop!=null&&await e.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{await e.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(e=>qn(e)).map(async e=>{e.afterStop!=null&&await e.afterStop()}))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(this.peerId==null)throw(0,mt.default)(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,yt(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,yt(e)&&e.init(this),e}getAddressManager(){if(this.addressManager==null)throw(0,mt.default)(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,yt(e)&&e.init(this),e}getPeerStore(){if(this.peerStore==null)throw(0,mt.default)(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,yt(e)&&e.init(this),e}getUpgrader(){if(this.upgrader==null)throw(0,mt.default)(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,yt(e)&&e.init(this),e}getRegistrar(){if(this.registrar==null)throw(0,mt.default)(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,yt(e)&&e.init(this),e}getConnectionManager(){if(this.connectionManager==null)throw(0,mt.default)(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,yt(e)&&e.init(this),e}getTransportManager(){if(this.transportManager==null)throw(0,mt.default)(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,yt(e)&&e.init(this),e}getConnectionGater(){if(this.connectionGater==null)throw(0,mt.default)(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,yt(e)&&e.init(this),e}getContentRouting(){if(this.contentRouting==null)throw(0,mt.default)(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,yt(e)&&e.init(this),e}getPeerRouting(){if(this.peerRouting==null)throw(0,mt.default)(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,yt(e)&&e.init(this),e}getDatastore(){if(this.datastore==null)throw(0,mt.default)(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,yt(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,yt(e)&&e.init(this),e}getDHT(){if(this.dht==null)throw(0,mt.default)(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,yt(e)&&e.init(this),e}getPubSub(){if(this.pubsub==null)throw(0,mt.default)(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}};var Ti=Zo("libp2p:gossipsub:score"),na=class{constructor(e,r,n){this.params=e,this.metrics=r,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new ra,this.components=new Ai,Mg(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??Lg}init(e){this.components=e}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){Ti("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),Ti("started")}stop(){if(!this._backgroundInterval){Ti("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),Ti("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this.removeIPs(i,n.ips),this.peerStats.delete(i),this.scoreCache.delete(i));return}Object.entries(n.topics).forEach(([s,o])=>{let a=this.params.topics[s];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),i=this.scoreCache.get(e);if(i&&i.cacheUntil>n)return i.score;this.metrics?.scoreFnRuns.inc();let s=this.computeScore(e,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return i?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-i.score)),i.score=s,i.cacheUntil=o):this.scoreCache.set(e,{score:s,cacheUntil:o}),s}addPenalty(e,r,n){let i=this.peerStats.get(e);i&&(i.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,r);let n=this.getIPs(e);this.setIPs(e,n,r.ips),r.ips=n}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this.removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let s=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1,i.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.meshMessageDeliveriesActive=!1,i.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let i=this.deliveryRecords.ensureRecord(r),s=Date.now();if(i.status!==at.unknown){Ti("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-i.firstSeen,at[i.status]);return}i.status=at.valid,i.validated=s,i.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,i){switch(i){case ot.Error:this.markInvalidMessageDelivery(e,n);return;case ot.Blacklisted:return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==at.unknown){Ti("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,at[s.status]);return}if(i===ot.Ignore){s.status=at.ignored,s.peers.clear();return}s.status=at.invalid,this.markInvalidMessageDelivery(e,n),s.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),s.peers.clear()}duplicateMessage(e,r,n){let i=this.deliveryRecords.ensureRecord(r);if(!i.peers.has(e))switch(i.status){case at.unknown:i.peers.add(e);break;case at.valid:i.peers.add(e),this.markDuplicateMessageDelivery(e,n,i.validated);break;case at.invalid:this.markInvalidMessageDelivery(e,n);break;case at.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].firstMessageDeliveriesCap;i.firstMessageDeliveries=Math.min(s,i.firstMessageDeliveries+1),i.inMesh&&(s=this.params.topics[r].meshMessageDeliveriesCap,i.meshMessageDeliveries=Math.min(s,i.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let i=this.peerStats.get(e);if(i){let s=n!==void 0?Date.now():0,o=this.getPtopicStats(i,r);if(o&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let f=s-n,u=f>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,f,u),u)return}let c=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(c,o.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(Lr(e)).map(r=>r.remoteAddr.toOptions().host)}setIPs(e,r,n){e:for(let i of r){for(let o of n)if(i===o)continue e;let s=this.peerIPs.get(i);s||(s=new Set,this.peerIPs.set(i,s)),s.add(e)}e:for(let i of n){for(let o of r)if(i===o)continue e;let s=this.peerIPs.get(i);!s||(s.delete(e),s.size||this.peerIPs.delete(i))}}removeIPs(e,r){r.forEach(n=>{let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))})}updateIPs(){this.peerStats.forEach((e,r)=>{let n=this.getIPs(r);this.setIPs(r,n,e.ips),e.ips=n})}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};var ia=class{constructor(e,r,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=r,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],s=this.msgIdToStrFn(i),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o));let a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(s)||this.requestMsByMsg.set(s,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((i,s)=>{i.forEach((o,a)=>{o<e&&(r.set(a,(r.get(a)??0)+1),i.delete(a),n++)}),i.size||this.promises.delete(s)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e){this.trackMessage(e);let r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case ot.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[r,n]of this.requestMsByMsg.entries())if(n<e)this.requestMsByMsg.delete(r);else break}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};var Bi=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs})}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var Kg;(function(t){t.forward="forward",t.publish="publish"})(Kg||(Kg={}));var Ur;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(Ur||(Ur={}));var Kn;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Unsub="unsubscribed",t.Excess="excess"})(Kn||(Kn={}));var Pi;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(Pi||(Pi={}));var ki;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(ki||(ki={}));var Ri;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(Ri||(Ri={}));function zg(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,i,s){let o=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:o,reason:i},s)},onRemoveFromMesh(n,i,s){let o=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:o,reason:i},s)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,i){let s=this.toTopic(n);this.asyncValidationResult.inc({topic:s,acceptance:i})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,i,s){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},i),this.ihaveRcvNotSeenMsgids.inc({topic:o},s)},onIwantRcv(n,i){for(let[s,o]of n){let a=this.toTopic(s);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(i)},onForwardMsg(n,i){let s=this.toTopic(n);this.msgForwardCount.inc({topic:s},1),this.msgForwardPeers.inc({topic:s},i)},onPublishMsg(n,i,s,o){let a=this.toTopic(n);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},s*o),this.msgPublishPeers.inc({topic:a},s),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"direct"},i.direct),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"floodsub"},i.floodsub),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"mesh"},i.mesh),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"fanout"},i.fanout)},onMsgRecvPreValidation(n){let i=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:i},1)},onMsgRecvResult(n,i){let s=this.toTopic(n);this.msgReceivedStatus.inc({topic:s,status:i})},onMsgRecvInvalid(n,i){let s=this.toTopic(n),o=i.reason===ot.Error?i.error:i.reason;this.msgReceivedInvalid.inc({topic:s,error:o},1)},onDuplicateMsgDelivery(n,i,s){if(this.duplicateMsgDeliveryDelay.observe(i/1e3),s){let o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onRpcRecv(n,i){this.rpcRecvBytes.inc(i),this.rpcRecvCount.inc(1),n.subscriptions&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages&&this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),n.control.ihave&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,i){if(this.rpcSentBytes.inc(i),this.rpcSentCount.inc(1),n.subscriptions&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages&&this.rpcSentMessage.inc(n.messages.length),n.control){let s=n.control.ihave?.length??0,o=n.control.iwant?.length??0,a=n.control.graft?.length??0,c=n.control.prune?.length??0;s>0&&this.rpcSentIHave.inc(s),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),c>0&&this.rpcSentPrune.inc(c),(s>0||o>0||a>0||c>0)&&this.rpcSentControl.inc(1)}},registerScores(n,i){let s=0,o=0,a=0,c=0;for(let f of n)f>=i.graylistThreshold&&s++,f>=i.publishThreshold&&o++,f>=i.gossipThreshold&&a++,f>=0&&c++;this.peersByScoreThreshold.set({threshold:Ri.graylist},s),this.peersByScoreThreshold.set({threshold:Ri.publish},o),this.peersByScoreThreshold.set({threshold:Ri.gossip},a),this.peersByScoreThreshold.set({threshold:Ri.mesh},c),this.score.set(n)},registerScoreWeights(n){for(let[i,s]of n.byTopic)this.scoreWeights.set({topic:i,p:"p1"},s.p1w),this.scoreWeights.set({topic:i,p:"p2"},s.p2w),this.scoreWeights.set({topic:i,p:"p3"},s.p3w),this.scoreWeights.set({topic:i,p:"p3b"},s.p3bw),this.scoreWeights.set({topic:i,p:"p4"},s.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,i){let s=new Map;n.forEach((o,a)=>{let c=this.topicStrToLabel.get(a)??"unknown",f=s.get(c);f||(f=new Set,s.set(c,f)),o.forEach(u=>f?.add(u))});for(let[o,a]of s){let c=[];a.forEach(f=>{c.push(i.get(f)??0)}),this.scorePerMesh.set({topic:o},c)}}}}var LC=H(mo(),1),Sx=H(le(),1);var Dx=H(Re(),1);var Ix=H($u(),1),_x=H(Ne(),1),Ax=H(Re(),1);var Vg=Te("libp2p-pubsub:");async function Gg(t,e,r,n){switch(t.type){case ln.Signing:{let i={from:t.author.toBytes(),data:n,seqno:tn(8),topic:e,signature:void 0,key:void 0},s=Le([Vg,Ii.Message.encode(i).finish()]);i.signature=await t.privateKey.sign(s),i.key=t.key;let o={type:"signed",from:t.author,data:r,sequenceNumber:BigInt(`0x${Y(i.seqno,"base16")}`),topic:e,signature:i.signature,key:i.key};return{raw:i,msg:o}}case ln.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:e,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:e}}}}async function Hg(t,e){switch(t){case _i:return e.signature!=null?{valid:!1,error:tt.SignaturePresent}:e.seqno!=null?{valid:!1,error:tt.SeqnoPresent}:e.key!=null?{valid:!1,error:tt.FromPresent}:{valid:!0,message:{type:"unsigned",topic:e.topic,data:e.data??new Uint8Array(0)}};case Un:{if(e.seqno==null)return{valid:!1,error:tt.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:tt.InvalidSeqno};if(e.signature==null)return{valid:!1,error:tt.InvalidSignature};if(e.from==null)return{valid:!1,error:tt.InvalidPeerId};let r;try{r=an(e.from)}catch{return{valid:!1,error:tt.InvalidPeerId}}let n;if(e.key){if(n=ms(e.key),r.publicKey!==void 0&&!ke(n.bytes,r.publicKey))return{valid:!1,error:tt.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:tt.InvalidPeerId};n=ms(r.publicKey)}let i={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},s=Le([Vg,Ii.Message.encode(i).finish()]);return await n.verify(s,e.signature)?{valid:!0,message:{type:"signed",from:r,data:e.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${Y(e.seqno,"base16")}`),topic:e.topic,signature:e.signature,key:e.key??id(n)}}:{valid:!1,error:tt.InvalidSignature}}}}var Tx=H(Re(),1);var Wg=(t,e)=>{let r=Te(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function $g(t){if(t.type!=="signed")throw new Error("expected signed message type");if(t.sequenceNumber==null)throw Error("missing seqno field");return Wg(t.from.toBytes(),t.sequenceNumber)}async function jg(t){return await qe.encode(t.data)}function Bx(t,e,r,n,i){let s=0,o=new Map;if(Object.entries(e.topics).forEach(([l,d])=>{let p=i.get(l)??"unknown",g=r.topics[l];if(g===void 0)return;let y=o.get(p);y||(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,y));let v=0,x=0,C=0,D=0,w=0;d.inMesh&&(v+=Math.max(d.meshTime/g.timeInMeshQuantum,g.timeInMeshCap)*g.timeInMeshWeight);let S=d.firstMessageDeliveries;if(S>g.firstMessageDeliveriesCap&&(S=g.firstMessageDeliveriesCap),x+=S*g.firstMessageDeliveriesWeight,d.meshMessageDeliveriesActive&&d.meshMessageDeliveries<g.meshMessageDeliveriesThreshold){let q=g.meshMessageDeliveriesThreshold-d.meshMessageDeliveries;C+=q*q*g.meshMessageDeliveriesWeight}D+=d.meshFailurePenalty*g.meshFailurePenaltyWeight,w+=d.invalidMessageDeliveries*d.invalidMessageDeliveries*g.invalidMessageDeliveriesWeight,s+=(v+x+C+D+w)*g.topicWeight,y.p1w+=v,y.p2w+=x,y.p3w+=C,y.p3bw+=D,y.p4w+=w}),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;let l=r.topicScoreCap/s;for(let d of o.values())d.p1w*=l,d.p2w*=l,d.p3w*=l,d.p3bw*=l,d.p4w*=l}let a=0,c=0,f=0;return a+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let d=n.get(l),p=d?d.size:0;if(p>r.IPColocationFactorThreshold){let g=p-r.IPColocationFactorThreshold;c+=g*g*r.IPColocationFactorWeight}}),f+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,s+=a+c+f,{byTopic:o,p5w:a,p6w:c,p7w:f,score:s}}function Jg(t,e,r,n,i){let s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of t){let a=e.get(o);if(a){let c=Bx(o,a,r,n,i);for(let[f,u]of c.byTopic){let h=s.byTopic.get(f);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(f,h)),h.p1w.push(u.p1w),h.p2w.push(u.p2w),h.p3w.push(u.p3w),h.p3bw.push(u.p3bw),h.p4w.push(u.p4w)}s.p5w.push(c.p5w),s.p6w.push(c.p6w),s.p7w.push(c.p7w),s.score.push(c.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}function sa(t,e,r=()=>!0){let n=new Set;if(e<=0)return n;for(let i of t){if(n.size>=e)break;r(i)&&(n.add(i),t.delete(i))}return n}function Zg(t,e){return sa(t,e,()=>!0)}var _s=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Yg(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function cf(t,e,r){let n=r??{},i=Yg(t);async function*s(){let o,a=()=>{o?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:u,abortCode:h}=n;throw new _s(u,h)}let f=new Promise((u,h)=>{o=()=>{let{abortMessage:l,abortCode:d}=n;h(new _s(l,d))}});c=await Promise.race([f,i.next()]),o=null}catch(f){e.removeEventListener("abort",a);let u=f.type==="aborted"&&e.aborted;if(u&&n.onAbort!=null&&await n.onAbort(t),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(u&&n.returnOnAbort===!0)return;throw f}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return s()}function Qg(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}var oa=t=>{let e=$t.encodingLength(t),r=Qg(e);return $t.encode(t,r),oa.bytes=e,r};oa.bytes=0;function aa(t){t=t??{};let e=t.lengthEncoder??oa;return async function*(n){for await(let i of n){let s=e(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}}}aa.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??oa;return new kt(r(t.byteLength),t)};var As=H(Re(),1),Rx=8,Px=1024*1024*4,zn;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(zn||(zn={}));var ff=t=>{let e=$t.decode(t);return ff.bytes=$t.encodingLength(e),e};ff.bytes=0;function Ts(t){return async function*(r){let n=new kt,i=zn.LENGTH,s=-1,o=t?.lengthDecoder??ff,a=t?.maxLengthLength??Rx,c=t?.maxDataLength??Px;for await(let f of r)for(n.append(f);n.byteLength>0;){if(i===zn.LENGTH)try{if(s=o(n),s<0)throw(0,As.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>c)throw(0,As.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=o.bytes;n.consume(u),t?.onLength!=null&&t.onLength(s),i=zn.DATA}catch(u){if(u instanceof RangeError){if(n.byteLength>a)throw(0,As.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(i===zn.DATA){if(n.byteLength<s)break;let u=n.sublist(0,s);n.consume(s),t?.onData!=null&&t.onData(u),yield u,i=zn.LENGTH}}if(n.byteLength>0)throw(0,As.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}Ts.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await t.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return Ts({...e??{},onLength:s=>{r=s}})(n)};var ua=class{constructor(e,r,n){this.rawStream=e,this.pushable=pn({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,Wn(cf(this.pushable,this.closeController.signal,{returnOnAbort:!0}),aa(),this.rawStream).catch(r)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}},ca=class{constructor(e){this.rawStream=e,this.closeController=new AbortController,this.source=cf(Wn(this.rawStream,Ts()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}};var oS=ta,Dt;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(Dt||(Dt={}));var fa=class extends Yo{constructor(e={}){super(),this.multicodecs=[ta,of],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=pn({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new Ai,this.directPeerInitial=null,this.status={code:Dt.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let n=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(i=>{this.log("Error running heartbeat",i)}).finally(()=>{if(n?.(),this.status.code===Dt.started){clearTimeout(this.status.heartbeatTimeout);let i=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;i<this.opts.heartbeatInterval*.25&&(i+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,i)}})};let r={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:Og(e.scoreParams),scoreThresholds:Ng(e.scoreThresholds)};if(this.globalSignaturePolicy=r.globalSignaturePolicy??Un,r.fallbackToFloodsub&&this.multicodecs.push(sf),this.log=Zo(r.debugName??"libp2p:gossipsub"),this.opts=r,this.direct=new Set(r.directPeers.map(n=>n.id.toString())),this.seenCache=new Bi({validityMs:r.seenTTL}),this.publishedMessageIds=new Bi({validityMs:r.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case Un:this.msgIdFn=$g;break;case _i:this.msgIdFn=jg;break}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new Bi({validityMs:r.seenTTL})),this.msgIdToStrFn=e.msgIdToStrFn??Pg,this.mcache=e.messageCache||new Qo(r.mcacheGossip,r.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let n=Math.max(...Object.values(r.scoreParams.topics).map(s=>s.meshMessageDeliveriesWindow),1e3),i=zg(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:r.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:n/1e3});i.mcacheSize.addCollect(()=>this.onScrapeMetrics(i));for(let s of this.multicodecs)i.protocolsEnabled.set({protocol:s},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new ia(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new na(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:r.heartbeatInterval}),this.maxInboundStreams=e.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map(e=>Lr(e))}isStarted(){return this.status.code===Dt.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await uf(this.globalSignaturePolicy,this.components.getPeerId()),this.outboundInflightQueue=pn({objectMode:!0}),Wn(this.outboundInflightQueue,async s=>{for await(let{peerId:o,connection:a}of s)await this.createOutboundStream(o,a)}).catch(s=>this.log.error("outbound inflight queue error",s)),await Promise.all(this.opts.directPeers.map(async s=>{await this.components.getPeerStore().addressBook.add(s.id,s.addrs)}));let e=this.components.getRegistrar();await Promise.all(this.multicodecs.map(s=>e.handle(s,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r=Jd({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),n=await Promise.all(this.multicodecs.map(s=>e.register(s,r))),i=setTimeout(this.runHeartbeat,100);this.status={code:Dt.started,registrarTopologyIds:n,heartbeatTimeout:i,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async s=>await this.connect(s)))}).catch(s=>{this.log(s)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==Dt.started)return;let{registrarTopologyIds:e}=this.status;this.status={code:Dt.stopped};let r=this.components.getRegistrar();e.forEach(n=>r.unregister(n)),this.outboundInflightQueue.end();for(let n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(let n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.stat.direction),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(e,r){!this.isStarted()||(this.addPeer(e,r.stat.direction),this.outboundInflightQueue.push({peerId:e,connection:r}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!!this.peers.has(n)&&!this.streamsOutbound.has(n))try{let i=new ua(await r.newStream(this.multicodecs),o=>this.log.error("outbound pipe error",o),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,i);let s=i.protocol;s===sf&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(i){this.log.error("createOutboundStream error",i)}}async createInboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!this.peers.has(n))return;let i=this.streamsInbound.get(n);i!==void 0&&(this.log("replacing existing inbound steam %s",n),i.close()),this.log("create inbound stream %s",n);let s=new ca(r);this.streamsInbound.set(n,s),this.pipePeerReadStream(e,s.source).catch(o=>this.log(o))}addPeer(e,r){let n=e.toString();this.peers.has(n)||(this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n),this.outbound.has(n)||this.outbound.set(n,r==="outbound"))}removePeer(e){let r=e.toString();if(!this.peers.has(r))return;this.log("delete peer %p",e),this.peers.delete(r);let n=this.streamsOutbound.get(r),i=this.streamsInbound.get(r);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),i?.close(),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let s of this.topics.values())s.delete(r);for(let[s,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(s,Kn.Dc,1);for(let s of this.fanout.values())s.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===Dt.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r?Array.from(r):[]).map(n=>Lr(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await Wn(r,async n=>{for await(let i of n)try{let s=i.subarray(),o=Ii.decode(s);this.metrics?.onRpcRecv(o,s.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,o):this.handleReceivedRpc(e,o).catch(a=>this.log(a))}catch(s){this.log(s)}})}catch(n){this.log.error(n),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %p",e),r.subscriptions&&r.subscriptions.length>0&&(r.subscriptions.forEach(n=>{this.handleReceivedSubscription(e,n)}),this.dispatchEvent(new Nn("subscription-change",{detail:{peerId:e,subscriptions:r.subscriptions.filter(n=>n.topic!==null).map(n=>({topic:n.topic??"",subscribe:Boolean(n.subscribe)}))}}))),r.messages)for(let n of r.messages){let i=this.handleReceivedMessage(e,n).catch(s=>this.log(s));this.opts.awaitRpcMessageHandler&&await i}r.control&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r){if(r.topic==null)return;this.log("subscription update from %p topic %s",e,r.topic);let n=this.topics.get(r.topic);n==null&&(n=new Set,this.topics.set(r.topic,n)),r.subscribe?n.add(e.toString()):n.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,n.code),n.code){case Nt.duplicate:this.score.duplicateMessage(e.toString(),n.msgIdStr,r.topic),this.mcache.observeDuplicate(n.msgIdStr,e.toString());return;case Nt.invalid:if(n.msgIdStr){let i=n.msgIdStr;this.score.rejectMessage(e.toString(),i,r.topic,n.reason),this.gossipTracer.rejectMessage(i,n.reason)}else this.score.rejectInvalidMessage(e.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case Nt.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.getPeerId().equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new Nn("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new Nn("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,e.toString())}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),i=n?this.fastMsgIdCache?.get(n):void 0;if(i)return{code:Nt.duplicate,msgIdStr:i};let s=await Hg(this.globalSignaturePolicy,r);if(!s.valid)return{code:Nt.invalid,reason:ot.Error,error:s.error};let o=s.message;try{this.dataTransform&&(o.data=this.dataTransform.inboundTransform(r.topic,o.data))}catch(h){return this.log("Invalid message, transform failed",h),{code:Nt.invalid,reason:ot.Error,error:tt.TransformFailed}}let a=await this.msgIdFn(o),c=this.msgIdToStrFn(a),f={msgId:a,msgIdStr:c};if(n&&this.fastMsgIdCache?.put(n,c),this.seenCache.has(c))return{code:Nt.duplicate,msgIdStr:c};this.seenCache.put(c);let u=this.topicValidators.get(r.topic);if(u!=null){let h;try{h=await u(o.topic,o,e)}catch(l){let d=l.code;d===Rg&&(h=Sr.Ignore),d===Bg?h=Sr.Reject:h=Sr.Ignore}if(h!==Sr.Accept)return{code:Nt.invalid,reason:af(h),msgIdStr:c}}return{code:Nt.valid,messageId:f,msg:o}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(i=>({topic:i,subscribe:n})),messages:[]})}async handleControlMessage(e,r){if(r===void 0)return;let n=r.ihave?this.handleIHave(e,r.ihave):[],i=r.iwant?this.handleIWant(e,r.iwant):[],s=r.graft?await this.handleGraft(e,r.graft):[];r.prune&&await this.handlePrune(e,r.prune),!(!n.length&&!i.length&&!s.length)&&this.sendRpc(e,wr(i,{iwant:n,prune:s}))}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let i=this.score.score(e);return i>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),i>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:ki.LowScore}),[];let i=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,i),i>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:ki.MaxIhave}),[];let s=this.iasked.get(e)??0;if(s>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:ki.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:f,messageIDs:u})=>{if(!f||!u||!this.mesh.has(f))return;let h=0;u.forEach(l=>{let d=this.msgIdToStrFn(l);this.seenCache.has(d)||(o.set(d,l),h++)}),this.metrics?.onIhaveRcv(f,u.length,h)}),!o.size)return[];let a=o.size;a+s>5e3&&(a=5e3-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return xr(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map,s=new Map,o=0;return r.forEach(({messageIDs:a})=>{a&&a.forEach(c=>{let f=this.msgIdToStrFn(c),u=this.mcache.getWithIWantCount(f,e);if(u==null){o++;return}if(s.set(u.msg.topic,1+(s.get(u.msg.topic)??0)),u.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,c);return}i.set(f,u.msg)})}),this.metrics?.onIwantRcv(s,o),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,r){let n=[],i=this.score.score(e),s=Date.now(),o=this.opts.doPX;return r.forEach(({topicID:a})=>{if(!a)return;let c=this.mesh.get(a);if(!c){o=!1;return}if(c.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(a),o=!1;return}let f=this.backoff.get(a)?.get(e);if(typeof f=="number"&&s<f){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,Pi.GraftBackoff),o=!1;let u=f+this.opts.graftFloodThreshold-this.opts.pruneBackoff;s<u&&this.score.addPenalty(e,1,Pi.GraftBackoff),this.addBackoff(e,a),n.push(a);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,a),n.push(a),o=!1,this.addBackoff(e,a);return}if(c.size>=this.opts.Dhi&&!this.outbound.get(e)){n.push(a),this.addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),c.add(e),this.metrics?.onAddToMesh(a,Ur.Subscribed,1)}),n.length?await Promise.all(n.map(a=>this.makePrune(e,a,o))):[]}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:i,backoff:s,peers:o}of r){if(i==null)continue;let a=this.mesh.get(i);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(i,Kn.Unsub,1)),typeof s=="number"&&s>0?this.doAddBackoff(e,i,s*1e3):this.addBackoff(e,i),o&&o.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);continue}await this.pxConnect(o)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let s=Date.now()+n;(i.get(e)??0)<s&&i.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,Pi.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((i,s)=>{i<e&&r.delete(s)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||e.push(r)}),await Promise.all(e.map(async r=>await this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(xr(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(!n.peerID)return;let i=an(n.peerID).toString();if(!this.peers.has(i)){if(!n.signedPeerRecord){r.push(i);return}try{let s=await Ot.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),o=s.peerId;if(!s.peerId.equals(i)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",o,i);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(s)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(i)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e);let r=Lr(e),n=await this.components.getConnectionManager().openConnection(r);for(let i of this.multicodecs)for(let s of this.components.getRegistrar().getTopologies(i))s.onConnect(r,n)}subscribe(e){if(this.status.code!==Dt.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==Dt.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e).catch(n=>{this.log(n)})}join(e){if(this.status.code!==Dt.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach(i=>{!this.direct.has(i)&&this.score.score(i)>=0&&r.add(i)}),this.metrics?.onAddToMesh(e,Ur.Fanout,r.size)),r.size<this.opts.D){let i=r.size;this.getRandomGossipPeers(e,this.opts.D,o=>!r.has(o)&&!this.direct.has(o)&&this.score.score(o)>=0).forEach(o=>{r.add(o)}),this.metrics?.onAddToMesh(e,Ur.Random,r.size-i)}this.mesh.set(e,r),r.forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this.sendGraft(i,e)})}async leave(e){if(this.status.code!==Dt.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(await Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)))),this.mesh.delete(e))}selectPeersToForward(e,r,n){let i=new Set,s=this.topics.get(e);s&&(this.direct.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&i.add(a)}),this.floodsubPeers.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&i.add(a)}));let o=this.mesh.get(e);return o&&o.size>0&&o.forEach(a=>{r!==a&&!n?.has(a)&&i.add(a)}),i}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},i=this.topics.get(e);if(i)if(this.opts.floodPublish)i.forEach(s=>{this.direct.has(s)?(r.add(s),n.direct++):this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(r.add(s),n.floodsub++)});else{this.direct.forEach(o=>{i.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{i.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let s=this.mesh.get(e);if(s&&s.size>0)s.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(e);if(o&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,c=>this.score.score(c)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(c=>{r.add(c),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,i){n&&this.score.deliverMessage(n,e,r.topic);let s=this.selectPeersToForward(r.topic,n,i),o=wr([r]);s.forEach(a=>{this.sendRpc(a,o)}),this.metrics?.onForwardMsg(r.topic,s.size)}async publish(e,r){let n=this.dataTransform?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let{raw:i,msg:s}=await Gg(this.publishConfig,e,r,n),o=await this.msgIdFn(s),a=this.msgIdToStrFn(o);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");let{tosend:c,tosendCount:f}=this.selectPeersToPublish(e),u=this.opts.emitSelf===!0&&this.subscriptions.has(e);if(c.size===0&&!this.opts.allowPublishToZeroPeers&&!u)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},i,!0),this.publishedMessageIds.put(a);let h=wr([i]);for(let l of c)this.sendRpc(l,h)||c.delete(l);return this.metrics?.onPublishMsg(e,f,c.size,i.data!=null?i.data.length:0),u&&(c.add(this.components.getPeerId().toString()),super.dispatchEvent(new Nn("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:a,msg:s}})),super.dispatchEvent(new Nn("message",{detail:s}))),{recipients:Array.from(c.values()).map(l=>Lr(l))}}reportMessageValidationResult(e,r,n){if(n===Sr.Accept){let i=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i!=null){let{message:s,originatingPeers:o}=i;this.score.deliverMessage(r.toString(),e,s.topic),this.forwardMessage(e,i.message,r.toString(),o),this.metrics?.onReportValidation(s.topic,n)}}else{let i=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i){let s=af(n),{message:o,originatingPeers:a}=i;this.score.rejectMessage(r.toString(),e,o.topic,s);for(let c of a)this.score.rejectMessage(c,e,o.topic,s);this.metrics?.onReportValidation(o.topic,n)}}}sendGraft(e,r){let i=wr([],{graft:[{topicID:r}]});this.sendRpc(e,i)}async sendPrune(e,r){let n=[await this.makePrune(e,r,this.opts.doPX)],i=wr([],{prune:n});this.sendRpc(e,i)}sendRpc(e,r){let n=this.streamsOutbound.get(e);if(!n)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let i=this.control.get(e);i&&(this.piggybackControl(e,r,i),this.control.delete(e));let s=this.gossip.get(e);s&&(this.piggybackGossip(e,r,s),this.gossip.delete(e));let o=Ii.encode(r).finish();try{n.push(o)}catch(a){return this.log.error(`Cannot send rpc to ${e}`,a),i&&this.control.set(e,i),s&&this.gossip.set(e,s),!1}return this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(e,r,n){let i=(n.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(n.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!i.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(i),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={graft:i,prune:s,ihave:[],iwant:[]})}piggybackGossip(e,r,n){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=n}async sendGraftPrune(e,r,n){let i=this.opts.doPX;for(let[s,o]of e){let a=o.map(h=>({topicID:h})),c=[],f=r.get(s);f&&(c=await Promise.all(f.map(async h=>await this.makePrune(s,h,i&&!(n.get(s)??!1)))),r.delete(s));let u=wr([],{graft:a,prune:c});this.sendRpc(s,u)}for(let[s,o]of r){let a=await Promise.all(o.map(async f=>await this.makePrune(s,f,i&&!(n.get(s)??!1)))),c=wr([],{prune:a});this.sendRpc(s,c)}}emitGossip(e){let r=this.mcache.getGossipIDs(new Set(e.keys()));for(let[n,i]of e)this.doEmitGossip(n,i,r.get(n)??[])}doEmitGossip(e,r,n){if(!n.length||(xr(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!r.size))return;let i=this.opts.Dlazy,s=.25*r.size,o=r;s>i&&(i=s),i>o.size?i=o.size:o=xr(Array.from(o)).slice(0,i),o.forEach(a=>{let c=n;n.length>5e3&&(c=xr(c.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:c})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,wr([],{ihave:r}));for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,wr([],{graft:r.graft,prune:r.prune}))}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n){if(this.score.prune(e,r),this.streamsOutbound.get(e).protocol===of)return{topicID:r,peers:[]};let i=this.opts.pruneBackoff/1e3;if(!n)return{topicID:r,peers:[],backoff:i};let s=this.getRandomGossipPeers(r,this.opts.prunePeers,a=>a!==e&&this.score.score(a)>=0),o=await Promise.all(Array.from(s).map(async a=>{let c=Lr(a);return{peerID:c.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(c)}}));return{topicID:r,peers:o,backoff:i}}async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:s,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,c=p=>{let g=a.get(p);return g===void 0&&(g=this.score.score(p),a.set(p,g)),g},f=new Map,u=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,g)=>{let y=this.topics.get(g),v=new Set,x=new Set;if(l.set(g,x),y){let w=xr(Array.from(y)),S=this.backoff.get(g);for(let P of w){let L=this.streamsOutbound.get(P);if(L&&this.multicodecs.includes(L.protocol)&&!p.has(P)&&!this.direct.has(P)){let q=c(P);(!S||!S.has(P))&&q>=0&&v.add(P),q>=this.opts.scoreThresholds.gossipThreshold&&x.add(P)}}}let C=(w,S)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",w,g),this.addBackoff(w,g),p.delete(w),c(w)>=this.opts.scoreThresholds.gossipThreshold&&x.add(w),this.metrics?.onRemoveFromMesh(g,S,1);let P=u.get(w);P?P.push(g):u.set(w,[g])},D=(w,S)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",w,g),this.score.graft(w,g),p.add(w),x.delete(w),this.metrics?.onAddToMesh(g,S,1);let P=f.get(w);P?P.push(g):f.set(w,[g])};if(p.forEach(w=>{let S=c(w);S<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",w,S,g),C(w,Kn.BadScore),h.set(w,!0))}),p.size<r){let w=e-p.size;Zg(v,w).forEach(P=>{D(P,Ur.NotEnough)})}if(p.size>n){let w=Array.from(p);w.sort((P,L)=>c(L)-c(P)),w=w.slice(0,i).concat(xr(w.slice(i)));let S=0;if(w.slice(0,e).forEach(P=>{this.outbound.get(P)&&S++}),S<s){let P=q=>{let J=w[q];for(let he=q;he>0;he--)w[he]=w[he-1];w[0]=J};if(S>0){let q=S;for(let J=1;J<e&&q>0;J++)this.outbound.get(w[J])&&(P(J),q--)}let L=e-S;for(let q=e;q<w.length&&L>0;q++)this.outbound.get(w[q])&&(P(q),L--)}w.slice(e).forEach(P=>{C(P,Kn.Excess)})}if(p.size>=r){let w=0;if(p.forEach(S=>{this.outbound.get(S)&&w++}),w<s){let S=s-w;sa(v,S,L=>this.outbound.get(L)===!0).forEach(L=>{D(L,Ur.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let w=Array.from(p).sort((L,q)=>c(L)-c(q)),S=Math.floor(p.size/2),P=c(w[S]);if(P<this.opts.scoreThresholds.opportunisticGraftThreshold){let L=this.opts.opportunisticGraftPeers,q=sa(v,L,J=>c(J)>P);for(let J of q)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",J,g),D(J,Ur.Opportunistic)}}});let d=Date.now();this.fanoutLastpub.forEach((p,g)=>{p+o<d&&(this.fanout.delete(g),this.fanoutLastpub.delete(g))}),this.fanout.forEach((p,g)=>{let y=this.topics.get(g);p.forEach(D=>{(!y.has(D)||c(D)<this.opts.scoreThresholds.publishThreshold)&&p.delete(D)});let v=this.topics.get(g),x=[],C=new Set;if(l.set(g,C),v){let D=xr(Array.from(v));for(let w of D){let S=this.streamsOutbound.get(w);if(S&&this.multicodecs.includes(S.protocol)&&!p.has(w)&&!this.direct.has(w)){let P=c(w);P>=this.opts.scoreThresholds.publishThreshold&&x.push(w),P>=this.opts.scoreThresholds.gossipThreshold&&C.add(w)}}}if(p.size<e){let D=e-p.size;x.slice(0,D).forEach(w=>{p.add(w),C?.delete(w)})}}),this.emitGossip(l),await this.sendGraftPrune(f,u,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new Nn("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let i=this.topics.get(e);if(!i)return new Set;let s=[];return i.forEach(o=>{let a=this.streamsOutbound.get(o);!a||this.multicodecs.includes(a.protocol)&&n(o)&&s.push(o)}),s=xr(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;for(let o of this.backoff.values())r+=o.size;e.cacheSize.set({cache:"backoff"},r);for(let[o,a]of this.topics)e.topicPeersCount.set({topicStr:o},a.size);for(let[o,a]of this.mesh)e.meshPeerCounts.set({topicStr:o},a.size);let n=[],i=new Map;e.behaviourPenalty.reset();for(let o of this.peers.keys()){let a=this.score.score(o);n.push(a),i.set(o,a),e.behaviourPenalty.observe(this.score.peerStats.get(o)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,i);let s=Jg(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}};fa.multicodec=ta;return cy(aS);})();
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return ChainsafeLibp2PGossipsub}));
